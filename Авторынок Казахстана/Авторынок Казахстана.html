<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>6116ab4d71784127b71823b11da00ac4</title>
  <style>
    html {
      line-height: 1.5;
      font-family: Georgia, serif;
      font-size: 20px;
      color: #1a1a1a;
      background-color: #fdfdfd;
    }
    body {
      margin: 0 auto;
      max-width: 36em;
      padding-left: 50px;
      padding-right: 50px;
      padding-top: 50px;
      padding-bottom: 50px;
      hyphens: auto;
      overflow-wrap: break-word;
      text-rendering: optimizeLegibility;
      font-kerning: normal;
    }
    @media (max-width: 600px) {
      body {
        font-size: 0.9em;
        padding: 1em;
      }
      h1 {
        font-size: 1.8em;
      }
    }
    @media print {
      body {
        background-color: transparent;
        color: black;
        font-size: 12pt;
      }
      p, h2, h3 {
        orphans: 3;
        widows: 3;
      }
      h2, h3, h4 {
        page-break-after: avoid;
      }
    }
    p {
      margin: 1em 0;
    }
    a {
      color: #1a1a1a;
    }
    a:visited {
      color: #1a1a1a;
    }
    img {
      max-width: 100%;
    }
    h1, h2, h3, h4, h5, h6 {
      margin-top: 1.4em;
    }
    h5, h6 {
      font-size: 1em;
      font-style: italic;
    }
    h6 {
      font-weight: normal;
    }
    ol, ul {
      padding-left: 1.7em;
      margin-top: 1em;
    }
    li > ol, li > ul {
      margin-top: 0;
    }
    blockquote {
      margin: 1em 0 1em 1.7em;
      padding-left: 1em;
      border-left: 2px solid #e6e6e6;
      color: #606060;
    }
    code {
      font-family: Menlo, Monaco, 'Lucida Console', Consolas, monospace;
      font-size: 85%;
      margin: 0;
    }
    pre {
      margin: 1em 0;
      overflow: auto;
    }
    pre code {
      padding: 0;
      overflow: visible;
      overflow-wrap: normal;
    }
    .sourceCode {
     background-color: transparent;
     overflow: visible;
    }
    hr {
      background-color: #1a1a1a;
      border: none;
      height: 1px;
      margin: 1em 0;
    }
    table {
      margin: 1em 0;
      border-collapse: collapse;
      width: 100%;
      overflow-x: auto;
      display: block;
      font-variant-numeric: lining-nums tabular-nums;
    }
    table caption {
      margin-bottom: 0.75em;
    }
    tbody {
      margin-top: 0.5em;
      border-top: 1px solid #1a1a1a;
      border-bottom: 1px solid #1a1a1a;
    }
    th {
      border-top: 1px solid #1a1a1a;
      padding: 0.25em 0.5em 0.25em 0.5em;
    }
    td {
      padding: 0.125em 0.5em 0.25em 0.5em;
    }
    header {
      margin-bottom: 4em;
      text-align: center;
    }
    #TOC li {
      list-style: none;
    }
    #TOC ul {
      padding-left: 1.3em;
    }
    #TOC > ul {
      padding-left: 0;
    }
    #TOC a:not(:hover) {
      text-decoration: none;
    }
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1.6em;
      vertical-align: middle;
    }
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      {   }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span.al { color: #ff0000; font-weight: bold; } /* Alert */
    code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
    code span.at { color: #7d9029; } /* Attribute */
    code span.bn { color: #40a070; } /* BaseN */
    code span.bu { color: #008000; } /* BuiltIn */
    code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #4070a0; } /* Char */
    code span.cn { color: #880000; } /* Constant */
    code span.co { color: #60a0b0; font-style: italic; } /* Comment */
    code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
    code span.do { color: #ba2121; font-style: italic; } /* Documentation */
    code span.dt { color: #902000; } /* DataType */
    code span.dv { color: #40a070; } /* DecVal */
    code span.er { color: #ff0000; font-weight: bold; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #40a070; } /* Float */
    code span.fu { color: #06287e; } /* Function */
    code span.im { color: #008000; font-weight: bold; } /* Import */
    code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
    code span.kw { color: #007020; font-weight: bold; } /* Keyword */
    code span.op { color: #666666; } /* Operator */
    code span.ot { color: #007020; } /* Other */
    code span.pp { color: #bc7a00; } /* Preprocessor */
    code span.sc { color: #4070a0; } /* SpecialChar */
    code span.ss { color: #bb6688; } /* SpecialString */
    code span.st { color: #4070a0; } /* String */
    code span.va { color: #19177c; } /* Variable */
    code span.vs { color: #4070a0; } /* VerbatimString */
    code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
    .display.math{display: block; text-align: center; margin: 0.5rem auto;}
  </style>
  <!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
  <![endif]-->
</head>
<body>
<div class="cell markdown" id="m5cacwObr8jv">
<p><strong>Выполнил</strong>: Галимжанов Сергей Александрович</p>
<p><strong>TG</strong>: @SergeyDN2</p>
</div>
<div class="cell markdown" id="umGOha_PKs3e">
<center><font size=6><b>Анализ рынка продажи автомобилей в Казахстане за январь-сентябрь 2019 года</b></font></center>
</div>
<div class="cell markdown" id="_lO8GrKdRGsL">
<center><font size=4><b>Описание</b></font></center>
</div>
<div class="cell markdown" id="EuLIBaXPNyuD">
<p>В датасете представлены данные о продажах автомобилей на территории
Казахстана в январе-сентябре 2019 года всеми официальными автодилерами,
которые собрала статистическая компания-агрегатор.</p>
<p>Данные содержат ошибки и в текущем виде не пригодны для анализа.
Задача – очистить данные до состояния, когда их можно анализировать и
провести исследовательский анализ данных + анализ рынка автомобилей
Казахстана.</p>
</div>
<div class="cell markdown" id="H-NLVoZkRehu">
<center><font size=4><b>Цель и задачи</b></font></center>
</div>
<div class="cell markdown" id="JfOjAONUQuzo">
<p><strong>Цель</strong>: Определить рыночные сегменты Меркур Авто и
разработать маркетинговый план.</p>
<p><strong>Задачи</strong>:</p>
<ol>
<li><p>Загрузить данные.</p></li>
<li><p>Очистить данные:</p>
<blockquote>
<ul>
<li>привести данные в столбцах к единообразию;</li>
</ul>
</blockquote></li>
</ol>
<ul>
<li>избавиться или исправить некорректные значения данных;</li>
<li>закодировать данные, где это целесообразно.</li>
</ul>
<ol>
<li><p>Провести исследовательский анализ данных:</p>
<blockquote>
<ul>
<li>провести первичный анализ признаков в датасете.</li>
</ul>
</blockquote></li>
<li><p>Провести анализ рынка:</p>
<blockquote>
<ul>
<li>описать ситуацию на рынке через базовые показатели.</li>
</ul>
</blockquote></li>
<li><p>Подготовить выводы и рекомендации.</p></li>
</ol>
</div>
<div class="cell markdown" id="txh1ja0aRl18">
<center><font size=4><b>Описание данных</b></font></center>
</div>
<div class="cell markdown" id="cBcJAm9WRrTv">
<ul>
<li>Год – год продажи (2019);</li>
<li>Месяц – месяц продажи (январь - сентябрь);</li>
<li>Компания – название автоцентра;</li>
<li>Бренд – название продаваемой марки автомобиля;</li>
<li>Модель – название модели автомобиля;</li>
<li>Модификация – модификация модели автомобиля (удаляем);</li>
<li>Год выпуска – год производства автомобиля;</li>
<li>Страна-производитель – страна, где произведен автомобиль;</li>
<li>Вид топлива – бензин, дизель, электричество, гибрид;</li>
<li>Объём двиг л – объем двигателя автомобиля в литрах;</li>
<li>Коробка передач – тип коробки переключения передач (оставляем два
варианта: автоматическая, механическая, то есть все что не механика
ставим автомат, на - DSG, S-Tronic и прочее делить не надо, равно как и
количество передач);</li>
<li>Тип привода – в итоге оставляем RWD – задний привод, FWD – передний
привод, 4WD – полный привод, 2WD – все остальное (подключаемый полный
привод и где нет четкого указания передний или задний это привод);</li>
<li>Сегмент – сегмент, к которому относится авто (удаляем);</li>
<li>Регион – регион продажи;</li>
<li>Наименование дилерского центра – совпадает с компанией – можно
удалить</li>
<li>Тип клиента – юридическое или физическое лицо (в рамках анализа не
критично – можно удалить);</li>
<li>Форма расчета – наличный и безналичный расчет (много пропусков –
можно удалять);</li>
<li>Количество – количество автомобилей в заказе;</li>
<li>Цена USD – цена автомобиля;</li>
<li>Продажа USD – цена заказа (цена авто умноженная на количество и за
вычетом скидок если есть);</li>
<li>Область – область продажи;</li>
<li>Сегментация 2013 – сегмент автомобиля актуальный;</li>
<li>Класс 2013 – класс автомобиля актуальный;</li>
<li>Сегментация Eng – английская сегментация (удаляем);</li>
<li>Локализация производства – удаляем (совпадает со страной
производителем).</li>
</ul>
</div>
<div class="cell markdown" data-colab_type="toc" id="2oABL1VslpH-">
<center><font size=5><b>СОДЕРЖАНИЕ</b></font></center>
<blockquote>
<p><a
href="#updateTitle=true&amp;folderId=1Uh-SSXD1220WZxO2oNNv7-TgRLZktWfi&amp;scrollTo=9b5CgR5rSAL0">1
Загрузка библиотек и настройка параметров</a></p>
</blockquote>
<blockquote>
<p><a
href="#updateTitle=true&amp;folderId=1Uh-SSXD1220WZxO2oNNv7-TgRLZktWfi&amp;scrollTo=wzaQyknRSWq6">2
Загрузка и просмотр данных</a></p>
</blockquote>
<blockquote>
<p><a
href="#updateTitle=true&amp;folderId=1Uh-SSXD1220WZxO2oNNv7-TgRLZktWfi&amp;scrollTo=F4HxJyDf0nsm">3
Предобработка данных</a></p>
</blockquote>
<blockquote>
<blockquote>
<p><a
href="#updateTitle=true&amp;folderId=1Uh-SSXD1220WZxO2oNNv7-TgRLZktWfi&amp;scrollTo=SF-eHD9iZTb-">3.1
Обработка столбцов</a></p>
</blockquote>
</blockquote>
<blockquote>
<blockquote>
<p><a
href="#updateTitle=true&amp;folderId=1Uh-SSXD1220WZxO2oNNv7-TgRLZktWfi&amp;scrollTo=8e8Aey4v1A1S">3.2
Заполнение пропусков и изменение типов данных</a></p>
</blockquote>
</blockquote>
<blockquote>
<blockquote>
<blockquote>
<p><a
href="#updateTitle=true&amp;folderId=1Uh-SSXD1220WZxO2oNNv7-TgRLZktWfi&amp;scrollTo=Mi1jWqHok30o">3.2.1
Столбец "вид_топлива"</a></p>
</blockquote>
</blockquote>
</blockquote>
<blockquote>
<blockquote>
<blockquote>
<p><a
href="#updateTitle=true&amp;folderId=1Uh-SSXD1220WZxO2oNNv7-TgRLZktWfi&amp;scrollTo=C7ZyMF_mmd49">3.2.2
Столбец "объем_двиг_л"</a></p>
</blockquote>
</blockquote>
</blockquote>
<blockquote>
<blockquote>
<blockquote>
<p><a
href="#updateTitle=true&amp;folderId=1Uh-SSXD1220WZxO2oNNv7-TgRLZktWfi&amp;scrollTo=W9I08u8K8Q8H">3.2.3
Столбец 'коробка_передач'</a></p>
</blockquote>
</blockquote>
</blockquote>
<blockquote>
<blockquote>
<blockquote>
<p><a
href="#updateTitle=true&amp;folderId=1Uh-SSXD1220WZxO2oNNv7-TgRLZktWfi&amp;scrollTo=_BL8blb6eQ3o">3.2.4
Столбец 'тип_привода'</a></p>
</blockquote>
</blockquote>
</blockquote>
<blockquote>
<blockquote>
<blockquote>
<p><a
href="#updateTitle=true&amp;folderId=1Uh-SSXD1220WZxO2oNNv7-TgRLZktWfi&amp;scrollTo=HnUcFub8Elqq">3.2.5
Столбец 'год_выпуска'</a></p>
</blockquote>
</blockquote>
</blockquote>
<blockquote>
<blockquote>
<blockquote>
<p><a
href="#updateTitle=true&amp;folderId=1Uh-SSXD1220WZxO2oNNv7-TgRLZktWfi&amp;scrollTo=eeEEcY_I0YMV">3.2.6
Столбец 'тип_клиента'</a></p>
</blockquote>
</blockquote>
</blockquote>
<blockquote>
<blockquote>
<p><a
href="#updateTitle=true&amp;folderId=1Uh-SSXD1220WZxO2oNNv7-TgRLZktWfi&amp;scrollTo=F4YQm1VnADlF">3.3
Обработка неявных дубликатов</a></p>
</blockquote>
</blockquote>
<blockquote>
<blockquote>
<blockquote>
<p><a
href="#updateTitle=true&amp;folderId=1Uh-SSXD1220WZxO2oNNv7-TgRLZktWfi&amp;scrollTo=fusjuwcMBGIk">3.3.1
Столбец 'компания'</a></p>
</blockquote>
</blockquote>
</blockquote>
<blockquote>
<blockquote>
<blockquote>
<p><a
href="#updateTitle=true&amp;folderId=1Uh-SSXD1220WZxO2oNNv7-TgRLZktWfi&amp;scrollTo=Kzf-dX9TUmbb">3.3.2
Столбец 'бренд'</a></p>
</blockquote>
</blockquote>
</blockquote>
<blockquote>
<blockquote>
<blockquote>
<p><a
href="#updateTitle=true&amp;folderId=1Uh-SSXD1220WZxO2oNNv7-TgRLZktWfi&amp;scrollTo=nEVOPRCaUwSf">3.3.3
Столбец 'страна-производитель'</a></p>
</blockquote>
</blockquote>
</blockquote>
<blockquote>
<blockquote>
<blockquote>
<p><a
href="#updateTitle=true&amp;folderId=1Uh-SSXD1220WZxO2oNNv7-TgRLZktWfi&amp;scrollTo=uVMFcB08U0Xe">3.3.4
Столбец 'область'</a></p>
</blockquote>
</blockquote>
</blockquote>
<blockquote>
<blockquote>
<blockquote>
<p><a
href="#updateTitle=true&amp;folderId=1Uh-SSXD1220WZxO2oNNv7-TgRLZktWfi&amp;scrollTo=DX_1K0UOU0eC">3.3.5
Столбец 'сегментация_2013'</a></p>
</blockquote>
</blockquote>
</blockquote>
<blockquote>
<blockquote>
<blockquote>
<p><a
href="#updateTitle=true&amp;folderId=1Uh-SSXD1220WZxO2oNNv7-TgRLZktWfi&amp;scrollTo=_Qsu0tUaU0lg">3.3.6
Столбец 'класс_2013'</a></p>
</blockquote>
</blockquote>
</blockquote>
<blockquote>
<blockquote>
<blockquote>
<p><a
href="#updateTitle=true&amp;folderId=1Uh-SSXD1220WZxO2oNNv7-TgRLZktWfi&amp;scrollTo=uslVCh6BUl_k">3.3.7
Столбец 'локализация_производства'</a></p>
</blockquote>
</blockquote>
</blockquote>
<blockquote>
<blockquote>
<p><a
href="#updateTitle=true&amp;folderId=1Uh-SSXD1220WZxO2oNNv7-TgRLZktWfi&amp;scrollTo=luydDJgMMKSd">3.4
Выбросы</a></p>
</blockquote>
</blockquote>
<blockquote>
<blockquote>
<p><a
href="#updateTitle=true&amp;folderId=1Uh-SSXD1220WZxO2oNNv7-TgRLZktWfi&amp;scrollTo=IC-DRGaWj2-q">3.5
Категоризация признаков</a></p>
</blockquote>
</blockquote>
<blockquote>
<blockquote>
<p><a
href="#updateTitle=true&amp;folderId=1Uh-SSXD1220WZxO2oNNv7-TgRLZktWfi&amp;scrollTo=UH6Im5qLn4PI">3.6
Создание столбца дат</a></p>
</blockquote>
</blockquote>
<blockquote>
<p><a
href="#updateTitle=true&amp;folderId=1Uh-SSXD1220WZxO2oNNv7-TgRLZktWfi&amp;scrollTo=w4O4t0ftEnvK">Вывод
предобработки данных</a></p>
</blockquote>
<blockquote>
<p><a
href="#updateTitle=true&amp;folderId=1Uh-SSXD1220WZxO2oNNv7-TgRLZktWfi&amp;scrollTo=rU6UL0aHKUOw">4
EDA</a></p>
</blockquote>
<blockquote>
<blockquote>
<p><a
href="#updateTitle=true&amp;folderId=1Uh-SSXD1220WZxO2oNNv7-TgRLZktWfi&amp;scrollTo=37tkpjcuomOy">4.1
Количество брендов на компанию</a></p>
</blockquote>
</blockquote>
<blockquote>
<blockquote>
<p><a
href="#updateTitle=true&amp;folderId=1Uh-SSXD1220WZxO2oNNv7-TgRLZktWfi&amp;scrollTo=GkHmERpirvWj">4.2
Количество моделей у разных марок</a></p>
</blockquote>
</blockquote>
<blockquote>
<blockquote>
<p><a
href="#updateTitle=true&amp;folderId=1Uh-SSXD1220WZxO2oNNv7-TgRLZktWfi&amp;scrollTo=PAZvBKGCKegK">4.3
Емкость рынка</a></p>
</blockquote>
</blockquote>
<blockquote>
<blockquote>
<p><a
href="#updateTitle=true&amp;folderId=1Uh-SSXD1220WZxO2oNNv7-TgRLZktWfi&amp;scrollTo=G10PdzJBp2x6">4.4
Динамика рынка</a></p>
</blockquote>
</blockquote>
<blockquote>
<blockquote>
<blockquote>
<p><a
href="#updateTitle=true&amp;folderId=1Uh-SSXD1220WZxO2oNNv7-TgRLZktWfi&amp;scrollTo=Pk--6Vucp8v9">4.4.1
Общая</a></p>
</blockquote>
</blockquote>
</blockquote>
<blockquote>
<blockquote>
<blockquote>
<p><a
href="#updateTitle=true&amp;folderId=1Uh-SSXD1220WZxO2oNNv7-TgRLZktWfi&amp;scrollTo=4f6CFwpDqEKy">4.4.2
По сегментам</a></p>
</blockquote>
</blockquote>
</blockquote>
<blockquote>
<blockquote>
<p><a
href="#updateTitle=true&amp;folderId=1Uh-SSXD1220WZxO2oNNv7-TgRLZktWfi&amp;scrollTo=J0x89ik_fbUy">4.5
Марки лидеры на рынке</a></p>
</blockquote>
</blockquote>
<blockquote>
<blockquote>
<p><a
href="#updateTitle=true&amp;folderId=1Uh-SSXD1220WZxO2oNNv7-TgRLZktWfi&amp;scrollTo=xaQbgqd3oes2">4.6
RFM анализ</a></p>
</blockquote>
</blockquote>
<blockquote>
<blockquote>
<p><a
href="#updateTitle=true&amp;folderId=1Uh-SSXD1220WZxO2oNNv7-TgRLZktWfi&amp;scrollTo=LzdlwuBJfS_B">4.7
Продажи автомобилей в разрезе бренд / сегмент</a></p>
</blockquote>
</blockquote>
<blockquote>
<blockquote>
<p><a
href="#updateTitle=true&amp;folderId=1Uh-SSXD1220WZxO2oNNv7-TgRLZktWfi&amp;scrollTo=ze5Nj-PkZqux">4.8
Продажи автомобилей в разрезе область / сегмент</a></p>
</blockquote>
</blockquote>
<blockquote>
<blockquote>
<p><a
href="#updateTitle=true&amp;folderId=1Uh-SSXD1220WZxO2oNNv7-TgRLZktWfi&amp;scrollTo=zNa2unpJfupT">4.9
Продажи по регионам</a></p>
</blockquote>
</blockquote>
<blockquote>
<blockquote>
<p><a
href="#updateTitle=true&amp;folderId=1Uh-SSXD1220WZxO2oNNv7-TgRLZktWfi&amp;scrollTo=rdVlgV89fxjw">4.10
Стоимость автомобиля зависит от уровня развития региона (средней
заработной платы по региону)</a></p>
</blockquote>
</blockquote>
<blockquote>
<blockquote>
<p><a
href="#updateTitle=true&amp;folderId=1Uh-SSXD1220WZxO2oNNv7-TgRLZktWfi&amp;scrollTo=F1RUMaRWgRxT">4.11
Продажи автоцентров</a></p>
</blockquote>
</blockquote>
<blockquote>
<blockquote>
<p><a
href="#updateTitle=true&amp;folderId=1Uh-SSXD1220WZxO2oNNv7-TgRLZktWfi&amp;scrollTo=65sYOa1LgVAU">4.12
Модели-лидеры на рынке</a></p>
</blockquote>
</blockquote>
<blockquote>
<blockquote>
<p><a
href="#updateTitle=true&amp;folderId=1Uh-SSXD1220WZxO2oNNv7-TgRLZktWfi&amp;scrollTo=YbXsnRq9M0HZ">4.13
Продажи по характеристикам</a></p>
</blockquote>
</blockquote>
<blockquote>
<blockquote>
<blockquote>
<p><a
href="#updateTitle=true&amp;folderId=1Uh-SSXD1220WZxO2oNNv7-TgRLZktWfi&amp;scrollTo=gwpG3tl6Um_f">4.13.1
Коммерческий транспорт</a></p>
</blockquote>
</blockquote>
</blockquote>
<blockquote>
<blockquote>
<blockquote>
<p><a
href="#updateTitle=true&amp;folderId=1Uh-SSXD1220WZxO2oNNv7-TgRLZktWfi&amp;scrollTo=_BSNBtI7YYEq">4.13.2
Некоммерческий транспорт</a></p>
</blockquote>
</blockquote>
</blockquote>
<blockquote>
<blockquote>
<p><a
href="#updateTitle=true&amp;folderId=1Uh-SSXD1220WZxO2oNNv7-TgRLZktWfi&amp;scrollTo=RZR-dCL0gZaE">4.14
Анализ положения Меркур Авто:</a></p>
</blockquote>
</blockquote>
<blockquote>
<blockquote>
<blockquote>
<p><a
href="#updateTitle=true&amp;folderId=1Uh-SSXD1220WZxO2oNNv7-TgRLZktWfi&amp;scrollTo=vtZk0PakgeRe">4.14.1
Выручка</a></p>
</blockquote>
</blockquote>
</blockquote>
<blockquote>
<blockquote>
<blockquote>
<blockquote>
<p><a
href="#updateTitle=true&amp;folderId=1Uh-SSXD1220WZxO2oNNv7-TgRLZktWfi&amp;scrollTo=YiFGzCXhqYiS">Общая</a></p>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
<blockquote>
<blockquote>
<blockquote>
<blockquote>
<p><a
href="#updateTitle=true&amp;folderId=1Uh-SSXD1220WZxO2oNNv7-TgRLZktWfi&amp;scrollTo=cqTes3F8qb1Z">Общая
по маркам</a></p>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
<blockquote>
<blockquote>
<blockquote>
<blockquote>
<p><a
href="#updateTitle=true&amp;folderId=1Uh-SSXD1220WZxO2oNNv7-TgRLZktWfi&amp;scrollTo=-oA9-qKKqcwD">Ежемесячная</a></p>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
<blockquote>
<blockquote>
<blockquote>
<blockquote>
<p><a
href="#updateTitle=true&amp;folderId=1Uh-SSXD1220WZxO2oNNv7-TgRLZktWfi&amp;scrollTo=7Hc_BxijqcgR">Средняя</a></p>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
<blockquote>
<blockquote>
<blockquote>
<blockquote>
<p><a
href="#updateTitle=true&amp;folderId=1Uh-SSXD1220WZxO2oNNv7-TgRLZktWfi&amp;scrollTo=T2ND3fcmqc5F">Ежемесячная
по маркам</a></p>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
<blockquote>
<blockquote>
<p><a
href="#updateTitle=true&amp;folderId=1Uh-SSXD1220WZxO2oNNv7-TgRLZktWfi&amp;scrollTo=yHc6CeeSggO-">4.15
Продажи по регионам</a></p>
</blockquote>
</blockquote>
<blockquote>
<blockquote>
<blockquote>
<p><a
href="#updateTitle=true&amp;folderId=1Uh-SSXD1220WZxO2oNNv7-TgRLZktWfi&amp;scrollTo=3uWPvzYa6KC-">4.15.1
Общие</a></p>
</blockquote>
</blockquote>
</blockquote>
<blockquote>
<blockquote>
<blockquote>
<p><a
href="#updateTitle=true&amp;folderId=1Uh-SSXD1220WZxO2oNNv7-TgRLZktWfi&amp;scrollTo=Bs_BclAs6Ohq">4.15.2
По маркам</a></p>
</blockquote>
</blockquote>
</blockquote>
<blockquote>
<blockquote>
<p><a
href="#updateTitle=true&amp;folderId=1Uh-SSXD1220WZxO2oNNv7-TgRLZktWfi&amp;scrollTo=EydZuNbEgkb2">4.16
Конкурентный анализ</a></p>
</blockquote>
</blockquote>
<blockquote>
<blockquote>
<blockquote>
<p><a
href="#updateTitle=true&amp;folderId=1Uh-SSXD1220WZxO2oNNv7-TgRLZktWfi&amp;scrollTo=xlr9hXRv_PSC">4.16.1
Выручка</a></p>
</blockquote>
</blockquote>
</blockquote>
<blockquote>
<blockquote>
<blockquote>
<p><a
href="#updateTitle=true&amp;folderId=1Uh-SSXD1220WZxO2oNNv7-TgRLZktWfi&amp;scrollTo=_HxLpLtF_TJx">4.16.2
Количество регионов</a></p>
</blockquote>
</blockquote>
</blockquote>
<blockquote>
<blockquote>
<p><a
href="#updateTitle=true&amp;folderId=1Uh-SSXD1220WZxO2oNNv7-TgRLZktWfi&amp;scrollTo=luT0fKJSgn8X">4.17
BCG анализ</a></p>
</blockquote>
</blockquote>
<blockquote>
<blockquote>
<p><a
href="#updateTitle=true&amp;folderId=1Uh-SSXD1220WZxO2oNNv7-TgRLZktWfi&amp;scrollTo=y3ZDGJYV7X_L">4.18
ABC анализ</a></p>
</blockquote>
</blockquote>
</div>
<div class="cell markdown" id="nibmGZ6URwXr">
<center><font size=4><b>Практическая часть</b></font></center>
</div>
<section id="1-загрузка-библиотек-и-настройка-параметров"
class="cell markdown" id="9b5CgR5rSAL0">
<h1>1 Загрузка библиотек и настройка параметров</h1>
</section>
<div class="cell code" data-execution_count="479" id="mAMXJAqFSIPB">
<div class="sourceCode" id="cb1"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> warnings</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> re</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> plotly.graph_objects <span class="im">as</span> go</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> plotly.express <span class="im">as</span> px</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> plotly.subplots <span class="im">import</span> make_subplots</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> requests</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> io <span class="im">import</span> BytesIO</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>pd.set_option(<span class="st">&#39;display.max_columns&#39;</span>, <span class="va">None</span>)</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>pd.set_option(<span class="st">&#39;display.max_colwidth&#39;</span>, <span class="va">None</span>)</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>pd.set_option(<span class="st">&#39;display.float_format&#39;</span>, <span class="st">&#39;</span><span class="sc">{:.2f}</span><span class="st">&#39;</span>.<span class="bu">format</span>)</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a>sns.set_style(<span class="st">&#39;whitegrid&#39;</span>)</span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a>plt.style.use(<span class="st">&quot;seaborn-v0_8&quot;</span>)</span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a>warnings.filterwarnings(<span class="st">&#39;ignore&#39;</span>)</span></code></pre></div>
</div>
<section id="2-загрузка-и-просмотр-данных" class="cell markdown"
id="wzaQyknRSWq6">
<h1>2 Загрузка и просмотр данных</h1>
</section>
<div class="cell code" data-execution_count="480" id="HAIL2XhReLWI">
<div class="sourceCode" id="cb2"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># уникальный идентификатор google таблицы</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>spreadsheet_id <span class="op">=</span> <span class="st">&#39;1bPCuJgIo0THfPJXyUMK7e7x28y28pwH1ORTNbYVXPso&#39;</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="co"># URL для экспорта данных таблицы в формате CSV с использованием идентификатора</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>file_name <span class="op">=</span> <span class="ss">f&#39;https://docs.google.com/spreadsheets/d/</span><span class="sc">{</span>spreadsheet_id<span class="sc">}</span><span class="ss">/export?format=csv&#39;</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a><span class="co"># GET-запрос к Google Sheets API для получения данных в формате CSV</span></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>r <span class="op">=</span> requests.get(file_name)</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a><span class="co"># читаем данные в DataFrame</span></span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pd.read_csv(BytesIO(r.content), decimal<span class="op">=</span><span class="st">&#39;,&#39;</span>)</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="481"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:434}"
id="A8tffxBOemBA" data-outputId="b6d17b99-ef16-43ed-c9b9-73422d70501e">
<div class="sourceCode" id="cb3"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>df.head()</span></code></pre></div>
<div class="output execute_result" data-execution_count="481">

  <div id="df-076b3e3c-d708-4683-b3cd-1b1cfa370579" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Год</th>
      <th>Месяц</th>
      <th>Компания</th>
      <th>Бренд</th>
      <th>Модель</th>
      <th>Модификация</th>
      <th>Год выпуска</th>
      <th>Страна-производитель</th>
      <th>Вид топлива</th>
      <th>Объём двиг, л,</th>
      <th>Коробка передач</th>
      <th>Тип привода</th>
      <th>Сегмент</th>
      <th>Регион</th>
      <th>Наименование дилерского центра</th>
      <th>Тип клиента</th>
      <th>Форма расчета</th>
      <th>Количество</th>
      <th>Цена, USD</th>
      <th>Продажа, USD</th>
      <th>Область</th>
      <th>Сегментация 2013</th>
      <th>Класс 2013</th>
      <th>Сегментация Eng</th>
      <th>Локализация производства</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2019</td>
      <td>Май</td>
      <td>Mercur Auto</td>
      <td>Audi</td>
      <td>A3</td>
      <td>TFSI</td>
      <td>2018</td>
      <td>Германия</td>
      <td>Бензин</td>
      <td>1,4</td>
      <td>S-tronic</td>
      <td>передний</td>
      <td>Легковые автомобили Premium</td>
      <td>Алматы</td>
      <td>Mercur Auto Алматы</td>
      <td>Физ. Лицо</td>
      <td>безналичный</td>
      <td>1.00</td>
      <td>28115.00</td>
      <td>28115.00</td>
      <td>г.Алматы</td>
      <td>Легковые автомобили</td>
      <td>C класс</td>
      <td>C</td>
      <td>Импорт</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2019</td>
      <td>Август</td>
      <td>Mercur Auto</td>
      <td>Audi</td>
      <td>A3</td>
      <td>TFSI</td>
      <td>2018</td>
      <td>Германия</td>
      <td>Бензин</td>
      <td>1,4</td>
      <td>S-tronic</td>
      <td>передний</td>
      <td>Легковые автомобили Premium</td>
      <td>Алматы</td>
      <td>Mercur Auto Алматы</td>
      <td>Юр. Лицо</td>
      <td>наличный</td>
      <td>1.00</td>
      <td>32246.99</td>
      <td>32246.99</td>
      <td>г.Алматы</td>
      <td>Легковые автомобили</td>
      <td>C класс</td>
      <td>C</td>
      <td>Импорт</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2019</td>
      <td>Апрель</td>
      <td>Mercur Auto</td>
      <td>Audi</td>
      <td>A4</td>
      <td>TFSI</td>
      <td>2018</td>
      <td>Германия</td>
      <td>Бензин</td>
      <td>1,4</td>
      <td>S-Tronic</td>
      <td>FWD</td>
      <td>Легковые автомобили Premium</td>
      <td>Алматы</td>
      <td>Mercur Auto Алматы</td>
      <td>Физ. Лицо</td>
      <td>безналичный</td>
      <td>1.00</td>
      <td>32000.00</td>
      <td>32000.00</td>
      <td>г.Алматы</td>
      <td>Легковые автомобили</td>
      <td>D класс</td>
      <td>D</td>
      <td>Импорт</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2019</td>
      <td>Июль</td>
      <td>Mercur Auto</td>
      <td>Audi</td>
      <td>A4</td>
      <td>TFSI</td>
      <td>2018</td>
      <td>Германия</td>
      <td>Бензин</td>
      <td>1,4</td>
      <td>S-tronic</td>
      <td>передний</td>
      <td>Легковые автомобили Premium</td>
      <td>Алматы</td>
      <td>Mercur Auto Алматы</td>
      <td>Юр. Лицо</td>
      <td>безналичный</td>
      <td>1.00</td>
      <td>31929.00</td>
      <td>31929.00</td>
      <td>г.Алматы</td>
      <td>Легковые автомобили</td>
      <td>D класс</td>
      <td>D</td>
      <td>Импорт</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2019</td>
      <td>Июль</td>
      <td>Mercur Auto</td>
      <td>Audi</td>
      <td>A4</td>
      <td>TFSI</td>
      <td>2018</td>
      <td>Германия</td>
      <td>Бензин</td>
      <td>1,4</td>
      <td>S-tronic</td>
      <td>передний</td>
      <td>Легковые автомобили Premium</td>
      <td>Алматы</td>
      <td>Mercur Auto Алматы</td>
      <td>Физ. Лицо</td>
      <td>наличный</td>
      <td>1.00</td>
      <td>31929.00</td>
      <td>31929.00</td>
      <td>г.Алматы</td>
      <td>Легковые автомобили</td>
      <td>D класс</td>
      <td>D</td>
      <td>Импорт</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-076b3e3c-d708-4683-b3cd-1b1cfa370579')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-076b3e3c-d708-4683-b3cd-1b1cfa370579 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-076b3e3c-d708-4683-b3cd-1b1cfa370579');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-62ba2281-a8a2-47c3-ae1f-cfb9dfd4be5d">
  <button class="colab-df-quickchart" onclick="quickchart('df-62ba2281-a8a2-47c3-ae1f-cfb9dfd4be5d')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-62ba2281-a8a2-47c3-ae1f-cfb9dfd4be5d button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>
    </div>
  </div>

</div>
</div>
<div class="cell code" data-execution_count="482"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="sANsFA1q1K1v" data-outputId="d75c3ab6-cac2-4031-e1a3-898f6a451805">
<div class="sourceCode" id="cb4"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># выясним размер датафрейма</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>df.shape</span></code></pre></div>
<div class="output execute_result" data-execution_count="482">
<pre><code>(39966, 25)</code></pre>
</div>
</div>
<div class="cell markdown" id="oj05AjQ21Oyt">
<p>Датафрейм состоит из 39 966 строк и 25 столбцов.</p>
</div>
<section id="3-предобработка-данных" class="cell markdown"
id="F4HxJyDf0nsm">
<h1>3 Предобработка данных</h1>
</section>
<section id="31-обработка-столбцов" class="cell markdown"
id="SF-eHD9iZTb-">
<h2>3.1 Обработка столбцов</h2>
</section>
<div class="cell markdown" id="qSpSPX39Zf2-">
<p>Для начала удалим лишние столбцы, которые не потребуются нам для
анализа.</p>
</div>
<div class="cell code" data-execution_count="483" id="jjl_6D1qZq7z">
<div class="sourceCode" id="cb6"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> df.drop(columns<span class="op">=</span>[<span class="st">&#39;Модификация&#39;</span>, <span class="st">&#39;Форма расчета&#39;</span>, <span class="st">&#39;Сегмент&#39;</span>, <span class="st">&#39;Сегментация Eng&#39;</span>])</span></code></pre></div>
</div>
<div class="cell markdown" id="i036Fx6WzQzR">
<p>Переименуем столбцы в соответствии со стандартом.</p>
</div>
<div class="cell code" data-execution_count="484"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="ZcrLdI9czSKc" data-outputId="346690cb-a570-48be-e78e-cf551a76275e">
<div class="sourceCode" id="cb7"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># приведем названия к нижнему регистру</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>df.columns <span class="op">=</span> df.columns.<span class="bu">str</span>.lower()</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a><span class="co"># заменим знаки на нижнее подчеркивание</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>df.columns <span class="op">=</span> [x.replace(<span class="st">&#39; &#39;</span>, <span class="st">&#39;_&#39;</span>).replace(<span class="st">&#39;,_&#39;</span>, <span class="st">&#39;_&#39;</span>) <span class="cf">for</span> x <span class="kw">in</span> df.columns]</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a><span class="co"># проверим результат</span></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>df.columns</span></code></pre></div>
<div class="output execute_result" data-execution_count="484">
<pre><code>Index([&#39;год&#39;, &#39;месяц&#39;, &#39;компания&#39;, &#39;бренд&#39;, &#39;модель&#39;, &#39;год_выпуска&#39;,
       &#39;страна-производитель&#39;, &#39;вид_топлива&#39;, &#39;объём_двиг_л,&#39;,
       &#39;коробка_передач&#39;, &#39;тип_привода&#39;, &#39;регион&#39;,
       &#39;наименование_дилерского_центра&#39;, &#39;тип_клиента&#39;, &#39;количество&#39;,
       &#39;цена_usd&#39;, &#39;продажа_usd&#39;, &#39;область&#39;, &#39;сегментация_2013&#39;, &#39;класс_2013&#39;,
       &#39;локализация_производства&#39;],
      dtype=&#39;object&#39;)</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="485" id="tgelAOdb2n3v">
<div class="sourceCode" id="cb9"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># уберем из названия столбца лишнюю запятую</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> df.rename(columns<span class="op">=</span>{<span class="st">&#39;объём_двиг_л,&#39;</span>: <span class="st">&#39;объём_двиг_л&#39;</span>})</span></code></pre></div>
</div>
<section id="32-заполнение-пропусков-и-изменение-типов-данных"
class="cell markdown" id="8e8Aey4v1A1S">
<h2>3.2 Заполнение пропусков и изменение типов данных</h2>
</section>
<div class="cell code" data-execution_count="486"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="8V8BceSm1BA0" data-outputId="25dd9196-5a55-4e34-de8a-84116cd43ad3">
<div class="sourceCode" id="cb10"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># выведем информацию о пропусках и типах данных столбцов</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>df.info()</span></code></pre></div>
<div class="output stream stdout">
<pre><code>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
RangeIndex: 39966 entries, 0 to 39965
Data columns (total 21 columns):
 #   Column                          Non-Null Count  Dtype  
---  ------                          --------------  -----  
 0   год                             39966 non-null  int64  
 1   месяц                           39966 non-null  object 
 2   компания                        39966 non-null  object 
 3   бренд                           39966 non-null  object 
 4   модель                          39966 non-null  object 
 5   год_выпуска                     39465 non-null  object 
 6   страна-производитель            39966 non-null  object 
 7   вид_топлива                     36826 non-null  object 
 8   объём_двиг_л                    35708 non-null  object 
 9   коробка_передач                 36711 non-null  object 
 10  тип_привода                     35677 non-null  object 
 11  регион                          39966 non-null  object 
 12  наименование_дилерского_центра  39966 non-null  object 
 13  тип_клиента                     32919 non-null  object 
 14  количество                      39960 non-null  float64
 15  цена_usd                        39966 non-null  float64
 16  продажа_usd                     39966 non-null  float64
 17  область                         39966 non-null  object 
 18  сегментация_2013                39966 non-null  object 
 19  класс_2013                      39966 non-null  object 
 20  локализация_производства        39966 non-null  object 
dtypes: float64(3), int64(1), object(17)
memory usage: 6.4+ MB
</code></pre>
</div>
</div>
<div class="cell markdown" id="SRIq9gsC1BJD">
<p>Пропуски в столбцах:</p>
<ul>
<li>год_выпуска;</li>
<li>вид_топлива;</li>
<li>объём_двиг_л;<br />
</li>
<li>коробка_передач;<br />
</li>
<li>тип_привода;<br />
</li>
<li>тип_клиента;<br />
</li>
<li>количество.</li>
</ul>
<p>Неправильные типы данных:</p>
<ul>
<li>месяц (можно представить в виде цифр и объединить с годом для
получения даты);</li>
<li>год_выпуска (object вместо int);</li>
<li>объем_двиг_л(object вместо float).</li>
</ul>
</div>
<div class="cell code" data-execution_count="487" id="843sZMzQ6AcE">
<div class="sourceCode" id="cb12"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># создадим функцию</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> nan_count(column):</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>  <span class="co">&#39;&#39;&#39;</span></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a><span class="co">  Данная функция получает на вход колонку, считает в ней количество пустых строк,</span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a><span class="co">  посчитывает процент пустых строк от общего количества в датафрейме</span></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a><span class="co">  &#39;&#39;&#39;</span></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>  <span class="co"># количество пустых строк</span></span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>  nan_rows <span class="op">=</span> df[column].isna().<span class="bu">sum</span>()</span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a>  <span class="co"># процент пустых строк</span></span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a>  nan_perc <span class="op">=</span> <span class="bu">round</span>(df[column].isna().mean() <span class="op">*</span> <span class="dv">100</span>, <span class="dv">2</span>)</span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> <span class="bu">print</span>(<span class="ss">f&#39;&#39;&#39;Колонка: </span><span class="sc">{</span>column<span class="sc">}</span><span class="ss">. Пустые строки: </span><span class="sc">{</span>nan_rows<span class="sc">}</span><span class="ss">.</span><span class="ch">\</span></span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a><span class="ss">  Относительно датафрейма: </span><span class="sc">{</span>nan_perc<span class="sc">}</span><span class="ss">%&#39;&#39;&#39;</span>)</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="488"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="M514tMiU7_Yb" data-outputId="d101f601-4fc7-4710-8ffc-c017a497afc4">
<div class="sourceCode" id="cb13"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># применим функцию ко всем столбцам с пропусками</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> column <span class="kw">in</span> df.columns:</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> df[column].isna().<span class="bu">sum</span>() <span class="op">&gt;</span> <span class="dv">0</span>:</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>    nan_count(column)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Колонка: год_выпуска. Пустые строки: 501.  Относительно датафрейма: 1.25%
Колонка: вид_топлива. Пустые строки: 3140.  Относительно датафрейма: 7.86%
Колонка: объём_двиг_л. Пустые строки: 4258.  Относительно датафрейма: 10.65%
Колонка: коробка_передач. Пустые строки: 3255.  Относительно датафрейма: 8.14%
Колонка: тип_привода. Пустые строки: 4289.  Относительно датафрейма: 10.73%
Колонка: тип_клиента. Пустые строки: 7047.  Относительно датафрейма: 17.63%
Колонка: количество. Пустые строки: 6.  Относительно датафрейма: 0.02%
</code></pre>
</div>
</div>
<div class="cell markdown" id="v2DdYhq17-9l">
<p>Удалим пропуски в столбце "количество", они занимают лишь 0.02% от
датафрейма.</p>
<p>Сохраним изначальное количество строк для сравнения после удаления
данных.</p>
</div>
<div class="cell code" data-execution_count="489" id="9NZVjIP4_gEm">
<div class="sourceCode" id="cb15"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># количество строк изначально</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>nrows_start <span class="op">=</span> df.shape[<span class="dv">0</span>]</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="490" id="1xx5QRE7-qWz">
<div class="sourceCode" id="cb16"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co"># удалим пустые строки в столбце &quot;количество&quot;</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> df.query(<span class="st">&#39;количество.notna()&#39;</span>)</span></code></pre></div>
</div>
<div class="cell markdown" id="VV9gkpShKNPt">
<p>Пропуски в остальных столбцах постараемся заполнить.</p>
</div>
<section id="321-столбец-вид_топлива" class="cell markdown"
id="Mi1jWqHok30o">
<h3>3.2.1 Столбец "вид_топлива"</h3>
</section>
<div class="cell markdown" id="cpBjfMSlk90Q">
<p>Первым рассмотрим столбец "вид_топлива". В результате он должен
содержать следующие значения: бензин, дизель, гибрид, электричество.</p>
</div>
<div class="cell markdown" id="YR91br4IxqC7">
<p>Создадим функцию для оторбажения данных о столбце.</p>
</div>
<div class="cell code" data-execution_count="491" id="aFDh_2OuxvbT">
<div class="sourceCode" id="cb17"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> info(df, col):</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>  <span class="co">&#39;&#39;&#39;</span></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a><span class="co">  Данная функция принимает на вход датафрейм и столбец</span></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a><span class="co">  и выводит по нему информацию и уникальные значения</span></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a><span class="co">  &#39;&#39;&#39;</span></span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>  <span class="bu">print</span>(df[col].info(), <span class="st">&#39;</span><span class="ch">\n</span><span class="st">&#39;</span>)</span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>  <span class="bu">print</span>(df[col].unique())</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="492"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="0vNFjHF4AYAs" data-outputId="a9f62f8e-0eec-4a84-bcf0-afb1b63992dd">
<div class="sourceCode" id="cb18"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>info(df, <span class="st">&#39;вид_топлива&#39;</span>)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>&lt;class &#39;pandas.core.series.Series&#39;&gt;
Int64Index: 39960 entries, 0 to 39965
Series name: вид_топлива
Non-Null Count  Dtype 
--------------  ----- 
36820 non-null  object
dtypes: object(1)
memory usage: 624.4+ KB
None 

[&#39;Бензин&#39; &#39;Дизель&#39; nan &#39;дизель&#39; &#39;бензин&#39; &#39;гибрид&#39; &#39;2&#39; &#39;1,6&#39; &#39;0&#39; &#39;Электро&#39;
 &#39;Электричество&#39;]
</code></pre>
</div>
</div>
<div class="cell markdown" id="t6LTwZ4xIFSY">
<p>Как видно в столбце есть неявные дубликаты, такие как 'Бензин' -
'бензин ', 'Дизель' - 'дизель ' (еще и с лишними пробелами), 'Электро' -
'Электричество'. Пустые значения и цифры '2', '1,6', '0'.</p>
<p>Для начала разберемся с неявными дубликатами.</p>
</div>
<div class="cell code" data-execution_count="493" id="nLIFhfIaU1c_">
<div class="sourceCode" id="cb20"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co"># удалим лишние пробелы</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a><span class="co"># приведем названия топлива к нижнему регистру</span></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a><span class="co"># заменим &#39;электро&#39; на &#39;электричество&#39;</span></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>df[<span class="st">&#39;вид_топлива&#39;</span>] <span class="op">=</span> (</span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>    df[<span class="st">&#39;вид_топлива&#39;</span>].pipe(<span class="kw">lambda</span> x: x.<span class="bu">str</span>.strip())</span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>    .pipe(<span class="kw">lambda</span> x: x.<span class="bu">str</span>.lower())</span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>    .pipe(<span class="kw">lambda</span> x: x.<span class="bu">str</span>.replace(<span class="st">&#39;электро&#39;</span>, <span class="st">&#39;электричество&#39;</span>))</span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="494"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="-F-SdZo6VK1V" data-outputId="41514834-dc10-4a1a-eac0-052a77dca634">
<div class="sourceCode" id="cb21"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co"># посчитаем количество машин разного вида топлива</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>df[<span class="st">&#39;вид_топлива&#39;</span>].value_counts()</span></code></pre></div>
<div class="output execute_result" data-execution_count="494">
<pre><code>бензин           34954
дизель            1803
2                   23
1,6                 14
электричество       13
гибрид              10
0                    3
Name: вид_топлива, dtype: int64</code></pre>
</div>
</div>
<div class="cell markdown" id="qVoiKrLAxmjn">
<p>Цифры содержатся в 40 строках.</p>
</div>
<div class="cell code" data-execution_count="495"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:1000}"
id="mKHQTZ4VlJnH" data-outputId="f12017fa-7c91-479e-f72d-5bcd6b62c5fa">
<div class="sourceCode" id="cb23"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="co"># просмотрим строки с цифровым значением вида топлива</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>df[df[<span class="st">&#39;вид_топлива&#39;</span>].<span class="bu">str</span>.contains(<span class="vs">r&#39;\d&#39;</span>, na<span class="op">=</span><span class="va">False</span>)]</span></code></pre></div>
<div class="output execute_result" data-execution_count="495">

  <div id="df-61446ee3-c3a5-4402-bc34-a63662e1df16" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>год</th>
      <th>месяц</th>
      <th>компания</th>
      <th>бренд</th>
      <th>модель</th>
      <th>год_выпуска</th>
      <th>страна-производитель</th>
      <th>вид_топлива</th>
      <th>объём_двиг_л</th>
      <th>коробка_передач</th>
      <th>тип_привода</th>
      <th>регион</th>
      <th>наименование_дилерского_центра</th>
      <th>тип_клиента</th>
      <th>количество</th>
      <th>цена_usd</th>
      <th>продажа_usd</th>
      <th>область</th>
      <th>сегментация_2013</th>
      <th>класс_2013</th>
      <th>локализация_производства</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>23723</th>
      <td>2019</td>
      <td>Январь</td>
      <td>Renault Россия</td>
      <td>Renault</td>
      <td>Duster</td>
      <td>2019</td>
      <td>Российская Федерация</td>
      <td>2</td>
      <td>MT</td>
      <td>4WD</td>
      <td>4WD</td>
      <td>Уральск</td>
      <td>Урал-Кров Авто</td>
      <td>NaN</td>
      <td>1.00</td>
      <td>12249.61</td>
      <td>12249.61</td>
      <td>Западно-Казахстанская область</td>
      <td>Внедорожники</td>
      <td>Субкомпактные SUV</td>
      <td>Импорт</td>
    </tr>
    <tr>
      <th>23724</th>
      <td>2019</td>
      <td>Январь</td>
      <td>Renault Россия</td>
      <td>Renault</td>
      <td>Duster</td>
      <td>2018</td>
      <td>Российская Федерация</td>
      <td>2</td>
      <td>AT</td>
      <td>4WD</td>
      <td>4WD</td>
      <td>Нур-Султан</td>
      <td>Кристалл Авто Астана</td>
      <td>NaN</td>
      <td>1.00</td>
      <td>12249.61</td>
      <td>12249.61</td>
      <td>г.Нур-Султан</td>
      <td>Внедорожники</td>
      <td>Субкомпактные SUV</td>
      <td>Импорт</td>
    </tr>
    <tr>
      <th>23725</th>
      <td>2019</td>
      <td>Январь</td>
      <td>Renault Россия</td>
      <td>Renault</td>
      <td>Duster</td>
      <td>2018</td>
      <td>Российская Федерация</td>
      <td>2</td>
      <td>AT</td>
      <td>4WD</td>
      <td>4WD</td>
      <td>Нур-Султан</td>
      <td>Кристалл Авто Астана</td>
      <td>NaN</td>
      <td>1.00</td>
      <td>12249.61</td>
      <td>12249.61</td>
      <td>г.Нур-Султан</td>
      <td>Внедорожники</td>
      <td>Субкомпактные SUV</td>
      <td>Импорт</td>
    </tr>
    <tr>
      <th>23726</th>
      <td>2019</td>
      <td>Январь</td>
      <td>Renault Россия</td>
      <td>Renault</td>
      <td>Duster</td>
      <td>2018</td>
      <td>Российская Федерация</td>
      <td>2</td>
      <td>AT</td>
      <td>4WD</td>
      <td>4WD</td>
      <td>Кызылорда</td>
      <td>Кристалл Авто Кызылорда</td>
      <td>NaN</td>
      <td>1.00</td>
      <td>12249.61</td>
      <td>12249.61</td>
      <td>Кызылординская область</td>
      <td>Внедорожники</td>
      <td>Субкомпактные SUV</td>
      <td>Импорт</td>
    </tr>
    <tr>
      <th>23727</th>
      <td>2019</td>
      <td>Январь</td>
      <td>Renault Россия</td>
      <td>Renault</td>
      <td>Duster</td>
      <td>2018</td>
      <td>Российская Федерация</td>
      <td>2</td>
      <td>MT</td>
      <td>4WD</td>
      <td>4WD</td>
      <td>Караганда</td>
      <td>Кристалл Авто Караганда</td>
      <td>NaN</td>
      <td>1.00</td>
      <td>12249.61</td>
      <td>12249.61</td>
      <td>Карагандинская область</td>
      <td>Внедорожники</td>
      <td>Субкомпактные SUV</td>
      <td>Импорт</td>
    </tr>
    <tr>
      <th>23728</th>
      <td>2019</td>
      <td>Январь</td>
      <td>Renault Россия</td>
      <td>Renault</td>
      <td>Duster</td>
      <td>2018</td>
      <td>Российская Федерация</td>
      <td>1,6</td>
      <td>MT</td>
      <td>4WD</td>
      <td>4WD</td>
      <td>Караганда</td>
      <td>Кристалл Авто Караганда</td>
      <td>NaN</td>
      <td>1.00</td>
      <td>12249.61</td>
      <td>12249.61</td>
      <td>Карагандинская область</td>
      <td>Внедорожники</td>
      <td>Субкомпактные SUV</td>
      <td>Импорт</td>
    </tr>
    <tr>
      <th>23729</th>
      <td>2019</td>
      <td>Январь</td>
      <td>Renault Россия</td>
      <td>Renault</td>
      <td>Duster</td>
      <td>2018</td>
      <td>Российская Федерация</td>
      <td>2</td>
      <td>AT</td>
      <td>4WD</td>
      <td>4WD</td>
      <td>Караганда</td>
      <td>Кристалл Авто Караганда</td>
      <td>NaN</td>
      <td>1.00</td>
      <td>12249.61</td>
      <td>12249.61</td>
      <td>Карагандинская область</td>
      <td>Внедорожники</td>
      <td>Субкомпактные SUV</td>
      <td>Импорт</td>
    </tr>
    <tr>
      <th>23730</th>
      <td>2019</td>
      <td>Январь</td>
      <td>Renault Россия</td>
      <td>Renault</td>
      <td>Duster</td>
      <td>2018</td>
      <td>Российская Федерация</td>
      <td>2</td>
      <td>AT</td>
      <td>4WD</td>
      <td>4WD</td>
      <td>Караганда</td>
      <td>Кристалл Авто Караганда</td>
      <td>NaN</td>
      <td>1.00</td>
      <td>12249.61</td>
      <td>12249.61</td>
      <td>Карагандинская область</td>
      <td>Внедорожники</td>
      <td>Субкомпактные SUV</td>
      <td>Импорт</td>
    </tr>
    <tr>
      <th>23731</th>
      <td>2019</td>
      <td>Январь</td>
      <td>Renault Россия</td>
      <td>Renault</td>
      <td>Duster</td>
      <td>2018</td>
      <td>Российская Федерация</td>
      <td>2</td>
      <td>MT</td>
      <td>4WD</td>
      <td>4WD</td>
      <td>Караганда</td>
      <td>Кристалл Авто Караганда</td>
      <td>NaN</td>
      <td>1.00</td>
      <td>12249.61</td>
      <td>12249.61</td>
      <td>Карагандинская область</td>
      <td>Внедорожники</td>
      <td>Субкомпактные SUV</td>
      <td>Импорт</td>
    </tr>
    <tr>
      <th>23732</th>
      <td>2019</td>
      <td>Январь</td>
      <td>Renault Россия</td>
      <td>Renault</td>
      <td>Duster</td>
      <td>2018</td>
      <td>Российская Федерация</td>
      <td>2</td>
      <td>MT</td>
      <td>4WD</td>
      <td>4WD</td>
      <td>Караганда</td>
      <td>Кристалл Авто Караганда</td>
      <td>NaN</td>
      <td>1.00</td>
      <td>12249.61</td>
      <td>12249.61</td>
      <td>Карагандинская область</td>
      <td>Внедорожники</td>
      <td>Субкомпактные SUV</td>
      <td>Импорт</td>
    </tr>
    <tr>
      <th>23733</th>
      <td>2019</td>
      <td>Январь</td>
      <td>Renault Россия</td>
      <td>Renault</td>
      <td>Duster</td>
      <td>2018</td>
      <td>Российская Федерация</td>
      <td>1,6</td>
      <td>MT</td>
      <td>4WD</td>
      <td>4WD</td>
      <td>Караганда</td>
      <td>Кристалл Авто Караганда</td>
      <td>NaN</td>
      <td>1.00</td>
      <td>12249.61</td>
      <td>12249.61</td>
      <td>Карагандинская область</td>
      <td>Внедорожники</td>
      <td>Субкомпактные SUV</td>
      <td>Импорт</td>
    </tr>
    <tr>
      <th>23734</th>
      <td>2019</td>
      <td>Январь</td>
      <td>Renault Россия</td>
      <td>Renault</td>
      <td>Duster</td>
      <td>2018</td>
      <td>Российская Федерация</td>
      <td>1,6</td>
      <td>AT</td>
      <td>Передний</td>
      <td>Передний</td>
      <td>Караганда</td>
      <td>Кристалл Авто Караганда</td>
      <td>NaN</td>
      <td>1.00</td>
      <td>12249.61</td>
      <td>12249.61</td>
      <td>Карагандинская область</td>
      <td>Внедорожники</td>
      <td>Субкомпактные SUV</td>
      <td>Импорт</td>
    </tr>
    <tr>
      <th>23735</th>
      <td>2019</td>
      <td>Январь</td>
      <td>Renault Россия</td>
      <td>Renault</td>
      <td>Duster</td>
      <td>2018</td>
      <td>Российская Федерация</td>
      <td>1,6</td>
      <td>AT</td>
      <td>Передний</td>
      <td>Передний</td>
      <td>Караганда</td>
      <td>Кристалл Авто Караганда</td>
      <td>NaN</td>
      <td>1.00</td>
      <td>12249.61</td>
      <td>12249.61</td>
      <td>Карагандинская область</td>
      <td>Внедорожники</td>
      <td>Субкомпактные SUV</td>
      <td>Импорт</td>
    </tr>
    <tr>
      <th>23736</th>
      <td>2019</td>
      <td>Январь</td>
      <td>Renault Россия</td>
      <td>Renault</td>
      <td>Duster</td>
      <td>2018</td>
      <td>Российская Федерация</td>
      <td>1,6</td>
      <td>AT</td>
      <td>Передний</td>
      <td>Передний</td>
      <td>Караганда</td>
      <td>Кристалл Авто Караганда</td>
      <td>NaN</td>
      <td>1.00</td>
      <td>12249.61</td>
      <td>12249.61</td>
      <td>Карагандинская область</td>
      <td>Внедорожники</td>
      <td>Субкомпактные SUV</td>
      <td>Импорт</td>
    </tr>
    <tr>
      <th>23746</th>
      <td>2019</td>
      <td>Январь</td>
      <td>Renault Россия</td>
      <td>Renault</td>
      <td>Duster</td>
      <td>2018</td>
      <td>Российская Федерация</td>
      <td>2</td>
      <td>AT</td>
      <td>4WD</td>
      <td>4WD</td>
      <td>Усть-Каменогорск</td>
      <td>БИПЭК АВТО Усть-Каменогорск</td>
      <td>NaN</td>
      <td>1.00</td>
      <td>12249.61</td>
      <td>12249.61</td>
      <td>Восточно-Казахстанская область</td>
      <td>Внедорожники</td>
      <td>Субкомпактные SUV</td>
      <td>Импорт</td>
    </tr>
    <tr>
      <th>23747</th>
      <td>2019</td>
      <td>Январь</td>
      <td>Renault Россия</td>
      <td>Renault</td>
      <td>Duster</td>
      <td>2018</td>
      <td>Российская Федерация</td>
      <td>2</td>
      <td>MT</td>
      <td>4WD</td>
      <td>4WD</td>
      <td>Усть-Каменогорск</td>
      <td>БИПЭК АВТО Усть-Каменогорск</td>
      <td>NaN</td>
      <td>1.00</td>
      <td>12249.61</td>
      <td>12249.61</td>
      <td>Восточно-Казахстанская область</td>
      <td>Внедорожники</td>
      <td>Субкомпактные SUV</td>
      <td>Импорт</td>
    </tr>
    <tr>
      <th>23748</th>
      <td>2019</td>
      <td>Январь</td>
      <td>Renault Россия</td>
      <td>Renault</td>
      <td>Duster</td>
      <td>2018</td>
      <td>Российская Федерация</td>
      <td>2</td>
      <td>AT</td>
      <td>4WD</td>
      <td>4WD</td>
      <td>Шымкент</td>
      <td>БИПЭК АВТО Шымкент</td>
      <td>NaN</td>
      <td>1.00</td>
      <td>12249.61</td>
      <td>12249.61</td>
      <td>Южно-Казахстанская область</td>
      <td>Внедорожники</td>
      <td>Субкомпактные SUV</td>
      <td>Импорт</td>
    </tr>
    <tr>
      <th>23749</th>
      <td>2019</td>
      <td>Январь</td>
      <td>Renault Россия</td>
      <td>Renault</td>
      <td>Duster</td>
      <td>2018</td>
      <td>Российская Федерация</td>
      <td>2</td>
      <td>AT</td>
      <td>4WD</td>
      <td>4WD</td>
      <td>Шымкент</td>
      <td>БИПЭК АВТО Шымкент</td>
      <td>NaN</td>
      <td>1.00</td>
      <td>12249.61</td>
      <td>12249.61</td>
      <td>Южно-Казахстанская область</td>
      <td>Внедорожники</td>
      <td>Субкомпактные SUV</td>
      <td>Импорт</td>
    </tr>
    <tr>
      <th>23750</th>
      <td>2019</td>
      <td>Январь</td>
      <td>Renault Россия</td>
      <td>Renault</td>
      <td>Duster</td>
      <td>2018</td>
      <td>Российская Федерация</td>
      <td>2</td>
      <td>AT</td>
      <td>4WD</td>
      <td>4WD</td>
      <td>Шымкент</td>
      <td>БИПЭК АВТО Шымкент</td>
      <td>NaN</td>
      <td>1.00</td>
      <td>12249.61</td>
      <td>12249.61</td>
      <td>Южно-Казахстанская область</td>
      <td>Внедорожники</td>
      <td>Субкомпактные SUV</td>
      <td>Импорт</td>
    </tr>
    <tr>
      <th>23751</th>
      <td>2019</td>
      <td>Январь</td>
      <td>Renault Россия</td>
      <td>Renault</td>
      <td>Duster</td>
      <td>2018</td>
      <td>Российская Федерация</td>
      <td>1,6</td>
      <td>AT</td>
      <td>Передний</td>
      <td>Передний</td>
      <td>Усть-Каменогорск</td>
      <td>БИПЭК АВТО Усть-Каменогорск</td>
      <td>NaN</td>
      <td>1.00</td>
      <td>12249.61</td>
      <td>12249.61</td>
      <td>Восточно-Казахстанская область</td>
      <td>Внедорожники</td>
      <td>Субкомпактные SUV</td>
      <td>Импорт</td>
    </tr>
    <tr>
      <th>23752</th>
      <td>2019</td>
      <td>Январь</td>
      <td>Renault Россия</td>
      <td>Renault</td>
      <td>Duster</td>
      <td>2018</td>
      <td>Российская Федерация</td>
      <td>2</td>
      <td>AT</td>
      <td>4WD</td>
      <td>4WD</td>
      <td>Алматы</td>
      <td>ASTER AUTO Алматы</td>
      <td>NaN</td>
      <td>1.00</td>
      <td>12249.61</td>
      <td>12249.61</td>
      <td>г.Алматы</td>
      <td>Внедорожники</td>
      <td>Субкомпактные SUV</td>
      <td>Импорт</td>
    </tr>
    <tr>
      <th>23753</th>
      <td>2019</td>
      <td>Январь</td>
      <td>Renault Россия</td>
      <td>Renault</td>
      <td>Duster</td>
      <td>2018</td>
      <td>Российская Федерация</td>
      <td>2</td>
      <td>AT</td>
      <td>4WD</td>
      <td>4WD</td>
      <td>Алматы</td>
      <td>ASTER AUTO Алматы</td>
      <td>NaN</td>
      <td>1.00</td>
      <td>12249.61</td>
      <td>12249.61</td>
      <td>г.Алматы</td>
      <td>Внедорожники</td>
      <td>Субкомпактные SUV</td>
      <td>Импорт</td>
    </tr>
    <tr>
      <th>23754</th>
      <td>2019</td>
      <td>Январь</td>
      <td>Renault Россия</td>
      <td>Renault</td>
      <td>Duster</td>
      <td>2018</td>
      <td>Российская Федерация</td>
      <td>1,6</td>
      <td>MT</td>
      <td>4WD</td>
      <td>4WD</td>
      <td>Алматы</td>
      <td>ASTER AUTO Алматы</td>
      <td>NaN</td>
      <td>1.00</td>
      <td>12249.61</td>
      <td>12249.61</td>
      <td>г.Алматы</td>
      <td>Внедорожники</td>
      <td>Субкомпактные SUV</td>
      <td>Импорт</td>
    </tr>
    <tr>
      <th>23755</th>
      <td>2019</td>
      <td>Январь</td>
      <td>Renault Россия</td>
      <td>Renault</td>
      <td>Duster</td>
      <td>2018</td>
      <td>Российская Федерация</td>
      <td>2</td>
      <td>MT</td>
      <td>4WD</td>
      <td>4WD</td>
      <td>Алматы</td>
      <td>ASTER AUTO Алматы</td>
      <td>NaN</td>
      <td>1.00</td>
      <td>12249.61</td>
      <td>12249.61</td>
      <td>г.Алматы</td>
      <td>Внедорожники</td>
      <td>Субкомпактные SUV</td>
      <td>Импорт</td>
    </tr>
    <tr>
      <th>23758</th>
      <td>2019</td>
      <td>Январь</td>
      <td>Renault Россия</td>
      <td>Renault</td>
      <td>Duster</td>
      <td>2018</td>
      <td>Российская Федерация</td>
      <td>2</td>
      <td>AT</td>
      <td>4WD</td>
      <td>4WD</td>
      <td>Нур-Султан</td>
      <td>Автоцентр Астэк</td>
      <td>NaN</td>
      <td>1.00</td>
      <td>12249.61</td>
      <td>12249.61</td>
      <td>г.Нур-Султан</td>
      <td>Внедорожники</td>
      <td>Субкомпактные SUV</td>
      <td>Импорт</td>
    </tr>
    <tr>
      <th>23759</th>
      <td>2019</td>
      <td>Январь</td>
      <td>Renault Россия</td>
      <td>Renault</td>
      <td>Duster</td>
      <td>2018</td>
      <td>Российская Федерация</td>
      <td>2</td>
      <td>AT</td>
      <td>4WD</td>
      <td>4WD</td>
      <td>Нур-Султан</td>
      <td>Автоцентр Астэк</td>
      <td>NaN</td>
      <td>1.00</td>
      <td>12249.61</td>
      <td>12249.61</td>
      <td>г.Нур-Султан</td>
      <td>Внедорожники</td>
      <td>Субкомпактные SUV</td>
      <td>Импорт</td>
    </tr>
    <tr>
      <th>23760</th>
      <td>2019</td>
      <td>Январь</td>
      <td>Renault Россия</td>
      <td>Renault</td>
      <td>Duster</td>
      <td>2018</td>
      <td>Российская Федерация</td>
      <td>2</td>
      <td>AT</td>
      <td>4WD</td>
      <td>4WD</td>
      <td>Нур-Султан</td>
      <td>Автоцентр Астэк</td>
      <td>NaN</td>
      <td>1.00</td>
      <td>12249.61</td>
      <td>12249.61</td>
      <td>г.Нур-Султан</td>
      <td>Внедорожники</td>
      <td>Субкомпактные SUV</td>
      <td>Импорт</td>
    </tr>
    <tr>
      <th>23761</th>
      <td>2019</td>
      <td>Январь</td>
      <td>Renault Россия</td>
      <td>Renault</td>
      <td>Duster</td>
      <td>2018</td>
      <td>Российская Федерация</td>
      <td>2</td>
      <td>AT</td>
      <td>4WD</td>
      <td>4WD</td>
      <td>Костанай</td>
      <td>Автоцентр Астэк</td>
      <td>NaN</td>
      <td>1.00</td>
      <td>12249.61</td>
      <td>12249.61</td>
      <td>Костанайская область</td>
      <td>Внедорожники</td>
      <td>Субкомпактные SUV</td>
      <td>Импорт</td>
    </tr>
    <tr>
      <th>23762</th>
      <td>2019</td>
      <td>Январь</td>
      <td>Renault Россия</td>
      <td>Renault</td>
      <td>Duster</td>
      <td>2018</td>
      <td>Российская Федерация</td>
      <td>2</td>
      <td>AT</td>
      <td>4WD</td>
      <td>4WD</td>
      <td>Нур-Султан</td>
      <td>Автоцентр Астэк</td>
      <td>NaN</td>
      <td>1.00</td>
      <td>12249.61</td>
      <td>12249.61</td>
      <td>г.Нур-Султан</td>
      <td>Внедорожники</td>
      <td>Субкомпактные SUV</td>
      <td>Импорт</td>
    </tr>
    <tr>
      <th>23763</th>
      <td>2019</td>
      <td>Январь</td>
      <td>Renault Россия</td>
      <td>Renault</td>
      <td>Duster</td>
      <td>2018</td>
      <td>Российская Федерация</td>
      <td>1,6</td>
      <td>MT</td>
      <td>4WD</td>
      <td>4WD</td>
      <td>Нур-Султан</td>
      <td>Автоцентр Астэк</td>
      <td>NaN</td>
      <td>1.00</td>
      <td>12249.61</td>
      <td>12249.61</td>
      <td>г.Нур-Султан</td>
      <td>Внедорожники</td>
      <td>Субкомпактные SUV</td>
      <td>Импорт</td>
    </tr>
    <tr>
      <th>23764</th>
      <td>2019</td>
      <td>Январь</td>
      <td>Renault Россия</td>
      <td>Renault</td>
      <td>Duster</td>
      <td>2018</td>
      <td>Российская Федерация</td>
      <td>1,6</td>
      <td>MT</td>
      <td>4WD</td>
      <td>4WD</td>
      <td>Петропавловск</td>
      <td>Автоцентр Астэк</td>
      <td>NaN</td>
      <td>1.00</td>
      <td>12249.61</td>
      <td>12249.61</td>
      <td>Северо-Казахстанская область</td>
      <td>Внедорожники</td>
      <td>Субкомпактные SUV</td>
      <td>Импорт</td>
    </tr>
    <tr>
      <th>23765</th>
      <td>2019</td>
      <td>Январь</td>
      <td>Renault Россия</td>
      <td>Renault</td>
      <td>Duster</td>
      <td>2018</td>
      <td>Российская Федерация</td>
      <td>2</td>
      <td>MT</td>
      <td>4WD</td>
      <td>4WD</td>
      <td>Нур-Султан</td>
      <td>Автоцентр Астэк</td>
      <td>NaN</td>
      <td>1.00</td>
      <td>12249.61</td>
      <td>12249.61</td>
      <td>г.Нур-Султан</td>
      <td>Внедорожники</td>
      <td>Субкомпактные SUV</td>
      <td>Импорт</td>
    </tr>
    <tr>
      <th>24997</th>
      <td>2019</td>
      <td>Январь</td>
      <td>Renault Россия</td>
      <td>Renault</td>
      <td>Sandero</td>
      <td>2018</td>
      <td>Российская Федерация</td>
      <td>1,6</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>Атырау</td>
      <td>Урал-Кров Авто</td>
      <td>NaN</td>
      <td>1.00</td>
      <td>12476.90</td>
      <td>12476.90</td>
      <td>Атырауская область</td>
      <td>Легковые автомобили</td>
      <td>B класс</td>
      <td>Импорт</td>
    </tr>
    <tr>
      <th>24998</th>
      <td>2019</td>
      <td>Январь</td>
      <td>Renault Россия</td>
      <td>Renault</td>
      <td>Sandero</td>
      <td>2018</td>
      <td>Российская Федерация</td>
      <td>1,6</td>
      <td>MT</td>
      <td>Передний</td>
      <td>Передний</td>
      <td>Уральск</td>
      <td>Урал-Кров Авто</td>
      <td>NaN</td>
      <td>1.00</td>
      <td>12476.90</td>
      <td>12476.90</td>
      <td>Западно-Казахстанская область</td>
      <td>Легковые автомобили</td>
      <td>B класс</td>
      <td>Импорт</td>
    </tr>
    <tr>
      <th>24999</th>
      <td>2019</td>
      <td>Январь</td>
      <td>Renault Россия</td>
      <td>Renault</td>
      <td>Sandero</td>
      <td>2018</td>
      <td>Российская Федерация</td>
      <td>1,6</td>
      <td>MT</td>
      <td>Передний</td>
      <td>Передний</td>
      <td>Уральск</td>
      <td>Урал-Кров Авто</td>
      <td>NaN</td>
      <td>1.00</td>
      <td>12476.90</td>
      <td>12476.90</td>
      <td>Западно-Казахстанская область</td>
      <td>Легковые автомобили</td>
      <td>B класс</td>
      <td>Импорт</td>
    </tr>
    <tr>
      <th>25002</th>
      <td>2019</td>
      <td>Январь</td>
      <td>Renault Россия</td>
      <td>Renault</td>
      <td>Sandero</td>
      <td>2018</td>
      <td>Российская Федерация</td>
      <td>1,6</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>Атырау</td>
      <td>Урал-Кров Авто</td>
      <td>NaN</td>
      <td>1.00</td>
      <td>12476.90</td>
      <td>12476.90</td>
      <td>Атырауская область</td>
      <td>Легковые автомобили</td>
      <td>B класс</td>
      <td>Импорт</td>
    </tr>
    <tr>
      <th>25023</th>
      <td>2019</td>
      <td>Январь</td>
      <td>Renault Россия</td>
      <td>Renault</td>
      <td>Sandero</td>
      <td>2018</td>
      <td>Российская Федерация</td>
      <td>1,6</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>Нур-Султан</td>
      <td>Автоцентр Астэк</td>
      <td>NaN</td>
      <td>1.00</td>
      <td>12476.90</td>
      <td>12476.90</td>
      <td>г.Нур-Султан</td>
      <td>Легковые автомобили</td>
      <td>B класс</td>
      <td>Импорт</td>
    </tr>
    <tr>
      <th>37121</th>
      <td>2019</td>
      <td>Январь</td>
      <td>БИПЭК АВТО</td>
      <td>UAZ</td>
      <td>3741</td>
      <td>2018</td>
      <td>Республика Казахстан</td>
      <td>0</td>
      <td>2,693</td>
      <td>5 МТ</td>
      <td>Полный</td>
      <td>Талдыкорган</td>
      <td>БИПЭК АВТО Талдыкорган</td>
      <td>NaN</td>
      <td>1.00</td>
      <td>14200.00</td>
      <td>14200.00</td>
      <td>Алматинская область</td>
      <td>Коммерческие автомобили</td>
      <td>Малотоннажные грузовики</td>
      <td>Локальное производство</td>
    </tr>
    <tr>
      <th>37122</th>
      <td>2019</td>
      <td>Январь</td>
      <td>БИПЭК АВТО</td>
      <td>UAZ</td>
      <td>3741</td>
      <td>2018</td>
      <td>Республика Казахстан</td>
      <td>0</td>
      <td>2,693</td>
      <td>5 МТ</td>
      <td>Полный</td>
      <td>Актобе</td>
      <td>БИПЭК АВТО Актобе</td>
      <td>NaN</td>
      <td>3.00</td>
      <td>14200.00</td>
      <td>42600.00</td>
      <td>Актюбинская область</td>
      <td>Коммерческие автомобили</td>
      <td>Малотоннажные грузовики</td>
      <td>Локальное производство</td>
    </tr>
    <tr>
      <th>37123</th>
      <td>2019</td>
      <td>Январь</td>
      <td>БИПЭК АВТО</td>
      <td>UAZ</td>
      <td>3741</td>
      <td>2018</td>
      <td>Республика Казахстан</td>
      <td>0</td>
      <td>2,693</td>
      <td>5 МТ</td>
      <td>Полный</td>
      <td>Актау</td>
      <td>БИПЭК АВТО Актау</td>
      <td>NaN</td>
      <td>2.00</td>
      <td>14200.00</td>
      <td>28400.00</td>
      <td>Мангистауская область</td>
      <td>Коммерческие автомобили</td>
      <td>Малотоннажные грузовики</td>
      <td>Локальное производство</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-61446ee3-c3a5-4402-bc34-a63662e1df16')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-61446ee3-c3a5-4402-bc34-a63662e1df16 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-61446ee3-c3a5-4402-bc34-a63662e1df16');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-1d1dab3d-aea5-4baa-9ef1-23ea837a7549">
  <button class="colab-df-quickchart" onclick="quickchart('df-1d1dab3d-aea5-4baa-9ef1-23ea837a7549')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-1d1dab3d-aea5-4baa-9ef1-23ea837a7549 button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>
    </div>
  </div>

</div>
</div>
<div class="cell markdown" id="BRhA31klxxZ_">
<p>Проанализировав строки, можно сделать вывод о смещении столбцов.
Коробка передач съехала в объем двигателя, а объем двигателя - в вид
топлива. Исправим это.</p>
<p>Вид топлива записан неправильно для трех машин: Renault Duster и
Sandero и UAZ 3741. Заполнить можно, воспользовавшись информацией из
интернета. Для всех трех моделей самый популярный вид топлива -
бензин.</p>
</div>
<div class="cell code" data-execution_count="496" id="YWAMV9vEtl6T">
<div class="sourceCode" id="cb24"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co"># перенесем данные из объема двигателя в коробку передач</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>df.loc[df[<span class="st">&#39;вид_топлива&#39;</span>].<span class="bu">str</span>.contains(<span class="vs">r&#39;\d&#39;</span>, na<span class="op">=</span><span class="va">False</span>), <span class="st">&#39;коробка_передач&#39;</span>] <span class="op">=</span> (</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>    df.loc[df[<span class="st">&#39;вид_топлива&#39;</span>].<span class="bu">str</span>.contains(<span class="vs">r&#39;\d&#39;</span>, na<span class="op">=</span><span class="va">False</span>), <span class="st">&#39;объём_двиг_л&#39;</span>]</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a><span class="co"># перенесем данные из вида топлива в объем двигателя</span></span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>df.loc[df[<span class="st">&#39;вид_топлива&#39;</span>].<span class="bu">str</span>.contains(<span class="vs">r&#39;\d&#39;</span>, na<span class="op">=</span><span class="va">False</span>), <span class="st">&#39;объём_двиг_л&#39;</span>] <span class="op">=</span> (</span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a>    df.loc[df[<span class="st">&#39;вид_топлива&#39;</span>].<span class="bu">str</span>.contains(<span class="vs">r&#39;\d&#39;</span>, na<span class="op">=</span><span class="va">False</span>), <span class="st">&#39;вид_топлива&#39;</span>]</span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="497" id="tjiDw-TU46Ut">
<div class="sourceCode" id="cb25"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="co"># заменим цифры на бензин</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>df.loc[df[<span class="st">&#39;вид_топлива&#39;</span>].<span class="bu">str</span>.contains(<span class="vs">r&#39;\d&#39;</span>, na<span class="op">=</span><span class="va">False</span>), <span class="st">&#39;вид_топлива&#39;</span>] <span class="op">=</span> <span class="st">&#39;бензин&#39;</span></span></code></pre></div>
</div>
<div class="cell code" data-execution_count="498"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="_MfqqUTaw68b" data-outputId="68401ffa-82f4-4470-decd-63737f35b5a5">
<div class="sourceCode" id="cb26"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="co"># проверим результат</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>df[<span class="st">&#39;вид_топлива&#39;</span>].unique()</span></code></pre></div>
<div class="output execute_result" data-execution_count="498">
<pre><code>array([&#39;бензин&#39;, &#39;дизель&#39;, nan, &#39;гибрид&#39;, &#39;электричество&#39;], dtype=object)</code></pre>
</div>
</div>
<div class="cell markdown" id="oSck-g_j5QV3">
<p>Осталось разобраться с пропусками.</p>
</div>
<div class="cell code" data-execution_count="499" id="dYbIkYutjg5P">
<div class="sourceCode" id="cb28"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="co"># приведем столбцы к нижнему регистру</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>df[[<span class="st">&#39;бренд&#39;</span>, <span class="st">&#39;модель&#39;</span>]] <span class="op">=</span> df[[<span class="st">&#39;бренд&#39;</span>, <span class="st">&#39;модель&#39;</span>]].<span class="bu">apply</span>(<span class="kw">lambda</span> x: x.<span class="bu">str</span>.lower())</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="500" id="PvJIYklN5lKF">
<div class="sourceCode" id="cb29"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="co"># объединим бренд и модель авто в один столбец</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>df[<span class="st">&#39;авто&#39;</span>] <span class="op">=</span> df[<span class="st">&#39;бренд&#39;</span>] <span class="op">+</span> <span class="st">&#39; &#39;</span> <span class="op">+</span> df[<span class="st">&#39;модель&#39;</span>]</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="501" id="rGDapQqON2u2">
<div class="sourceCode" id="cb30"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="co"># для удобства вставим новый столбец на 7 позицию</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>df.insert(</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>    <span class="dv">6</span>,</span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;авто&#39;</span>,</span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>    df.pop(<span class="st">&#39;авто&#39;</span>)</span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="502"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:330}"
id="TenrKSBN5zQZ" data-outputId="12edc115-44b5-4cea-8fee-d9315c94dae3">
<div class="sourceCode" id="cb31"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="co"># проверим результат</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>df.head()</span></code></pre></div>
<div class="output execute_result" data-execution_count="502">

  <div id="df-67cbfcd5-822c-4954-ba78-a830fdcb715f" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>год</th>
      <th>месяц</th>
      <th>компания</th>
      <th>бренд</th>
      <th>модель</th>
      <th>год_выпуска</th>
      <th>авто</th>
      <th>страна-производитель</th>
      <th>вид_топлива</th>
      <th>объём_двиг_л</th>
      <th>коробка_передач</th>
      <th>тип_привода</th>
      <th>регион</th>
      <th>наименование_дилерского_центра</th>
      <th>тип_клиента</th>
      <th>количество</th>
      <th>цена_usd</th>
      <th>продажа_usd</th>
      <th>область</th>
      <th>сегментация_2013</th>
      <th>класс_2013</th>
      <th>локализация_производства</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2019</td>
      <td>Май</td>
      <td>Mercur Auto</td>
      <td>audi</td>
      <td>a3</td>
      <td>2018</td>
      <td>audi a3</td>
      <td>Германия</td>
      <td>бензин</td>
      <td>1,4</td>
      <td>S-tronic</td>
      <td>передний</td>
      <td>Алматы</td>
      <td>Mercur Auto Алматы</td>
      <td>Физ. Лицо</td>
      <td>1.00</td>
      <td>28115.00</td>
      <td>28115.00</td>
      <td>г.Алматы</td>
      <td>Легковые автомобили</td>
      <td>C класс</td>
      <td>Импорт</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2019</td>
      <td>Август</td>
      <td>Mercur Auto</td>
      <td>audi</td>
      <td>a3</td>
      <td>2018</td>
      <td>audi a3</td>
      <td>Германия</td>
      <td>бензин</td>
      <td>1,4</td>
      <td>S-tronic</td>
      <td>передний</td>
      <td>Алматы</td>
      <td>Mercur Auto Алматы</td>
      <td>Юр. Лицо</td>
      <td>1.00</td>
      <td>32246.99</td>
      <td>32246.99</td>
      <td>г.Алматы</td>
      <td>Легковые автомобили</td>
      <td>C класс</td>
      <td>Импорт</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2019</td>
      <td>Апрель</td>
      <td>Mercur Auto</td>
      <td>audi</td>
      <td>a4</td>
      <td>2018</td>
      <td>audi a4</td>
      <td>Германия</td>
      <td>бензин</td>
      <td>1,4</td>
      <td>S-Tronic</td>
      <td>FWD</td>
      <td>Алматы</td>
      <td>Mercur Auto Алматы</td>
      <td>Физ. Лицо</td>
      <td>1.00</td>
      <td>32000.00</td>
      <td>32000.00</td>
      <td>г.Алматы</td>
      <td>Легковые автомобили</td>
      <td>D класс</td>
      <td>Импорт</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2019</td>
      <td>Июль</td>
      <td>Mercur Auto</td>
      <td>audi</td>
      <td>a4</td>
      <td>2018</td>
      <td>audi a4</td>
      <td>Германия</td>
      <td>бензин</td>
      <td>1,4</td>
      <td>S-tronic</td>
      <td>передний</td>
      <td>Алматы</td>
      <td>Mercur Auto Алматы</td>
      <td>Юр. Лицо</td>
      <td>1.00</td>
      <td>31929.00</td>
      <td>31929.00</td>
      <td>г.Алматы</td>
      <td>Легковые автомобили</td>
      <td>D класс</td>
      <td>Импорт</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2019</td>
      <td>Июль</td>
      <td>Mercur Auto</td>
      <td>audi</td>
      <td>a4</td>
      <td>2018</td>
      <td>audi a4</td>
      <td>Германия</td>
      <td>бензин</td>
      <td>1,4</td>
      <td>S-tronic</td>
      <td>передний</td>
      <td>Алматы</td>
      <td>Mercur Auto Алматы</td>
      <td>Физ. Лицо</td>
      <td>1.00</td>
      <td>31929.00</td>
      <td>31929.00</td>
      <td>г.Алматы</td>
      <td>Легковые автомобили</td>
      <td>D класс</td>
      <td>Импорт</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-67cbfcd5-822c-4954-ba78-a830fdcb715f')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-67cbfcd5-822c-4954-ba78-a830fdcb715f button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-67cbfcd5-822c-4954-ba78-a830fdcb715f');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-afff7c48-755e-4b8c-be76-2ab0c6489b64">
  <button class="colab-df-quickchart" onclick="quickchart('df-afff7c48-755e-4b8c-be76-2ab0c6489b64')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-afff7c48-755e-4b8c-be76-2ab0c6489b64 button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>
    </div>
  </div>

</div>
</div>
<div class="cell code" data-execution_count="503"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="lRTRKsY_hO7j" data-outputId="90ecc902-84cc-4f88-bfbb-2b7c2dbc3aca">
<div class="sourceCode" id="cb32"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="co"># посчитаем количество пропусков изначально</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>df[<span class="st">&#39;вид_топлива&#39;</span>].isna().<span class="bu">sum</span>()</span></code></pre></div>
<div class="output execute_result" data-execution_count="503">
<pre><code>3140</code></pre>
</div>
</div>
<div class="cell markdown" id="cSXdHkzRsoFB">
<p>Создадим функции для обработки пропусков.</p>
</div>
<div class="cell code" data-execution_count="504" id="wHbjQah_einf">
<div class="sourceCode" id="cb34"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> processing_nans (df, col, small_area, big_area):</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>  <span class="co">&#39;&#39;&#39;</span></span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a><span class="co">  Данная функция принимает на вход датафрейм,</span></span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a><span class="co">  столбец датафрейма с пустыми значениями, первый группирующий признак,</span></span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a><span class="co">  второй группирующий признак.</span></span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a><span class="co">  Сначала пропуски заполняются модой групп по первому более узкому признаку,</span></span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a><span class="co">  затем по второму более широкому.</span></span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a><span class="co">  Затем функция выводит 2 датафрейма</span></span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true" tabindex="-1"></a><span class="co">  Один с пустыми значениями в столбце col для дальнейшей обработки,</span></span>
<span id="cb34-10"><a href="#cb34-10" aria-hidden="true" tabindex="-1"></a><span class="co">  второй только с заполненными значениями.</span></span>
<span id="cb34-11"><a href="#cb34-11" aria-hidden="true" tabindex="-1"></a><span class="co">  &#39;&#39;&#39;</span></span>
<span id="cb34-12"><a href="#cb34-12" aria-hidden="true" tabindex="-1"></a>  <span class="co"># заполним пустые значения модой, где это возможно</span></span>
<span id="cb34-13"><a href="#cb34-13" aria-hidden="true" tabindex="-1"></a>  df[col] <span class="op">=</span> (</span>
<span id="cb34-14"><a href="#cb34-14" aria-hidden="true" tabindex="-1"></a>      df.groupby([small_area])[col]</span>
<span id="cb34-15"><a href="#cb34-15" aria-hidden="true" tabindex="-1"></a>      .transform(<span class="kw">lambda</span> x: x.fillna(x.mode()[<span class="dv">0</span>]) <span class="cf">if</span> <span class="bu">len</span>(x.mode()) <span class="op">&gt;=</span> <span class="dv">1</span> <span class="cf">else</span> x)</span>
<span id="cb34-16"><a href="#cb34-16" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb34-17"><a href="#cb34-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-18"><a href="#cb34-18" aria-hidden="true" tabindex="-1"></a>  <span class="co"># заполним пустые значения модой, где это возможно</span></span>
<span id="cb34-19"><a href="#cb34-19" aria-hidden="true" tabindex="-1"></a>  df[col] <span class="op">=</span> (</span>
<span id="cb34-20"><a href="#cb34-20" aria-hidden="true" tabindex="-1"></a>      df.groupby([big_area])[col]</span>
<span id="cb34-21"><a href="#cb34-21" aria-hidden="true" tabindex="-1"></a>      .transform(<span class="kw">lambda</span> x: x.fillna(x.mode()[<span class="dv">0</span>]) <span class="cf">if</span> <span class="bu">len</span>(x.mode()) <span class="op">&gt;=</span> <span class="dv">1</span> <span class="cf">else</span> x)</span>
<span id="cb34-22"><a href="#cb34-22" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb34-23"><a href="#cb34-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-24"><a href="#cb34-24" aria-hidden="true" tabindex="-1"></a>  <span class="co"># пустые значение перенесем в новый датафрейм</span></span>
<span id="cb34-25"><a href="#cb34-25" aria-hidden="true" tabindex="-1"></a>  df1 <span class="op">=</span> df[df[col].isna()]</span>
<span id="cb34-26"><a href="#cb34-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-27"><a href="#cb34-27" aria-hidden="true" tabindex="-1"></a>  <span class="co"># в старом оставим заполненные</span></span>
<span id="cb34-28"><a href="#cb34-28" aria-hidden="true" tabindex="-1"></a>  df <span class="op">=</span> df[<span class="op">~</span>df[col].isna()]</span>
<span id="cb34-29"><a href="#cb34-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-30"><a href="#cb34-30" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> df, df1</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="505" id="dPrEonl1eiuL">
<div class="sourceCode" id="cb35"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> processing_last_nans(df, df1, col1, col2, list1, list2):</span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>  <span class="co">&#39;&#39;&#39;</span></span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a><span class="co">  Данная функция принимает на вход 2 датафрейма, 2 колонки и 2 списка.</span></span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a><span class="co">  list1 соответствует col1, list2 соответствует col2</span></span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a><span class="co">  Из 2 списков формируется словарь для заполнения пропусков в столбце col1.</span></span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a><span class="co">  Результатов функции является объединенный датафрейм.</span></span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a><span class="co">  &#39;&#39;&#39;</span></span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-9"><a href="#cb35-9" aria-hidden="true" tabindex="-1"></a>  <span class="co"># создаём словарь из 2 списков</span></span>
<span id="cb35-10"><a href="#cb35-10" aria-hidden="true" tabindex="-1"></a>  dictionary <span class="op">=</span> <span class="bu">dict</span>(<span class="bu">zip</span>(list1, list2))</span>
<span id="cb35-11"><a href="#cb35-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-12"><a href="#cb35-12" aria-hidden="true" tabindex="-1"></a>  <span class="co"># применим словарь к столбцу</span></span>
<span id="cb35-13"><a href="#cb35-13" aria-hidden="true" tabindex="-1"></a>  df1[col1] <span class="op">=</span> df1[col2].<span class="bu">map</span>(dictionary)</span>
<span id="cb35-14"><a href="#cb35-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-15"><a href="#cb35-15" aria-hidden="true" tabindex="-1"></a>  <span class="co"># объединим датафреймы</span></span>
<span id="cb35-16"><a href="#cb35-16" aria-hidden="true" tabindex="-1"></a>  df <span class="op">=</span> pd.concat([df, df1], axis<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb35-17"><a href="#cb35-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-18"><a href="#cb35-18" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> df</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="506" id="ixLPB0fNsum5">
<div class="sourceCode" id="cb36"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="co"># применим функцию по заполнению пропусков модой</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>df, df1 <span class="op">=</span> processing_nans(df, <span class="st">&#39;вид_топлива&#39;</span>, <span class="st">&#39;авто&#39;</span>, <span class="st">&#39;бренд&#39;</span>)</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="507"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="-pLaCqc6s3J1" data-outputId="c0e635f6-24d5-4177-a98a-7c574ec52331">
<div class="sourceCode" id="cb37"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="co"># посчитаем количество пропусков для каждого авто</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>df1[<span class="st">&#39;авто&#39;</span>].value_counts()</span></code></pre></div>
<div class="output execute_result" data-execution_count="507">
<pre><code>mazda cx-5              51
shacman sx3258dr384     43
mazda 6                 30
mazda cx-9              26
foton bj1069vdjea-f1    19
dong feng bwc6665ga5    10
foton bj3253dmpkb-ad     9
урал 4320                7
mazda 3                  5
урал 5557                2
урал 4320-1951-40        1
урал 4320-1951-60        1
урал 32551               1
Name: авто, dtype: int64</code></pre>
</div>
</div>
<div class="cell markdown" id="lDovZVl5t40E">
<p>Многие автомобили выпускаются с разным видом топлива. Информацию
будем искать в интернете. Выбор топлива будем делать исходя из
количества продаваемых автомобилей данного топлива на сайтах по продаже
авто.</p>
</div>
<div class="cell code" data-execution_count="508" id="SfTej1cRtXja">
<div class="sourceCode" id="cb39"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="co"># авто на бензине</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>df1.loc[df1[<span class="st">&#39;авто&#39;</span>].isin([<span class="st">&#39;mazda cx-5&#39;</span>,</span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;mazda 6&#39;</span>,</span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;mazda cx-9&#39;</span>,</span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;mazda 3&#39;</span>]), <span class="st">&#39;вид_топлива&#39;</span>] <span class="op">=</span> <span class="st">&#39;бензин&#39;</span></span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a><span class="co"># авто на дизеле</span></span>
<span id="cb39-8"><a href="#cb39-8" aria-hidden="true" tabindex="-1"></a>df1.loc[df1[<span class="st">&#39;авто&#39;</span>].isin([<span class="st">&#39;dong feng bwc6665ga5&#39;</span>,</span>
<span id="cb39-9"><a href="#cb39-9" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;foton bj1069vdjea-f1&#39;</span>,</span>
<span id="cb39-10"><a href="#cb39-10" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;foton bj3253dmpkb-ad&#39;</span>,</span>
<span id="cb39-11"><a href="#cb39-11" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;shacman sx3258dr384&#39;</span>,</span>
<span id="cb39-12"><a href="#cb39-12" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;урал 4320&#39;</span>,</span>
<span id="cb39-13"><a href="#cb39-13" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;урал 4320-1951-40&#39;</span>,</span>
<span id="cb39-14"><a href="#cb39-14" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;урал 4320-1951-60&#39;</span>,</span>
<span id="cb39-15"><a href="#cb39-15" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;урал 32551&#39;</span>,</span>
<span id="cb39-16"><a href="#cb39-16" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;урал 5557&#39;</span>]), <span class="st">&#39;вид_топлива&#39;</span>] <span class="op">=</span> <span class="st">&#39;дизель&#39;</span></span></code></pre></div>
</div>
<div class="cell code" data-execution_count="509" id="AhiM7CWuujnP">
<div class="sourceCode" id="cb40"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="co"># объединим таблицы в одну</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pd.concat([df, df1], axis<span class="op">=</span><span class="dv">0</span>)</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="510"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="-J1cC94le2Ow" data-outputId="0fe5c438-851c-45a0-b151-fd0138c1272e">
<div class="sourceCode" id="cb41"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="co"># выведем инфо о столбце</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>info(df, <span class="st">&#39;вид_топлива&#39;</span>)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>&lt;class &#39;pandas.core.series.Series&#39;&gt;
Int64Index: 39960 entries, 0 to 39552
Series name: вид_топлива
Non-Null Count  Dtype 
--------------  ----- 
39960 non-null  object
dtypes: object(1)
memory usage: 624.4+ KB
None 

[&#39;бензин&#39; &#39;дизель&#39; &#39;гибрид&#39; &#39;электричество&#39;]
</code></pre>
</div>
</div>
<div class="cell markdown" id="ENQJuP3XeEnR">
<p>Пропуски заполнены, значения приведены к правильным.</p>
</div>
<section id="322-столбец-объем_двиг_л" class="cell markdown"
id="C7ZyMF_mmd49">
<h3>3.2.2 Столбец "объем_двиг_л"</h3>
</section>
<div class="cell code" data-execution_count="511"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="R4KA7LQzmdyB" data-outputId="46fca105-773f-42ce-f403-7a3d2e9b56ad">
<div class="sourceCode" id="cb43"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>info(df, <span class="st">&#39;объём_двиг_л&#39;</span>)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>&lt;class &#39;pandas.core.series.Series&#39;&gt;
Int64Index: 39960 entries, 0 to 39552
Series name: объём_двиг_л
Non-Null Count  Dtype 
--------------  ----- 
35702 non-null  object
dtypes: object(1)
memory usage: 624.4+ KB
None 

[&#39;1,4&#39; &#39;2&#39; &#39;3&#39; &#39;4,4&#39; &#39;6,6&#39; &#39;1,5&#39; &#39;1,596&#39; &#39;2,4&#39; &#39;1,7&#39; &#39;26,7&#39; &#39;25,7&#39; &#39;24,7&#39;
 &#39;23,7&#39; &#39;22,7&#39; &#39;21,7&#39; &#39;20,7&#39; &#39;19,7&#39; &#39;18,7&#39; &#39;17,7&#39; &#39;16,7&#39; &#39;15,7&#39; &#39;14,7&#39;
 &#39;13,7&#39; &#39;12,7&#39; &#39;11,7&#39; &#39;10,7&#39; &#39;9,7&#39; &#39;8,7&#39; &#39;7,7&#39; &#39;6,7&#39; &#39;5,7&#39; &#39;4,7&#39; &#39;3,7&#39;
 &#39;2,7&#39; &#39;6,2&#39; &#39;1,4 Turbo&#39; &#39;2,5&#39; &#39;1,6&#39; &#39;2,8&#39; nan &#39;4,3&#39; &#39;4,3,&#39; &#39;1,6 MPI&#39;
 &#39;2,0 MPI&#39; &#39;2,4 GDI&#39; &#39;2,4 MPI&#39; &#39;2,5 CRDI VGT&#39; &#39;2,5 CRDI WGT&#39; &#39;3,9&#39; &#39;7,5&#39;
 &#39;12,3&#39; &#39;1,6 T-GDI&#39; &#39;2,0 CRDI&#39; &#39;2.0&#39; &#39;3,5&#39; &#39;5,6&#39; &#39;5,2&#39; &#39;3,0 L&#39; &#39;1.6&#39; &#39;1.5&#39;
 &#39;5&#39; &#39;1,598&#39; &#39;1,248&#39; &#39;1,998&#39; &#39;2,359&#39; &#39;1,999&#39; &#39;3,342&#39; &#39;1,591&#39; &#39;3,47&#39; &#39;1,69&#39;
 &#39;1,774&#39; &#39;2.5&#39; &#39;2.7&#39; &#39;3.5&#39; &#39;4.6&#39; &#39;4,6&#39; &#39;5.7&#39; &#39;1,8&#39; &#39;10,5&#39; &#39;4&#39; &#39;5,5&#39; &#39;12&#39;
 &#39;12,8&#39; &#39;11&#39; &#39;2,2&#39; &#39;1,2&#39; &#39;1,485&#39; &#39;13&#39; &#39;1,33&#39; &#39;#Н/Д&#39; &#39;4.0&#39; &#39;2.4G&#39; &#39;2,4G&#39;
 &#39;2.8&#39; &#39;2,693&#39; &#39;0&#39; &#39;3,8&#39; &#39;3.8&#39; &#39;1,2T&#39; &#39;3,6&#39; &#39;7,6&#39; &#39;4,9&#39; &#39;2.0h&#39; &#39;2,9&#39;
 &#39;400 Л.С.&#39; &#39;4,98 L,&#39; &#39;4,98&#39; &#39;88 KWH&#39; &#39;8,4 L,&#39; &#39;6,7L&#39; &#39;6,5&#39;]
</code></pre>
</div>
</div>
<div class="cell markdown" id="8WNuQPN1mdqC">
<p>Помимо пропусков в столбце встречаются буквенные значения, другие
единицы измерения, вместо объема встречается мощность в лошадиных силах,
киловаты в час, где-то указано '#Н/Д', также присутствует значение
0.</p>
</div>
<div class="cell code" data-execution_count="512" id="RV3kNcr-GloT">
<div class="sourceCode" id="cb45"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="co"># вычленим только цифры из значений объема двигателя</span></span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a><span class="co"># пропуски и &#39;#Н/Д&#39; заменим на &#39;неизвестно&#39;</span></span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a>df[<span class="st">&#39;объём_двиг_л&#39;</span>] <span class="op">=</span> (</span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a>    df[<span class="st">&#39;объём_двиг_л&#39;</span>].<span class="bu">apply</span>(<span class="kw">lambda</span> x: re.match(<span class="vs">r&#39;\d+[\.,]*\d*&#39;</span>, <span class="bu">str</span>(x))</span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a>    .group() <span class="cf">if</span> pd.notna(x) <span class="kw">and</span> x <span class="op">!=</span> <span class="st">&quot;#Н/Д&quot;</span> <span class="cf">else</span> <span class="st">&#39;неизвестно&#39;</span>)</span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="513" id="tILNstyOIEHu">
<div class="sourceCode" id="cb46"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="co"># заменим , на .</span></span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>df[<span class="st">&#39;объём_двиг_л&#39;</span>] <span class="op">=</span> (</span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>    df[<span class="st">&#39;объём_двиг_л&#39;</span>]</span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a>    .<span class="bu">apply</span>(<span class="kw">lambda</span> x: x.replace(<span class="st">&#39;,&#39;</span>, <span class="st">&#39;.&#39;</span>) <span class="cf">if</span> x <span class="op">!=</span> <span class="st">&#39;неизвестно&#39;</span> <span class="cf">else</span> x)</span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="514" id="_aeqOckiUsOf">
<div class="sourceCode" id="cb47"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>df[<span class="st">&#39;объём_двиг_л&#39;</span>] <span class="op">=</span> df[<span class="st">&#39;объём_двиг_л&#39;</span>].replace(<span class="st">&#39;неизвестно&#39;</span>, np.nan)</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="515"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="EkPaEbnlUeKW" data-outputId="1edb9434-ae51-4606-c649-eab75d00d47e">
<div class="sourceCode" id="cb48"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="co"># выведем уникальные значения</span></span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>df[<span class="st">&#39;объём_двиг_л&#39;</span>].unique()</span></code></pre></div>
<div class="output execute_result" data-execution_count="515">
<pre><code>array([&#39;1.4&#39;, &#39;2&#39;, &#39;3&#39;, &#39;4.4&#39;, &#39;6.6&#39;, &#39;1.5&#39;, &#39;1.596&#39;, &#39;2.4&#39;, &#39;1.7&#39;,
       &#39;26.7&#39;, &#39;25.7&#39;, &#39;24.7&#39;, &#39;23.7&#39;, &#39;22.7&#39;, &#39;21.7&#39;, &#39;20.7&#39;, &#39;19.7&#39;,
       &#39;18.7&#39;, &#39;17.7&#39;, &#39;16.7&#39;, &#39;15.7&#39;, &#39;14.7&#39;, &#39;13.7&#39;, &#39;12.7&#39;, &#39;11.7&#39;,
       &#39;10.7&#39;, &#39;9.7&#39;, &#39;8.7&#39;, &#39;7.7&#39;, &#39;6.7&#39;, &#39;5.7&#39;, &#39;4.7&#39;, &#39;3.7&#39;, &#39;2.7&#39;,
       &#39;6.2&#39;, &#39;2.5&#39;, &#39;1.6&#39;, &#39;2.8&#39;, nan, &#39;4.3&#39;, &#39;2.0&#39;, &#39;3.9&#39;, &#39;7.5&#39;,
       &#39;12.3&#39;, &#39;3.5&#39;, &#39;5.6&#39;, &#39;5.2&#39;, &#39;3.0&#39;, &#39;5&#39;, &#39;1.598&#39;, &#39;1.248&#39;, &#39;1.998&#39;,
       &#39;2.359&#39;, &#39;1.999&#39;, &#39;3.342&#39;, &#39;1.591&#39;, &#39;3.47&#39;, &#39;1.69&#39;, &#39;1.774&#39;, &#39;4.6&#39;,
       &#39;1.8&#39;, &#39;10.5&#39;, &#39;4&#39;, &#39;5.5&#39;, &#39;12&#39;, &#39;12.8&#39;, &#39;11&#39;, &#39;2.2&#39;, &#39;1.2&#39;,
       &#39;1.485&#39;, &#39;13&#39;, &#39;1.33&#39;, &#39;4.0&#39;, &#39;2.693&#39;, &#39;0&#39;, &#39;3.8&#39;, &#39;3.6&#39;, &#39;7.6&#39;,
       &#39;4.9&#39;, &#39;2.9&#39;, &#39;400&#39;, &#39;4.98&#39;, &#39;88&#39;, &#39;8.4&#39;, &#39;6.5&#39;], dtype=object)</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="516" id="7i0HuyRru2Kn">
<div class="sourceCode" id="cb50"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="co"># применим функцию для заполнения пропусков модой</span></span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>df, df1 <span class="op">=</span> processing_nans(df, <span class="st">&#39;объём_двиг_л&#39;</span>, <span class="st">&#39;авто&#39;</span>, <span class="st">&#39;бренд&#39;</span>)</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="517"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="KzhHzUcPvKzj" data-outputId="80ae402f-2ee0-40f8-cd84-cc6141d7a370">
<div class="sourceCode" id="cb51"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="co"># выведем авто с неизвестным объемом двигателя</span></span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>df1[<span class="st">&#39;авто&#39;</span>].value_counts()</span></code></pre></div>
<div class="output execute_result" data-execution_count="517">
<pre><code>kamaz 65115             259
kamaz 43118             188
kamaz 6520               74
kamaz 45143              62
kamaz 65116              53
mazda cx-5               51
kamaz 44108              45
shacman sx3258dr384      43
kamaz 5490               32
mazda 6                  30
kamaz 65117              29
kamaz 43253              27
mazda cx-9               26
kamaz 53215              26
foton bj1069vdjea-f1     19
kamaz 45142              19
kamaz 54115              17
kamaz 58815z             15
kamaz 65111              12
dong feng bwc6665ga5     10
foton bj3253dmpkb-ad      9
урал 4320                 7
kamaz 53504               7
kamaz 43502               6
mazda 3                   5
kamaz 65206               4
kamaz 53605               4
kamaz 45141               3
kamaz 65225               3
урал 5557                 2
kamaz 4308                2
kamaz 6606                2
kamaz 66052               2
урал 4320-1951-60         1
урал 4320-1951-40         1
nefaz 5299                1
kamaz 4311                1
урал 32551                1
Name: авто, dtype: int64</code></pre>
</div>
</div>
<div class="cell markdown" id="O_DNEfP4vTSS">
<p>Слишком много авто не имеют информации об объеме двигателя. Поэтому
укрупним группировку до бренда.</p>
</div>
<div class="cell code" data-execution_count="518" id="XVTc9Gs8vh5i">
<div class="sourceCode" id="cb53"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="co"># создадим список брендов с неизвестным объемом двигателя</span></span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>auto_list <span class="op">=</span> <span class="bu">list</span>(df1[<span class="st">&#39;бренд&#39;</span>].value_counts().to_frame().index)</span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a><span class="co"># создадим список объемов двигателя этих брендов</span></span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a><span class="co"># информацию возьмем из интернета</span></span>
<span id="cb53-6"><a href="#cb53-6" aria-hidden="true" tabindex="-1"></a>engine_list <span class="op">=</span> [<span class="fl">11.76</span>, <span class="dv">2</span>, <span class="dv">10</span>, <span class="dv">4</span>, <span class="fl">14.9</span>, <span class="dv">3</span>, <span class="dv">9</span>]</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="519" id="KgUfXQpOv8Ui">
<div class="sourceCode" id="cb54"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="co"># применим функцию для заполнения последних пропусков</span></span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> processing_last_nans(df,</span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a>                          df1,</span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a>                          <span class="st">&#39;объём_двиг_л&#39;</span>,</span>
<span id="cb54-5"><a href="#cb54-5" aria-hidden="true" tabindex="-1"></a>                          <span class="st">&#39;бренд&#39;</span>,</span>
<span id="cb54-6"><a href="#cb54-6" aria-hidden="true" tabindex="-1"></a>                          auto_list,</span>
<span id="cb54-7"><a href="#cb54-7" aria-hidden="true" tabindex="-1"></a>                          engine_list)</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="520" id="vPx7joZAfWlG">
<div class="sourceCode" id="cb55"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="co"># переведем столбец объема двигателя в df к типу float</span></span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a>df[<span class="st">&#39;объём_двиг_л&#39;</span>] <span class="op">=</span> df[<span class="st">&#39;объём_двиг_л&#39;</span>].astype(<span class="st">&#39;float&#39;</span>)</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="521"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="plvVv11CWTSa" data-outputId="1a18fd64-39c3-4479-a795-9c38daf28bbc">
<div class="sourceCode" id="cb56"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a>df[<span class="st">&#39;объём_двиг_л&#39;</span>].info()</span></code></pre></div>
<div class="output stream stdout">
<pre><code>&lt;class &#39;pandas.core.series.Series&#39;&gt;
Int64Index: 39960 entries, 0 to 39552
Series name: объём_двиг_л
Non-Null Count  Dtype  
--------------  -----  
39960 non-null  float64
dtypes: float64(1)
memory usage: 624.4 KB
</code></pre>
</div>
</div>
<div class="cell markdown" id="RLhhyBHvymjy">
<p>Пропуски отсутствуют, тип данных соответствует. Далее проверим данные
на выбросы.</p>
</div>
<div class="cell code" data-execution_count="522"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="SnUvfcF3XePg" data-outputId="db043eb1-a87c-40d7-c0ab-5363b57a5a4d">
<div class="sourceCode" id="cb58"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="co"># выведем описание столбца</span></span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a>df[<span class="st">&#39;объём_двиг_л&#39;</span>].describe()</span></code></pre></div>
<div class="output execute_result" data-execution_count="522">
<pre><code>count   39960.00
mean        2.57
std         4.54
min         0.00
25%         1.60
50%         2.00
75%         2.70
max       400.00
Name: объём_двиг_л, dtype: float64</code></pre>
</div>
</div>
<div class="cell markdown" id="TCrCaINIV6jH">
<p>Отрисуем два ящика с усами. Для второго зададим пороговые
значения.</p>
</div>
<div class="cell code" data-execution_count="523"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:512}"
id="hn01hTtcWCn-" data-outputId="3c49facd-beb3-4a6f-bb5c-b92cb1f87e02">
<div class="sourceCode" id="cb60"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="co"># создадим сетку графиков</span></span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(<span class="dv">1</span>, <span class="dv">2</span>, figsize<span class="op">=</span>(<span class="dv">15</span>, <span class="dv">5</span>))</span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a>ax <span class="op">=</span> ax.flatten()</span>
<span id="cb60-4"><a href="#cb60-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-5"><a href="#cb60-5" aria-hidden="true" tabindex="-1"></a><span class="co"># установим общее название</span></span>
<span id="cb60-6"><a href="#cb60-6" aria-hidden="true" tabindex="-1"></a>plt.suptitle(<span class="st">&#39;Распределения объемов двигателя&#39;</span>)</span>
<span id="cb60-7"><a href="#cb60-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-8"><a href="#cb60-8" aria-hidden="true" tabindex="-1"></a><span class="co"># построим графики</span></span>
<span id="cb60-9"><a href="#cb60-9" aria-hidden="true" tabindex="-1"></a>sns.boxplot(df[<span class="st">&#39;объём_двиг_л&#39;</span>], orient<span class="op">=</span><span class="st">&#39;h&#39;</span>, ax<span class="op">=</span>ax[<span class="dv">0</span>])</span>
<span id="cb60-10"><a href="#cb60-10" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">0</span>].set_title(<span class="st">&#39;с выбросами&#39;</span>)</span>
<span id="cb60-11"><a href="#cb60-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-12"><a href="#cb60-12" aria-hidden="true" tabindex="-1"></a>sns.boxplot(df[<span class="st">&#39;объём_двиг_л&#39;</span>], orient<span class="op">=</span><span class="st">&#39;h&#39;</span>, ax<span class="op">=</span>ax[<span class="dv">1</span>])</span>
<span id="cb60-13"><a href="#cb60-13" aria-hidden="true" tabindex="-1"></a>plt.xlim(<span class="dv">0</span>, <span class="dv">30</span>)</span>
<span id="cb60-14"><a href="#cb60-14" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">1</span>].set_title(<span class="st">&#39;буз выбросов&#39;</span>)</span>
<span id="cb60-15"><a href="#cb60-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-16"><a href="#cb60-16" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb60-17"><a href="#cb60-17" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<div class="output display_data">
<p><img
src="vertopal_9b40e0aaef914c45a9852524805a792d/8636693b72bf2636d0e2ae3f6930ab7db40bcba5.png" /></p>
</div>
</div>
<div class="cell markdown" id="yNapeu3ZzTIA">
<p>Из первого графика видно наличие выбросов. Посмотрим, что это за
автомобили.</p>
</div>
<div class="cell code" data-execution_count="524"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:966}"
id="sKD9JzPczaCK" data-outputId="0a1159fd-3ba3-49d0-e605-52dd3f74ccaa">
<div class="sourceCode" id="cb61"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="co"># выведем информацию о двигателях со значением больше 50 и от -1 до 1</span></span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a>df[(df[<span class="st">&#39;объём_двиг_л&#39;</span>] <span class="op">&gt;</span> <span class="dv">50</span>) <span class="op">|</span> <span class="op">\</span></span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a> ((df[<span class="st">&#39;объём_двиг_л&#39;</span>] <span class="op">&lt;</span> <span class="dv">1</span>) <span class="op">&amp;</span> (df[<span class="st">&#39;объём_двиг_л&#39;</span>] <span class="op">&gt;-</span><span class="dv">1</span>))]</span></code></pre></div>
<div class="output execute_result" data-execution_count="524">

  <div id="df-eecd45cd-aaad-49ec-a6bb-7bd980d5341e" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>год</th>
      <th>месяц</th>
      <th>компания</th>
      <th>бренд</th>
      <th>модель</th>
      <th>год_выпуска</th>
      <th>авто</th>
      <th>страна-производитель</th>
      <th>вид_топлива</th>
      <th>объём_двиг_л</th>
      <th>коробка_передач</th>
      <th>тип_привода</th>
      <th>регион</th>
      <th>наименование_дилерского_центра</th>
      <th>тип_клиента</th>
      <th>количество</th>
      <th>цена_usd</th>
      <th>продажа_usd</th>
      <th>область</th>
      <th>сегментация_2013</th>
      <th>класс_2013</th>
      <th>локализация_производства</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>37121</th>
      <td>2019</td>
      <td>Январь</td>
      <td>БИПЭК АВТО</td>
      <td>uaz</td>
      <td>3741</td>
      <td>2018</td>
      <td>uaz 3741</td>
      <td>Республика Казахстан</td>
      <td>бензин</td>
      <td>0.00</td>
      <td>2,693</td>
      <td>Полный</td>
      <td>Талдыкорган</td>
      <td>БИПЭК АВТО Талдыкорган</td>
      <td>NaN</td>
      <td>1.00</td>
      <td>14200.00</td>
      <td>14200.00</td>
      <td>Алматинская область</td>
      <td>Коммерческие автомобили</td>
      <td>Малотоннажные грузовики</td>
      <td>Локальное производство</td>
    </tr>
    <tr>
      <th>37122</th>
      <td>2019</td>
      <td>Январь</td>
      <td>БИПЭК АВТО</td>
      <td>uaz</td>
      <td>3741</td>
      <td>2018</td>
      <td>uaz 3741</td>
      <td>Республика Казахстан</td>
      <td>бензин</td>
      <td>0.00</td>
      <td>2,693</td>
      <td>Полный</td>
      <td>Актобе</td>
      <td>БИПЭК АВТО Актобе</td>
      <td>NaN</td>
      <td>3.00</td>
      <td>14200.00</td>
      <td>42600.00</td>
      <td>Актюбинская область</td>
      <td>Коммерческие автомобили</td>
      <td>Малотоннажные грузовики</td>
      <td>Локальное производство</td>
    </tr>
    <tr>
      <th>37123</th>
      <td>2019</td>
      <td>Январь</td>
      <td>БИПЭК АВТО</td>
      <td>uaz</td>
      <td>3741</td>
      <td>2018</td>
      <td>uaz 3741</td>
      <td>Республика Казахстан</td>
      <td>бензин</td>
      <td>0.00</td>
      <td>2,693</td>
      <td>Полный</td>
      <td>Актау</td>
      <td>БИПЭК АВТО Актау</td>
      <td>NaN</td>
      <td>2.00</td>
      <td>14200.00</td>
      <td>28400.00</td>
      <td>Мангистауская область</td>
      <td>Коммерческие автомобили</td>
      <td>Малотоннажные грузовики</td>
      <td>Локальное производство</td>
    </tr>
    <tr>
      <th>39544</th>
      <td>2019</td>
      <td>Февраль</td>
      <td>Almaty Motors Premium</td>
      <td>jaguar</td>
      <td>i-pace</td>
      <td>2019</td>
      <td>jaguar i-pace</td>
      <td>UK</td>
      <td>электричество</td>
      <td>400.00</td>
      <td>РЕДУКТОР</td>
      <td>4WD</td>
      <td>Алматы</td>
      <td>Almaty Motors Premium</td>
      <td>Физ. Лицо</td>
      <td>1.00</td>
      <td>117236.97</td>
      <td>117236.97</td>
      <td>г.Алматы</td>
      <td>Внедорожники</td>
      <td>Компактные SUV</td>
      <td>Импорт</td>
    </tr>
    <tr>
      <th>39545</th>
      <td>2019</td>
      <td>Апрель</td>
      <td>Almaty Motors Premium</td>
      <td>jaguar</td>
      <td>i-pace</td>
      <td>2019</td>
      <td>jaguar i-pace</td>
      <td>UK</td>
      <td>электричество</td>
      <td>400.00</td>
      <td>РЕДУКТОР</td>
      <td>4WD</td>
      <td>Алматы</td>
      <td>Almaty Motors Premium</td>
      <td>Физ. Лицо</td>
      <td>1.00</td>
      <td>105388.79</td>
      <td>105388.79</td>
      <td>г.Алматы</td>
      <td>Внедорожники</td>
      <td>Компактные SUV</td>
      <td>Импорт</td>
    </tr>
    <tr>
      <th>39546</th>
      <td>2019</td>
      <td>Июнь</td>
      <td>Almaty Motors Premium</td>
      <td>jaguar</td>
      <td>i-pace</td>
      <td>2019</td>
      <td>jaguar i-pace</td>
      <td>UK</td>
      <td>электричество</td>
      <td>400.00</td>
      <td>РЕДУКТОР</td>
      <td>4WD</td>
      <td>Алматы</td>
      <td>Almaty Motors Premium</td>
      <td>Юр. Лицо</td>
      <td>1.00</td>
      <td>120413.28</td>
      <td>120413.28</td>
      <td>г.Алматы</td>
      <td>Внедорожники</td>
      <td>Компактные SUV</td>
      <td>Импорт</td>
    </tr>
    <tr>
      <th>39547</th>
      <td>2019</td>
      <td>Сентябрь</td>
      <td>TERRA MOTORS</td>
      <td>jaguar</td>
      <td>i-pace</td>
      <td>2019</td>
      <td>jaguar i-pace</td>
      <td>UK</td>
      <td>электричество</td>
      <td>400.00</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Нур-Султан</td>
      <td>Терра Моторс</td>
      <td>Физ. Лицо</td>
      <td>1.00</td>
      <td>118843.70</td>
      <td>118843.70</td>
      <td>г.Нур-Султан</td>
      <td>Внедорожники</td>
      <td>Компактные SUV</td>
      <td>Импорт</td>
    </tr>
    <tr>
      <th>39818</th>
      <td>2019</td>
      <td>Июль</td>
      <td>Allur Auto</td>
      <td>ankai</td>
      <td>hff6124g03ev3</td>
      <td>2019</td>
      <td>ankai hff6124g03ev3</td>
      <td>Республика Казахстан</td>
      <td>электричество</td>
      <td>88.00</td>
      <td>NaN</td>
      <td>2WD</td>
      <td>Костанай</td>
      <td>Allur Auto Almaty</td>
      <td>Юр. Лицо</td>
      <td>1.00</td>
      <td>307986.36</td>
      <td>307986.36</td>
      <td>Костанайская область</td>
      <td>Коммерческие автомобили</td>
      <td>Большие автобусы</td>
      <td>Локальное производство</td>
    </tr>
    <tr>
      <th>39819</th>
      <td>2019</td>
      <td>Июль</td>
      <td>Allur Auto</td>
      <td>ankai</td>
      <td>hff6124g03ev3</td>
      <td>2019</td>
      <td>ankai hff6124g03ev3</td>
      <td>Республика Казахстан</td>
      <td>электричество</td>
      <td>88.00</td>
      <td>NaN</td>
      <td>2WD</td>
      <td>Костанай</td>
      <td>Allur Auto Almaty</td>
      <td>Юр. Лицо</td>
      <td>1.00</td>
      <td>307986.36</td>
      <td>307986.36</td>
      <td>Костанайская область</td>
      <td>Коммерческие автомобили</td>
      <td>Большие автобусы</td>
      <td>Локальное производство</td>
    </tr>
    <tr>
      <th>39820</th>
      <td>2019</td>
      <td>Июль</td>
      <td>Allur Auto</td>
      <td>ankai</td>
      <td>hff6124g03ev3</td>
      <td>2019</td>
      <td>ankai hff6124g03ev3</td>
      <td>Республика Казахстан</td>
      <td>электричество</td>
      <td>88.00</td>
      <td>NaN</td>
      <td>2WD</td>
      <td>Костанай</td>
      <td>Allur Auto Almaty</td>
      <td>Юр. Лицо</td>
      <td>1.00</td>
      <td>307986.36</td>
      <td>307986.36</td>
      <td>Костанайская область</td>
      <td>Коммерческие автомобили</td>
      <td>Большие автобусы</td>
      <td>Локальное производство</td>
    </tr>
    <tr>
      <th>39821</th>
      <td>2019</td>
      <td>Июль</td>
      <td>Allur Auto</td>
      <td>ankai</td>
      <td>hff6124g03ev3</td>
      <td>2019</td>
      <td>ankai hff6124g03ev3</td>
      <td>Республика Казахстан</td>
      <td>электричество</td>
      <td>88.00</td>
      <td>NaN</td>
      <td>2WD</td>
      <td>Костанай</td>
      <td>Allur Auto Almaty</td>
      <td>Юр. Лицо</td>
      <td>1.00</td>
      <td>307986.36</td>
      <td>307986.36</td>
      <td>Костанайская область</td>
      <td>Коммерческие автомобили</td>
      <td>Большие автобусы</td>
      <td>Локальное производство</td>
    </tr>
    <tr>
      <th>39822</th>
      <td>2019</td>
      <td>Июль</td>
      <td>Allur Auto</td>
      <td>ankai</td>
      <td>hff6124g03ev3</td>
      <td>2019</td>
      <td>ankai hff6124g03ev3</td>
      <td>Республика Казахстан</td>
      <td>электричество</td>
      <td>88.00</td>
      <td>NaN</td>
      <td>2WD</td>
      <td>Костанай</td>
      <td>Allur Auto Almaty</td>
      <td>Юр. Лицо</td>
      <td>1.00</td>
      <td>307986.36</td>
      <td>307986.36</td>
      <td>Костанайская область</td>
      <td>Коммерческие автомобили</td>
      <td>Большие автобусы</td>
      <td>Локальное производство</td>
    </tr>
    <tr>
      <th>39823</th>
      <td>2019</td>
      <td>Июль</td>
      <td>Allur Auto</td>
      <td>ankai</td>
      <td>hff6124g03ev3</td>
      <td>2019</td>
      <td>ankai hff6124g03ev3</td>
      <td>Республика Казахстан</td>
      <td>электричество</td>
      <td>88.00</td>
      <td>NaN</td>
      <td>2WD</td>
      <td>Костанай</td>
      <td>Allur Auto Almaty</td>
      <td>Юр. Лицо</td>
      <td>1.00</td>
      <td>307986.36</td>
      <td>307986.36</td>
      <td>Костанайская область</td>
      <td>Коммерческие автомобили</td>
      <td>Большие автобусы</td>
      <td>Локальное производство</td>
    </tr>
    <tr>
      <th>39824</th>
      <td>2019</td>
      <td>Июль</td>
      <td>Allur Auto</td>
      <td>ankai</td>
      <td>hff6124g03ev3</td>
      <td>2019</td>
      <td>ankai hff6124g03ev3</td>
      <td>Республика Казахстан</td>
      <td>электричество</td>
      <td>88.00</td>
      <td>NaN</td>
      <td>2WD</td>
      <td>Костанай</td>
      <td>Allur Auto Almaty</td>
      <td>Юр. Лицо</td>
      <td>1.00</td>
      <td>307986.36</td>
      <td>307986.36</td>
      <td>Костанайская область</td>
      <td>Коммерческие автомобили</td>
      <td>Большие автобусы</td>
      <td>Локальное производство</td>
    </tr>
    <tr>
      <th>39825</th>
      <td>2019</td>
      <td>Июль</td>
      <td>Allur Auto</td>
      <td>ankai</td>
      <td>hff6124g03ev3</td>
      <td>2019</td>
      <td>ankai hff6124g03ev3</td>
      <td>Республика Казахстан</td>
      <td>электричество</td>
      <td>88.00</td>
      <td>NaN</td>
      <td>2WD</td>
      <td>Костанай</td>
      <td>Allur Auto Almaty</td>
      <td>Юр. Лицо</td>
      <td>1.00</td>
      <td>307986.36</td>
      <td>307986.36</td>
      <td>Костанайская область</td>
      <td>Коммерческие автомобили</td>
      <td>Большие автобусы</td>
      <td>Локальное производство</td>
    </tr>
    <tr>
      <th>39826</th>
      <td>2019</td>
      <td>Июль</td>
      <td>Allur Auto</td>
      <td>ankai</td>
      <td>hff6124g03ev3</td>
      <td>2019</td>
      <td>ankai hff6124g03ev3</td>
      <td>Республика Казахстан</td>
      <td>электричество</td>
      <td>88.00</td>
      <td>NaN</td>
      <td>2WD</td>
      <td>Костанай</td>
      <td>Allur Auto Almaty</td>
      <td>Юр. Лицо</td>
      <td>1.00</td>
      <td>307986.36</td>
      <td>307986.36</td>
      <td>Костанайская область</td>
      <td>Коммерческие автомобили</td>
      <td>Большие автобусы</td>
      <td>Локальное производство</td>
    </tr>
    <tr>
      <th>39827</th>
      <td>2019</td>
      <td>Июль</td>
      <td>Allur Auto</td>
      <td>ankai</td>
      <td>hff6124g03ev3</td>
      <td>2019</td>
      <td>ankai hff6124g03ev3</td>
      <td>Республика Казахстан</td>
      <td>электричество</td>
      <td>88.00</td>
      <td>NaN</td>
      <td>2WD</td>
      <td>Костанай</td>
      <td>Allur Auto Almaty</td>
      <td>Юр. Лицо</td>
      <td>1.00</td>
      <td>307986.36</td>
      <td>307986.36</td>
      <td>Костанайская область</td>
      <td>Коммерческие автомобили</td>
      <td>Большие автобусы</td>
      <td>Локальное производство</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-eecd45cd-aaad-49ec-a6bb-7bd980d5341e')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-eecd45cd-aaad-49ec-a6bb-7bd980d5341e button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-eecd45cd-aaad-49ec-a6bb-7bd980d5341e');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-ab79b80a-a4b4-492f-9b02-f25e57f77690">
  <button class="colab-df-quickchart" onclick="quickchart('df-ab79b80a-a4b4-492f-9b02-f25e57f77690')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-ab79b80a-a4b4-492f-9b02-f25e57f77690 button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>
    </div>
  </div>

</div>
</div>
<div class="cell markdown" id="26lyHhFyQ0jX">
<p>Все выбросы относятся к электрокарам. 400 - лошадиные силы, 88 -
киловатт в час. 0 литров у одной машины - uaz 3741.</p>
</div>
<div class="cell code" data-execution_count="525" id="KniikZJdK0PH">
<div class="sourceCode" id="cb62"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="co"># для электрокаров поставим заглушку</span></span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a>df.loc[df[<span class="st">&#39;объём_двиг_л&#39;</span>] <span class="op">&gt;</span> <span class="dv">50</span>, <span class="st">&#39;объём_двиг_л&#39;</span>] <span class="op">=</span> <span class="op">-</span><span class="dv">1</span></span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-4"><a href="#cb62-4" aria-hidden="true" tabindex="-1"></a><span class="co"># для uaz 3741 установим моду</span></span>
<span id="cb62-5"><a href="#cb62-5" aria-hidden="true" tabindex="-1"></a>df.loc[df[<span class="st">&#39;объём_двиг_л&#39;</span>] <span class="op">==</span> <span class="dv">0</span>, <span class="st">&#39;объём_двиг_л&#39;</span>] <span class="op">=</span> (</span>
<span id="cb62-6"><a href="#cb62-6" aria-hidden="true" tabindex="-1"></a>    df[df[<span class="st">&#39;авто&#39;</span>] <span class="op">==</span> <span class="st">&#39;uaz 3741&#39;</span>][<span class="st">&#39;объём_двиг_л&#39;</span>].mode()[<span class="dv">0</span>]</span>
<span id="cb62-7"><a href="#cb62-7" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="526"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="NOEnkQf9YJ0V" data-outputId="40545be1-8bea-41f7-8258-4fe200cd598a">
<div class="sourceCode" id="cb63"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="co"># выведем описание столбца после изменений</span></span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a>df[<span class="st">&#39;объём_двиг_л&#39;</span>].describe()</span></code></pre></div>
<div class="output execute_result" data-execution_count="526">
<pre><code>count   39960.00
mean        2.51
std         1.73
min        -1.00
25%         1.60
50%         2.00
75%         2.69
max        26.70
Name: объём_двиг_л, dtype: float64</code></pre>
</div>
</div>
<div class="cell markdown" id="4K2zxCNA3Ikp">
<p>Медиана равна 2л. 1-й квартиль = 1.6л, 3-й квартиль = 2.69л.</p>
</div>
<div class="cell markdown" id="a9E-FlyR6Thl">
<p>Существуют грузовые автомобили, чей объем двигателя достигает 15
литров. Рассмотрим, какие автомобили с объемом более 15 литров.</p>
</div>
<div class="cell code" data-execution_count="527"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="c1E2irgT6Fmd" data-outputId="f4d28f28-22c2-4b4f-b327-a5720526ef33">
<div class="sourceCode" id="cb65"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="co"># выведем уникальные названия авто с объемом двигателя больше 15</span></span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a>big_engine_auto <span class="op">=</span> df[df[<span class="st">&#39;объём_двиг_л&#39;</span>] <span class="op">&gt;</span> <span class="dv">15</span>][<span class="st">&#39;авто&#39;</span>].unique()</span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true" tabindex="-1"></a>big_engine_auto</span></code></pre></div>
<div class="output execute_result" data-execution_count="527">
<pre><code>array([&#39;chevrolet niva&#39;], dtype=object)</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="528"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="LPBCW8dt7Cdr" data-outputId="893a805a-d00d-45b4-9892-3f9ada4fb64b">
<div class="sourceCode" id="cb67"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="co"># найдем моду объема двигателя данного авто</span></span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a>chevrolet_niva_mode <span class="op">=</span> (</span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true" tabindex="-1"></a>    df[df[<span class="st">&#39;авто&#39;</span>] <span class="op">==</span> <span class="st">&#39;chevrolet niva&#39;</span>][<span class="st">&#39;объём_двиг_л&#39;</span>].mode()[<span class="dv">0</span>]</span>
<span id="cb67-4"><a href="#cb67-4" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb67-5"><a href="#cb67-5" aria-hidden="true" tabindex="-1"></a>chevrolet_niva_mode</span></code></pre></div>
<div class="output execute_result" data-execution_count="528">
<pre><code>1.7</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="529" id="LETDnuP37Wob">
<div class="sourceCode" id="cb69"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="co"># заполним некорректные значения модой</span></span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a>df.loc[df[<span class="st">&#39;авто&#39;</span>].isin(big_engine_auto) <span class="op">&amp;</span> (df[<span class="st">&#39;объём_двиг_л&#39;</span>] <span class="op">&gt;</span> <span class="dv">15</span>),</span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a> [<span class="st">&#39;объём_двиг_л&#39;</span>]] <span class="op">=</span> chevrolet_niva_mode</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="530"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:628}"
id="sSzair8M7dJw" data-outputId="de6cd96a-39ec-431b-c14b-fab7271846a2">
<div class="sourceCode" id="cb70"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="co"># построим ящик с усами</span></span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">15</span>, <span class="dv">6</span>))</span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true" tabindex="-1"></a>sns.boxplot(x<span class="op">=</span>df[<span class="st">&#39;объём_двиг_л&#39;</span>])</span>
<span id="cb70-4"><a href="#cb70-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-5"><a href="#cb70-5" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb70-6"><a href="#cb70-6" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">&#39;Распределения объемов двигателя&#39;</span>)<span class="op">;</span></span></code></pre></div>
<div class="output display_data">
<p><img
src="vertopal_9b40e0aaef914c45a9852524805a792d/4f69d732e4bcf64748bb6ccffeb572719b4d46ed.png" /></p>
</div>
</div>
<div class="cell code" data-execution_count="531"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="BwWc3R-h7jRw" data-outputId="0a6d5f85-500a-4988-e3ef-d636cdd3a101">
<div class="sourceCode" id="cb71"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="co"># выведем описание данных</span></span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a>df[<span class="st">&#39;объём_двиг_л&#39;</span>].describe()</span></code></pre></div>
<div class="output execute_result" data-execution_count="531">
<pre><code>count   39960.00
mean        2.50
std         1.69
min        -1.00
25%         1.60
50%         2.00
75%         2.69
max        14.90
Name: объём_двиг_л, dtype: float64</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="532"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="LuTqasROboQT" data-outputId="5d669017-dc25-46e4-fc0a-580dae6800b2">
<div class="sourceCode" id="cb73"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="co"># выведем инфо о столбце</span></span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a>info(df, <span class="st">&#39;объём_двиг_л&#39;</span>)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>&lt;class &#39;pandas.core.series.Series&#39;&gt;
Int64Index: 39960 entries, 0 to 39552
Series name: объём_двиг_л
Non-Null Count  Dtype  
--------------  -----  
39960 non-null  float64
dtypes: float64(1)
memory usage: 624.4 KB
None 

[ 1.4    2.     3.     4.4    6.6    1.5    1.596  2.4    1.7   14.7
 13.7   12.7   11.7   10.7    9.7    8.7    7.7    6.7    5.7    4.7
  3.7    2.7    6.2    2.5    1.6    2.8    4.3    3.9    7.5   12.3
  3.5    5.6    5.2    5.     1.598  1.248  1.998  2.359  1.999  3.342
  1.591  3.47   1.69   1.774  4.6    1.8   10.5    4.     5.5   12.
 12.8   11.     2.2    1.2    1.485 13.     1.33   2.693  3.8    3.6
  7.6    4.9    4.98   2.9   -1.     8.4    6.5   11.76   9.    14.9
 10.   ]
</code></pre>
</div>
</div>
<div class="cell markdown" id="ffNNSh_6bth3">
<p>Столбец 'объем_двиг_л' избавлен от пропусков и приведен к правильному
типу данных.</p>
<p>Среднее значение 2.5л, медианное - 2л. 1.6л имеет менее 25% авто,
2.69л - менее 75%. Максимальное значение достигает 14.9л - грузовые
авто.</p>
</div>
<section id="323-столбец-коробка_передач" class="cell markdown"
id="W9I08u8K8Q8H">
<h3>3.2.3 Столбец 'коробка_передач'</h3>
</section>
<div class="cell code" data-execution_count="533"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="5a1E9k1D8hRa" data-outputId="39a4b94e-6226-4c25-b86b-ed6a67f2fb00">
<div class="sourceCode" id="cb75"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a>info(df, <span class="st">&#39;коробка_передач&#39;</span>)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>&lt;class &#39;pandas.core.series.Series&#39;&gt;
Int64Index: 39960 entries, 0 to 39552
Series name: коробка_передач
Non-Null Count  Dtype 
--------------  ----- 
36705 non-null  object
dtypes: object(1)
memory usage: 624.4+ KB
None 

[&#39;S-tronic&#39; &#39;S-Tronic&#39; &#39;Tiptronic&#39; &#39;АКПП&#39; &#39;АКП&#39; &#39;Steptronic&#39; &#39;AT&#39; &#39;6 АТ&#39;
 &#39;5 МТ&#39; &#39;6АТ&#39; &#39;MT&#39; &#39;8AT&#39; &#39;5МТ&#39; &#39;Powershift S6&#39; &#39;6AT&#39; &#39;Мех.&#39; &#39;6 AT&#39; &#39;6 MT&#39;
 &#39;6MT&#39; &#39;5 AT&#39; &#39;5AT&#39; &#39;МКПП&#39; nan &#39;7 DCT&#39; &#39;7DCT&#39; &#39;8 AT&#39; &#39;МТ&#39; &#39;CVT&#39; &#39;DCT&#39;
 &#39;4 АТ&#39; &#39;6 МТ&#39; &#39;6МТ&#39; &#39;4АТ&#39; &#39;4AT&#39; &#39;8АТ&#39; &#39;8 АТ&#39; &#39;5MT&#39; &#39;AMT&#39; &#39;CVT (вариатор)&#39;
 &#39;CVT (вариATор)&#39; &#39;CVT(вAриATор)&#39; &#39;7G-TRONIC&#39; &#39;9G-TRONIC&#39; &#39;12AT&#39; &#39;12АТ&#39;
 &#39;5АТ&#39; &#39;7АТ&#39; &#39;7AT&#39; &#39;6M/T&#39; &#39;PDK&#39; &#39;8-ступ АКПП&#39; &#39;8&#39; &#39;8АКПП&#39;
 &#39;8 АКПП Tiptronic S&#39; &#39;7 АКПП (PDK)&#39; &#39;7 АКПП PDK&#39; &#39;8 АКПП (PDK)&#39; &#39;АТ&#39; &#39;АT&#39;
 &#39;МT&#39; &#39;0&#39; &#39;7 DSG&#39; &#39;7DSG&#39; &#39;6 DSG&#39; &#39;6DSG&#39; &#39;#Н/Д&#39; &#39;2,693&#39; &#39;DSG&#39; &#39;6A&#39; &#39;6А&#39;
 &#39;5M&#39; &#39;A/T&#39; &#39;M/T&#39; &#39;МКП&#39; &#39;5М&#39; &#39;М/T&#39; &#39;7 АКП&#39; &#39;7АКП&#39; &#39;А/T&#39; &#39;8A&#39; &#39;TDI&#39; &#39;9AT&#39;
 &#39;РЕДУКТОР&#39;]
</code></pre>
</div>
</div>
<div class="cell markdown" id="kh2sh17j8tY7">
<p>В столбце есть пропуски, а также большое количество названий коробок
передач, которые по итогу должны быть приведены к следующим
категориям:</p>
<ul>
<li>автомат (все, что не механика);</li>
<li>механика.</li>
</ul>
</div>
<div class="cell code" data-execution_count="534" id="j9iy6LCmD0MA">
<div class="sourceCode" id="cb77"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a><span class="co"># приведем значения столбца к нижнему регистру</span></span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a>df[<span class="st">&#39;коробка_передач&#39;</span>] <span class="op">=</span> df[<span class="st">&#39;коробка_передач&#39;</span>].<span class="bu">str</span>.lower()</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="535"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="HgJEP7fH9S2z" data-outputId="b94244fb-54d3-467a-e01e-12677f1bab71">
<div class="sourceCode" id="cb78"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a><span class="co"># создадим список коробок передач</span></span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a><span class="co"># уберем из списка пустые значения</span></span>
<span id="cb78-3"><a href="#cb78-3" aria-hidden="true" tabindex="-1"></a>transmission_list <span class="op">=</span> (</span>
<span id="cb78-4"><a href="#cb78-4" aria-hidden="true" tabindex="-1"></a>    df[<span class="op">~</span>(df[<span class="st">&#39;коробка_передач&#39;</span>].isna()) <span class="op">&amp;</span></span>
<span id="cb78-5"><a href="#cb78-5" aria-hidden="true" tabindex="-1"></a>     (df[<span class="st">&#39;коробка_передач&#39;</span>] <span class="op">!=</span> <span class="st">&#39;#н/д&#39;</span>)][<span class="st">&#39;коробка_передач&#39;</span>].unique()</span>
<span id="cb78-6"><a href="#cb78-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb78-7"><a href="#cb78-7" aria-hidden="true" tabindex="-1"></a>transmission_list</span></code></pre></div>
<div class="output execute_result" data-execution_count="535">
<pre><code>array([&#39;s-tronic&#39;, &#39;tiptronic&#39;, &#39;акпп&#39;, &#39;акп&#39;, &#39;steptronic&#39;, &#39;at&#39;, &#39;6 ат&#39;,
       &#39;5 мт&#39;, &#39;6ат&#39;, &#39;mt&#39;, &#39;8at&#39;, &#39;5мт&#39;, &#39;powershift s6&#39;, &#39;6at&#39;, &#39;мех.&#39;,
       &#39;6 at&#39;, &#39;6 mt&#39;, &#39;6mt&#39;, &#39;5 at&#39;, &#39;5at&#39;, &#39;мкпп&#39;, &#39;7 dct&#39;, &#39;7dct&#39;,
       &#39;8 at&#39;, &#39;мт&#39;, &#39;cvt&#39;, &#39;dct&#39;, &#39;4 ат&#39;, &#39;6 мт&#39;, &#39;6мт&#39;, &#39;4ат&#39;, &#39;4at&#39;,
       &#39;8ат&#39;, &#39;8 ат&#39;, &#39;5mt&#39;, &#39;amt&#39;, &#39;cvt (вариатор)&#39;, &#39;cvt (вариatор)&#39;,
       &#39;cvt(вaриatор)&#39;, &#39;7g-tronic&#39;, &#39;9g-tronic&#39;, &#39;12at&#39;, &#39;12ат&#39;, &#39;5ат&#39;,
       &#39;7ат&#39;, &#39;7at&#39;, &#39;6m/t&#39;, &#39;pdk&#39;, &#39;8-ступ акпп&#39;, &#39;8&#39;, &#39;8акпп&#39;,
       &#39;8 акпп tiptronic s&#39;, &#39;7 акпп (pdk)&#39;, &#39;7 акпп pdk&#39;, &#39;8 акпп (pdk)&#39;,
       &#39;ат&#39;, &#39;аt&#39;, &#39;мt&#39;, &#39;0&#39;, &#39;7 dsg&#39;, &#39;7dsg&#39;, &#39;6 dsg&#39;, &#39;6dsg&#39;, &#39;2,693&#39;,
       &#39;dsg&#39;, &#39;6a&#39;, &#39;6а&#39;, &#39;5m&#39;, &#39;a/t&#39;, &#39;m/t&#39;, &#39;мкп&#39;, &#39;5м&#39;, &#39;м/t&#39;, &#39;7 акп&#39;,
       &#39;7акп&#39;, &#39;а/t&#39;, &#39;8a&#39;, &#39;tdi&#39;, &#39;9at&#39;, &#39;редуктор&#39;], dtype=object)</code></pre>
</div>
</div>
<div class="cell markdown" id="7sx9JTclJ7Co">
<p>Выведем механические коробки передач.</p>
</div>
<div class="cell code" data-execution_count="536"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="bXGVPTI-9TNL" data-outputId="629e94da-78f8-40bc-80c1-3bb5dbb95268">
<div class="sourceCode" id="cb80"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a><span class="co"># создадим регулярное выражение по поиску буквы &#39;м&#39;</span></span>
<span id="cb80-2"><a href="#cb80-2" aria-hidden="true" tabindex="-1"></a><span class="co"># регистр игнорируем</span></span>
<span id="cb80-3"><a href="#cb80-3" aria-hidden="true" tabindex="-1"></a>pattern <span class="op">=</span> re.<span class="bu">compile</span>(<span class="vs">r&#39;.*M.*|.*М.*&#39;</span>, flags<span class="op">=</span>re.IGNORECASE)</span>
<span id="cb80-4"><a href="#cb80-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-5"><a href="#cb80-5" aria-hidden="true" tabindex="-1"></a><span class="co"># найдем только те значения, которые являются строками</span></span>
<span id="cb80-6"><a href="#cb80-6" aria-hidden="true" tabindex="-1"></a><span class="co"># и соответствуют регулярному выражению</span></span>
<span id="cb80-7"><a href="#cb80-7" aria-hidden="true" tabindex="-1"></a>result_mt_list <span class="op">=</span> (</span>
<span id="cb80-8"><a href="#cb80-8" aria-hidden="true" tabindex="-1"></a>    [value <span class="cf">for</span> value <span class="kw">in</span> df[<span class="st">&#39;коробка_передач&#39;</span>].unique()</span>
<span id="cb80-9"><a href="#cb80-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="bu">isinstance</span>(value, <span class="bu">str</span>) <span class="kw">and</span> pattern.match(value)]</span>
<span id="cb80-10"><a href="#cb80-10" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb80-11"><a href="#cb80-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-12"><a href="#cb80-12" aria-hidden="true" tabindex="-1"></a><span class="co"># создадим словарь соответствия каждого названия коробки названию &#39;MT&#39;</span></span>
<span id="cb80-13"><a href="#cb80-13" aria-hidden="true" tabindex="-1"></a>mt_dict <span class="op">=</span> <span class="bu">dict</span>(<span class="bu">zip</span>(result_mt_list, [<span class="st">&#39;MT&#39;</span>] <span class="op">*</span> <span class="bu">len</span>(result_mt_list)))</span>
<span id="cb80-14"><a href="#cb80-14" aria-hidden="true" tabindex="-1"></a>mt_dict</span></code></pre></div>
<div class="output execute_result" data-execution_count="536">
<pre><code>{&#39;5 мт&#39;: &#39;MT&#39;,
 &#39;mt&#39;: &#39;MT&#39;,
 &#39;5мт&#39;: &#39;MT&#39;,
 &#39;мех.&#39;: &#39;MT&#39;,
 &#39;6 mt&#39;: &#39;MT&#39;,
 &#39;6mt&#39;: &#39;MT&#39;,
 &#39;мкпп&#39;: &#39;MT&#39;,
 &#39;мт&#39;: &#39;MT&#39;,
 &#39;6 мт&#39;: &#39;MT&#39;,
 &#39;6мт&#39;: &#39;MT&#39;,
 &#39;5mt&#39;: &#39;MT&#39;,
 &#39;amt&#39;: &#39;MT&#39;,
 &#39;6m/t&#39;: &#39;MT&#39;,
 &#39;мt&#39;: &#39;MT&#39;,
 &#39;5m&#39;: &#39;MT&#39;,
 &#39;m/t&#39;: &#39;MT&#39;,
 &#39;мкп&#39;: &#39;MT&#39;,
 &#39;5м&#39;: &#39;MT&#39;,
 &#39;м/t&#39;: &#39;MT&#39;}</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="537"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="mu-rW0cHIYp5" data-outputId="5ce1c069-e8ec-4ec9-9477-b319b8786cc0">
<div class="sourceCode" id="cb82"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a><span class="co"># выведем список автоматических коробок передач</span></span>
<span id="cb82-2"><a href="#cb82-2" aria-hidden="true" tabindex="-1"></a><span class="co"># удалим механические коробки из общего списка</span></span>
<span id="cb82-3"><a href="#cb82-3" aria-hidden="true" tabindex="-1"></a>result_at_list <span class="op">=</span> (</span>
<span id="cb82-4"><a href="#cb82-4" aria-hidden="true" tabindex="-1"></a>    <span class="bu">list</span>(<span class="bu">filter</span>(<span class="kw">lambda</span> x: x <span class="kw">not</span> <span class="kw">in</span> result_mt_list, transmission_list))</span>
<span id="cb82-5"><a href="#cb82-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb82-6"><a href="#cb82-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-7"><a href="#cb82-7" aria-hidden="true" tabindex="-1"></a><span class="co"># создадим словарь соответствия каждого названия коробки названию &#39;AT&#39;</span></span>
<span id="cb82-8"><a href="#cb82-8" aria-hidden="true" tabindex="-1"></a>at_dict <span class="op">=</span> <span class="bu">dict</span>(<span class="bu">zip</span>(result_at_list, [<span class="st">&#39;AT&#39;</span>] <span class="op">*</span> <span class="bu">len</span>(result_at_list)))</span>
<span id="cb82-9"><a href="#cb82-9" aria-hidden="true" tabindex="-1"></a>at_dict</span></code></pre></div>
<div class="output execute_result" data-execution_count="537">
<pre><code>{&#39;s-tronic&#39;: &#39;AT&#39;,
 &#39;tiptronic&#39;: &#39;AT&#39;,
 &#39;акпп&#39;: &#39;AT&#39;,
 &#39;акп&#39;: &#39;AT&#39;,
 &#39;steptronic&#39;: &#39;AT&#39;,
 &#39;at&#39;: &#39;AT&#39;,
 &#39;6 ат&#39;: &#39;AT&#39;,
 &#39;6ат&#39;: &#39;AT&#39;,
 &#39;8at&#39;: &#39;AT&#39;,
 &#39;powershift s6&#39;: &#39;AT&#39;,
 &#39;6at&#39;: &#39;AT&#39;,
 &#39;6 at&#39;: &#39;AT&#39;,
 &#39;5 at&#39;: &#39;AT&#39;,
 &#39;5at&#39;: &#39;AT&#39;,
 &#39;7 dct&#39;: &#39;AT&#39;,
 &#39;7dct&#39;: &#39;AT&#39;,
 &#39;8 at&#39;: &#39;AT&#39;,
 &#39;cvt&#39;: &#39;AT&#39;,
 &#39;dct&#39;: &#39;AT&#39;,
 &#39;4 ат&#39;: &#39;AT&#39;,
 &#39;4ат&#39;: &#39;AT&#39;,
 &#39;4at&#39;: &#39;AT&#39;,
 &#39;8ат&#39;: &#39;AT&#39;,
 &#39;8 ат&#39;: &#39;AT&#39;,
 &#39;cvt (вариатор)&#39;: &#39;AT&#39;,
 &#39;cvt (вариatор)&#39;: &#39;AT&#39;,
 &#39;cvt(вaриatор)&#39;: &#39;AT&#39;,
 &#39;7g-tronic&#39;: &#39;AT&#39;,
 &#39;9g-tronic&#39;: &#39;AT&#39;,
 &#39;12at&#39;: &#39;AT&#39;,
 &#39;12ат&#39;: &#39;AT&#39;,
 &#39;5ат&#39;: &#39;AT&#39;,
 &#39;7ат&#39;: &#39;AT&#39;,
 &#39;7at&#39;: &#39;AT&#39;,
 &#39;pdk&#39;: &#39;AT&#39;,
 &#39;8-ступ акпп&#39;: &#39;AT&#39;,
 &#39;8&#39;: &#39;AT&#39;,
 &#39;8акпп&#39;: &#39;AT&#39;,
 &#39;8 акпп tiptronic s&#39;: &#39;AT&#39;,
 &#39;7 акпп (pdk)&#39;: &#39;AT&#39;,
 &#39;7 акпп pdk&#39;: &#39;AT&#39;,
 &#39;8 акпп (pdk)&#39;: &#39;AT&#39;,
 &#39;ат&#39;: &#39;AT&#39;,
 &#39;аt&#39;: &#39;AT&#39;,
 &#39;0&#39;: &#39;AT&#39;,
 &#39;7 dsg&#39;: &#39;AT&#39;,
 &#39;7dsg&#39;: &#39;AT&#39;,
 &#39;6 dsg&#39;: &#39;AT&#39;,
 &#39;6dsg&#39;: &#39;AT&#39;,
 &#39;2,693&#39;: &#39;AT&#39;,
 &#39;dsg&#39;: &#39;AT&#39;,
 &#39;6a&#39;: &#39;AT&#39;,
 &#39;6а&#39;: &#39;AT&#39;,
 &#39;a/t&#39;: &#39;AT&#39;,
 &#39;7 акп&#39;: &#39;AT&#39;,
 &#39;7акп&#39;: &#39;AT&#39;,
 &#39;а/t&#39;: &#39;AT&#39;,
 &#39;8a&#39;: &#39;AT&#39;,
 &#39;tdi&#39;: &#39;AT&#39;,
 &#39;9at&#39;: &#39;AT&#39;,
 &#39;редуктор&#39;: &#39;AT&#39;}</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="538" id="eZo7Tn-eLcsH">
<div class="sourceCode" id="cb84"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a><span class="co"># объединим словари</span></span>
<span id="cb84-2"><a href="#cb84-2" aria-hidden="true" tabindex="-1"></a>mt_dict.update(at_dict)</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="539" id="tPaw6mAZKtch">
<div class="sourceCode" id="cb85"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a><span class="co"># заменим названия коробки передач в соответствии с общим словарем</span></span>
<span id="cb85-2"><a href="#cb85-2" aria-hidden="true" tabindex="-1"></a>df[<span class="st">&#39;коробка_передач&#39;</span>] <span class="op">=</span> df[<span class="st">&#39;коробка_передач&#39;</span>].<span class="bu">map</span>(mt_dict)</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="540"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="RHBMhH-gK422" data-outputId="98d75a95-0322-442e-c51a-6278a6f91b49">
<div class="sourceCode" id="cb86"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a><span class="co"># проверим уникальные значения</span></span>
<span id="cb86-2"><a href="#cb86-2" aria-hidden="true" tabindex="-1"></a>df[<span class="st">&#39;коробка_передач&#39;</span>].unique()</span></code></pre></div>
<div class="output execute_result" data-execution_count="540">
<pre><code>array([&#39;AT&#39;, &#39;MT&#39;, nan], dtype=object)</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="541"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="XxeA3v77X1ui" data-outputId="3f5b945b-0bde-4a88-eade-da25c4cba879">
<div class="sourceCode" id="cb88"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a>df[<span class="st">&#39;коробка_передач&#39;</span>].value_counts()</span></code></pre></div>
<div class="output execute_result" data-execution_count="541">
<pre><code>AT    27888
MT     8813
Name: коробка_передач, dtype: int64</code></pre>
</div>
</div>
<div class="cell markdown" id="jHD_FqtAMLvE">
<p>Осталось разобраться с пропусками.</p>
</div>
<div class="cell code" data-execution_count="542" id="ZI5tt-qGw2eE">
<div class="sourceCode" id="cb90"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a><span class="co"># применим функцию заполнения пропусков</span></span>
<span id="cb90-2"><a href="#cb90-2" aria-hidden="true" tabindex="-1"></a>df, df1 <span class="op">=</span> processing_nans(df, <span class="st">&#39;коробка_передач&#39;</span>, <span class="st">&#39;авто&#39;</span>, <span class="st">&#39;бренд&#39;</span>)</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="543"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="x0HXQYN1RR91" data-outputId="a070d4e3-f765-4cb1-d925-401192a0a121">
<div class="sourceCode" id="cb91"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a><span class="co"># найдем авто и количество пропусков по нему</span></span>
<span id="cb91-2"><a href="#cb91-2" aria-hidden="true" tabindex="-1"></a>df1[<span class="st">&#39;авто&#39;</span>].value_counts()</span></code></pre></div>
<div class="output execute_result" data-execution_count="543">
<pre><code>isuzu nmr               89
isuzu d-max             73
mazda cx-5              51
shacman sx3258dr384     43
mazda 6                 30
isuzu npr               30
mazda cx-9              26
foton bj1069vdjea-f1    19
man tg                  11
dong feng bwc6665ga5    10
foton bj3253dmpkb-ad     9
scania r-series          7
урал 4320                7
mazda 3                  5
isuzu nqr                3
isuzu nps                2
урал 5557                2
scania s-series          2
scania p-series          2
isuzu nms85              1
урал 4320-1951-40        1
урал 4320-1951-60        1
scania g-series          1
урал 32551               1
Name: авто, dtype: int64</code></pre>
</div>
</div>
<div class="cell markdown" id="4k21r3fZZvr3">
<p>isuzu, shacman, foton, man, dong feng, урал - грузовики или
спецтехника с механикой.</p>
<p>Автомат - scania, mazda (исходя из соотношения рынка продаж АКПП и
МКПП).</p>
</div>
<div class="cell code" data-execution_count="544"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="ZVt4TmBJReGN" data-outputId="ef3b4fd8-ccca-4918-cf77-481374108fcc">
<div class="sourceCode" id="cb93"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a><span class="co"># создадим список брендов</span></span>
<span id="cb93-2"><a href="#cb93-2" aria-hidden="true" tabindex="-1"></a>brand_list <span class="op">=</span> df1[<span class="st">&#39;бренд&#39;</span>].unique()</span>
<span id="cb93-3"><a href="#cb93-3" aria-hidden="true" tabindex="-1"></a>brand_list</span></code></pre></div>
<div class="output execute_result" data-execution_count="544">
<pre><code>array([&#39;isuzu&#39;, &#39;man&#39;, &#39;scania&#39;, &#39;foton&#39;, &#39;mazda&#39;, &#39;урал&#39;, &#39;shacman&#39;,
       &#39;dong feng&#39;], dtype=object)</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="545" id="JZ8zMn6Mbra5">
<div class="sourceCode" id="cb95"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a><span class="co"># создадим список коробок передач</span></span>
<span id="cb95-2"><a href="#cb95-2" aria-hidden="true" tabindex="-1"></a>transmission_list <span class="op">=</span> [<span class="st">&#39;MT&#39;</span>, <span class="st">&#39;MT&#39;</span>, <span class="st">&#39;AT&#39;</span>, <span class="st">&#39;MT&#39;</span>, <span class="st">&#39;AT&#39;</span>, <span class="st">&#39;MT&#39;</span>, <span class="st">&#39;MT&#39;</span>, <span class="st">&#39;MT&#39;</span>]</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="546" id="mtngEyJhxKFy">
<div class="sourceCode" id="cb96"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a><span class="co"># применим функцию заполнения последних пропусков</span></span>
<span id="cb96-2"><a href="#cb96-2" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> processing_last_nans(df,</span>
<span id="cb96-3"><a href="#cb96-3" aria-hidden="true" tabindex="-1"></a>                          df1,</span>
<span id="cb96-4"><a href="#cb96-4" aria-hidden="true" tabindex="-1"></a>                          <span class="st">&#39;коробка_передач&#39;</span>,</span>
<span id="cb96-5"><a href="#cb96-5" aria-hidden="true" tabindex="-1"></a>                          <span class="st">&#39;бренд&#39;</span>,</span>
<span id="cb96-6"><a href="#cb96-6" aria-hidden="true" tabindex="-1"></a>                          brand_list,</span>
<span id="cb96-7"><a href="#cb96-7" aria-hidden="true" tabindex="-1"></a>                          transmission_list)</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="547"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="a678sVrLeFqq" data-outputId="eecdfb8f-8eb8-451a-fb77-ce417fbaea8b">
<div class="sourceCode" id="cb97"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a><span class="co"># выведем инфо о столбце</span></span>
<span id="cb97-2"><a href="#cb97-2" aria-hidden="true" tabindex="-1"></a>info(df, <span class="st">&#39;коробка_передач&#39;</span>)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>&lt;class &#39;pandas.core.series.Series&#39;&gt;
Int64Index: 39960 entries, 0 to 39552
Series name: коробка_передач
Non-Null Count  Dtype 
--------------  ----- 
39960 non-null  object
dtypes: object(1)
memory usage: 624.4+ KB
None 

[&#39;AT&#39; &#39;MT&#39;]
</code></pre>
</div>
</div>
<div class="cell markdown" id="uBdrCHQqeMb6">
<p>Пропуски заполнены, значения приведены к правильным.</p>
</div>
<section id="324-столбец-тип_привода" class="cell markdown"
id="_BL8blb6eQ3o">
<h3>3.2.4 Столбец 'тип_привода'</h3>
</section>
<div class="cell code" data-execution_count="548"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="R7K8-K2Cx3mM" data-outputId="f91f9b05-8d93-4523-beca-cbe88ac47198">
<div class="sourceCode" id="cb99"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a><span class="co"># выведем инфо о столбце</span></span>
<span id="cb99-2"><a href="#cb99-2" aria-hidden="true" tabindex="-1"></a>info(df, <span class="st">&#39;тип_привода&#39;</span>)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>&lt;class &#39;pandas.core.series.Series&#39;&gt;
Int64Index: 39960 entries, 0 to 39552
Series name: тип_привода
Non-Null Count  Dtype 
--------------  ----- 
35671 non-null  object
dtypes: object(1)
memory usage: 624.4+ KB
None 

[&#39;передний&#39; &#39;FWD&#39; &#39;quattro&#39; &#39;Задний&#39; &#39;Полный&#39; &#39;AWD&#39; &#39;Передний&#39; &#39;4WD&#39;
 &#39;4х2.2&#39; &#39;RWD&#39; &#39;2 WD&#39; &#39;2WD&#39; &#39;4 WD&#39; nan &#39;4X2&#39; &#39;Передний (FF)&#39; &#39;0&#39; &#39;FF&#39;
 &#39;#Н/Д&#39; &#39;полный&#39; &#39;4Motion&#39; &#39;Астана&#39; &#39;4X4&#39; &#39;4х4&#39; &#39;4x4&#39; &#39;4x2&#39; &#39;4х2&#39;]
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="549" id="_MAl2ppgvJZS">
<div class="sourceCode" id="cb101"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a><span class="co"># приведем столбец к нижнему регистру</span></span>
<span id="cb101-2"><a href="#cb101-2" aria-hidden="true" tabindex="-1"></a>df[<span class="st">&#39;тип_привода&#39;</span>] <span class="op">=</span> df[<span class="st">&#39;тип_привода&#39;</span>].<span class="bu">str</span>.lower()</span></code></pre></div>
</div>
<div class="cell markdown" id="PIM48PvytSG4">
<p>Для начала нужно привести значения к следующему виду:</p>
<ul>
<li>RWD – задний привод,</li>
<li>FWD – передний привод,</li>
<li>4WD – полный привод,</li>
<li>2WD – все остальное.</li>
</ul>
</div>
<div class="cell code" data-execution_count="550"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="gA-43SDGutPZ" data-outputId="b01deb90-2a1a-4297-8323-b608d7b2f8e6">
<div class="sourceCode" id="cb102"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a><span class="co"># создадим список приводов</span></span>
<span id="cb102-2"><a href="#cb102-2" aria-hidden="true" tabindex="-1"></a><span class="co"># уберем из списка пустые значения</span></span>
<span id="cb102-3"><a href="#cb102-3" aria-hidden="true" tabindex="-1"></a>wheel_drive_list <span class="op">=</span> (</span>
<span id="cb102-4"><a href="#cb102-4" aria-hidden="true" tabindex="-1"></a>    df[<span class="op">~</span>(df[<span class="st">&#39;тип_привода&#39;</span>].isna()) <span class="op">&amp;</span></span>
<span id="cb102-5"><a href="#cb102-5" aria-hidden="true" tabindex="-1"></a>     (df[<span class="st">&#39;тип_привода&#39;</span>] <span class="op">!=</span> <span class="st">&#39;#н/д&#39;</span>)][<span class="st">&#39;тип_привода&#39;</span>].unique()</span>
<span id="cb102-6"><a href="#cb102-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb102-7"><a href="#cb102-7" aria-hidden="true" tabindex="-1"></a>wheel_drive_list</span></code></pre></div>
<div class="output execute_result" data-execution_count="550">
<pre><code>array([&#39;передний&#39;, &#39;fwd&#39;, &#39;quattro&#39;, &#39;задний&#39;, &#39;полный&#39;, &#39;awd&#39;, &#39;4wd&#39;,
       &#39;4х2.2&#39;, &#39;rwd&#39;, &#39;2 wd&#39;, &#39;2wd&#39;, &#39;4 wd&#39;, &#39;4x2&#39;, &#39;передний (ff)&#39;, &#39;0&#39;,
       &#39;ff&#39;, &#39;4motion&#39;, &#39;астана&#39;, &#39;4x4&#39;, &#39;4х4&#39;, &#39;4х2&#39;], dtype=object)</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="551" id="eTLzz7F9vjP0">
<div class="sourceCode" id="cb104"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb104-1"><a href="#cb104-1" aria-hidden="true" tabindex="-1"></a><span class="co"># создадим функцию создания списка</span></span>
<span id="cb104-2"><a href="#cb104-2" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> new_dict(pattern, col, new_value):</span>
<span id="cb104-3"><a href="#cb104-3" aria-hidden="true" tabindex="-1"></a>  <span class="co">&#39;&#39;&#39;</span></span>
<span id="cb104-4"><a href="#cb104-4" aria-hidden="true" tabindex="-1"></a><span class="co">  Данная функцию принимает на вход регулрярное выражение,</span></span>
<span id="cb104-5"><a href="#cb104-5" aria-hidden="true" tabindex="-1"></a><span class="co">  колонку для поиска и значение</span></span>
<span id="cb104-6"><a href="#cb104-6" aria-hidden="true" tabindex="-1"></a><span class="co">  Сначала задается регулярное выражение pattern,</span></span>
<span id="cb104-7"><a href="#cb104-7" aria-hidden="true" tabindex="-1"></a><span class="co">  затем происходит поиск совпадений в уникальных значениях col</span></span>
<span id="cb104-8"><a href="#cb104-8" aria-hidden="true" tabindex="-1"></a><span class="co">  После создается словарь с ключами уникальных значений col</span></span>
<span id="cb104-9"><a href="#cb104-9" aria-hidden="true" tabindex="-1"></a><span class="co">  и значением new_value для каждого</span></span>
<span id="cb104-10"><a href="#cb104-10" aria-hidden="true" tabindex="-1"></a><span class="co">  На выходе получается словарь</span></span>
<span id="cb104-11"><a href="#cb104-11" aria-hidden="true" tabindex="-1"></a><span class="co">  &#39;&#39;&#39;</span></span>
<span id="cb104-12"><a href="#cb104-12" aria-hidden="true" tabindex="-1"></a>  <span class="co"># создадим регулярное выражение</span></span>
<span id="cb104-13"><a href="#cb104-13" aria-hidden="true" tabindex="-1"></a>  <span class="co"># регистр игнорируем</span></span>
<span id="cb104-14"><a href="#cb104-14" aria-hidden="true" tabindex="-1"></a>  rexp <span class="op">=</span> re.<span class="bu">compile</span>(pattern, flags<span class="op">=</span>re.IGNORECASE)</span>
<span id="cb104-15"><a href="#cb104-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb104-16"><a href="#cb104-16" aria-hidden="true" tabindex="-1"></a>  <span class="co"># найдем только те значения, которые являются строками</span></span>
<span id="cb104-17"><a href="#cb104-17" aria-hidden="true" tabindex="-1"></a>  <span class="co"># и соответствуют регулярному выражению</span></span>
<span id="cb104-18"><a href="#cb104-18" aria-hidden="true" tabindex="-1"></a>  result_list <span class="op">=</span> [value <span class="cf">for</span> value <span class="kw">in</span> df[col].unique() <span class="op">\</span></span>
<span id="cb104-19"><a href="#cb104-19" aria-hidden="true" tabindex="-1"></a>                 <span class="cf">if</span> <span class="bu">isinstance</span>(value, <span class="bu">str</span>) <span class="kw">and</span> rexp.match(value)]</span>
<span id="cb104-20"><a href="#cb104-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb104-21"><a href="#cb104-21" aria-hidden="true" tabindex="-1"></a>  <span class="co"># создадим словарь соответствия уникальных значений col значению new_value</span></span>
<span id="cb104-22"><a href="#cb104-22" aria-hidden="true" tabindex="-1"></a>  dictionary <span class="op">=</span> <span class="bu">dict</span>(<span class="bu">zip</span>(result_list, [new_value] <span class="op">*</span> <span class="bu">len</span>(result_list)))</span>
<span id="cb104-23"><a href="#cb104-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb104-24"><a href="#cb104-24" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> dictionary</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="552" id="CePoBzUCtR3r">
<div class="sourceCode" id="cb105"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a><span class="co"># создадим словари для трех типов приводов</span></span>
<span id="cb105-2"><a href="#cb105-2" aria-hidden="true" tabindex="-1"></a>rwd_dict <span class="op">=</span> new_dict(<span class="vs">r&#39;.*зад.*|.*rwd.*&#39;</span>, <span class="st">&#39;тип_привода&#39;</span>, <span class="st">&#39;RWD&#39;</span>)</span>
<span id="cb105-3"><a href="#cb105-3" aria-hidden="true" tabindex="-1"></a>fwd_dict <span class="op">=</span> new_dict(<span class="vs">r&#39;.*пер.*|.*f.*&#39;</span>, <span class="st">&#39;тип_привода&#39;</span>, <span class="st">&#39;FWD&#39;</span>)</span>
<span id="cb105-4"><a href="#cb105-4" aria-hidden="true" tabindex="-1"></a>fourwd_dict <span class="op">=</span> new_dict(<span class="vs">r&#39;.*пол.*|.*4.[^2]|.*awd.*|.*quat.*&#39;</span>,</span>
<span id="cb105-5"><a href="#cb105-5" aria-hidden="true" tabindex="-1"></a>                       <span class="st">&#39;тип_привода&#39;</span>, <span class="st">&#39;4WD&#39;</span>)</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="553" id="ucZOE33c38uO">
<div class="sourceCode" id="cb106"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb106-1"><a href="#cb106-1" aria-hidden="true" tabindex="-1"></a><span class="co"># объединим словари в один</span></span>
<span id="cb106-2"><a href="#cb106-2" aria-hidden="true" tabindex="-1"></a>rwd_dict.update(fwd_dict)</span>
<span id="cb106-3"><a href="#cb106-3" aria-hidden="true" tabindex="-1"></a>rwd_dict.update(fourwd_dict)</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="554" id="-ZIYAph64FUk">
<div class="sourceCode" id="cb107"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true" tabindex="-1"></a><span class="co"># выделим ключи словаря</span></span>
<span id="cb107-2"><a href="#cb107-2" aria-hidden="true" tabindex="-1"></a>keys_list <span class="op">=</span> <span class="bu">list</span>(rwd_dict.keys())</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="555"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="_G4foLqB0jex" data-outputId="ef95f555-4682-470c-b707-50aa480025ba">
<div class="sourceCode" id="cb108"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb108-1"><a href="#cb108-1" aria-hidden="true" tabindex="-1"></a><span class="co"># в 2wd вставим значения, которые не попали в словарь</span></span>
<span id="cb108-2"><a href="#cb108-2" aria-hidden="true" tabindex="-1"></a>twowd_list <span class="op">=</span> <span class="bu">list</span>(<span class="bu">filter</span>(<span class="kw">lambda</span> x: x <span class="kw">not</span> <span class="kw">in</span> keys_list, wheel_drive_list))</span>
<span id="cb108-3"><a href="#cb108-3" aria-hidden="true" tabindex="-1"></a>twowd_dict <span class="op">=</span> <span class="bu">dict</span>(<span class="bu">zip</span>(twowd_list, [<span class="st">&#39;2WD&#39;</span>] <span class="op">*</span> <span class="bu">len</span>(twowd_list)))</span>
<span id="cb108-4"><a href="#cb108-4" aria-hidden="true" tabindex="-1"></a>twowd_dict</span></code></pre></div>
<div class="output execute_result" data-execution_count="555">
<pre><code>{&#39;4х2.2&#39;: &#39;2WD&#39;,
 &#39;2 wd&#39;: &#39;2WD&#39;,
 &#39;2wd&#39;: &#39;2WD&#39;,
 &#39;4x2&#39;: &#39;2WD&#39;,
 &#39;0&#39;: &#39;2WD&#39;,
 &#39;астана&#39;: &#39;2WD&#39;,
 &#39;4х2&#39;: &#39;2WD&#39;}</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="556" id="Xm2NHhlk0OTT">
<div class="sourceCode" id="cb110"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb110-1"><a href="#cb110-1" aria-hidden="true" tabindex="-1"></a><span class="co"># добавим в общий словарь</span></span>
<span id="cb110-2"><a href="#cb110-2" aria-hidden="true" tabindex="-1"></a>rwd_dict.update(twowd_dict)</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="557"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="dfVqp0-b5YUx" data-outputId="e02e2d3a-a6ed-4144-8ee4-f12d98926ea4">
<div class="sourceCode" id="cb111"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb111-1"><a href="#cb111-1" aria-hidden="true" tabindex="-1"></a>rwd_dict</span></code></pre></div>
<div class="output execute_result" data-execution_count="557">
<pre><code>{&#39;задний&#39;: &#39;RWD&#39;,
 &#39;rwd&#39;: &#39;RWD&#39;,
 &#39;передний&#39;: &#39;FWD&#39;,
 &#39;fwd&#39;: &#39;FWD&#39;,
 &#39;передний (ff)&#39;: &#39;FWD&#39;,
 &#39;ff&#39;: &#39;FWD&#39;,
 &#39;quattro&#39;: &#39;4WD&#39;,
 &#39;полный&#39;: &#39;4WD&#39;,
 &#39;awd&#39;: &#39;4WD&#39;,
 &#39;4wd&#39;: &#39;4WD&#39;,
 &#39;4 wd&#39;: &#39;4WD&#39;,
 &#39;4motion&#39;: &#39;4WD&#39;,
 &#39;4x4&#39;: &#39;4WD&#39;,
 &#39;4х4&#39;: &#39;4WD&#39;,
 &#39;4х2.2&#39;: &#39;2WD&#39;,
 &#39;2 wd&#39;: &#39;2WD&#39;,
 &#39;2wd&#39;: &#39;2WD&#39;,
 &#39;4x2&#39;: &#39;2WD&#39;,
 &#39;0&#39;: &#39;2WD&#39;,
 &#39;астана&#39;: &#39;2WD&#39;,
 &#39;4х2&#39;: &#39;2WD&#39;}</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="558" id="zk8DwKip5fAQ">
<div class="sourceCode" id="cb113"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb113-1"><a href="#cb113-1" aria-hidden="true" tabindex="-1"></a><span class="co"># заменим названия типа привода в соответствии с общим словарем</span></span>
<span id="cb113-2"><a href="#cb113-2" aria-hidden="true" tabindex="-1"></a>df[<span class="st">&#39;тип_привода&#39;</span>] <span class="op">=</span> df[<span class="st">&#39;тип_привода&#39;</span>].<span class="bu">map</span>(rwd_dict)</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="559"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="UtWWMe1B5lgc" data-outputId="771ba0c2-7bdf-4433-816f-0bbb423e2064">
<div class="sourceCode" id="cb114"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb114-1"><a href="#cb114-1" aria-hidden="true" tabindex="-1"></a>df[<span class="st">&#39;тип_привода&#39;</span>].unique()</span></code></pre></div>
<div class="output execute_result" data-execution_count="559">
<pre><code>array([&#39;FWD&#39;, &#39;4WD&#39;, &#39;RWD&#39;, &#39;2WD&#39;, nan], dtype=object)</code></pre>
</div>
</div>
<div class="cell markdown" id="kzyQZZAW5lnL">
<p>Осталось заполнить пропуски.</p>
</div>
<div class="cell code" data-execution_count="560"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:36}"
id="LaQqL46Z6eDF" data-outputId="70ef4ccd-5e7b-4bd4-eda0-98668ecbab83">
<div class="sourceCode" id="cb116"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb116-1"><a href="#cb116-1" aria-hidden="true" tabindex="-1"></a><span class="ss">f&#39;Количество пропусков </span><span class="sc">{</span>df[<span class="st">&quot;тип_привода&quot;</span>]<span class="sc">.</span>isna()<span class="sc">.</span><span class="bu">sum</span>()<span class="sc">}</span><span class="ss">&#39;</span></span></code></pre></div>
<div class="output execute_result" data-execution_count="560">
<div class="sourceCode" id="cb117"><pre
class="sourceCode json"><code class="sourceCode json"><span id="cb117-1"><a href="#cb117-1" aria-hidden="true" tabindex="-1"></a><span class="fu">{</span><span class="dt">&quot;type&quot;</span><span class="fu">:</span><span class="st">&quot;string&quot;</span><span class="fu">}</span></span></code></pre></div>
</div>
</div>
<div class="cell code" data-execution_count="561" id="SKoqfqbV6hH_">
<div class="sourceCode" id="cb118"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb118-1"><a href="#cb118-1" aria-hidden="true" tabindex="-1"></a><span class="co"># применим функцию для заполнения пропусков медианой</span></span>
<span id="cb118-2"><a href="#cb118-2" aria-hidden="true" tabindex="-1"></a>df, df1 <span class="op">=</span> processing_nans(df, <span class="st">&#39;тип_привода&#39;</span>, <span class="st">&#39;авто&#39;</span>, <span class="st">&#39;бренд&#39;</span>)</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="562"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="gt5vplY7DvOu" data-outputId="e0bd5cab-88ca-4cc8-968a-951e84e9e4e3">
<div class="sourceCode" id="cb119"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb119-1"><a href="#cb119-1" aria-hidden="true" tabindex="-1"></a><span class="co"># выыведем список авто без типа привода</span></span>
<span id="cb119-2"><a href="#cb119-2" aria-hidden="true" tabindex="-1"></a>auto_list <span class="op">=</span> <span class="bu">list</span>(df1[<span class="st">&#39;авто&#39;</span>].value_counts().to_frame().reset_index()[<span class="st">&#39;index&#39;</span>])</span>
<span id="cb119-3"><a href="#cb119-3" aria-hidden="true" tabindex="-1"></a>auto_list</span></code></pre></div>
<div class="output execute_result" data-execution_count="562">
<pre><code>[&#39;mazda cx-5&#39;,
 &#39;shacman sx3258dr384&#39;,
 &#39;mazda 6&#39;,
 &#39;mazda cx-9&#39;,
 &#39;foton bj1069vdjea-f1&#39;,
 &#39;man tg&#39;,
 &#39;dong feng bwc6665ga5&#39;,
 &#39;foton bj3253dmpkb-ad&#39;,
 &#39;scania r-series&#39;,
 &#39;урал 4320&#39;,
 &#39;mazda 3&#39;,
 &#39;scania p-series&#39;,
 &#39;scania s-series&#39;,
 &#39;урал 5557&#39;,
 &#39;nefaz 5299&#39;,
 &#39;урал 4320-1951-60&#39;,
 &#39;урал 4320-1951-40&#39;,
 &#39;scania g-series&#39;,
 &#39;урал 32551&#39;]</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="563" id="MjP4ruwaBSr9">
<div class="sourceCode" id="cb121"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb121-1"><a href="#cb121-1" aria-hidden="true" tabindex="-1"></a><span class="co"># используя интернет найдем информацию о типах привода</span></span>
<span id="cb121-2"><a href="#cb121-2" aria-hidden="true" tabindex="-1"></a>wheel_drives <span class="op">=</span> [<span class="st">&#39;4WD&#39;</span>, <span class="st">&#39;RWD&#39;</span>, <span class="st">&#39;FWD&#39;</span>, <span class="st">&#39;4WD&#39;</span>, <span class="st">&#39;RWD&#39;</span>, <span class="st">&#39;RWD&#39;</span>, <span class="st">&#39;4WD&#39;</span>, <span class="st">&#39;RWD&#39;</span>, <span class="st">&#39;4WD&#39;</span>,</span>
<span id="cb121-3"><a href="#cb121-3" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;4WD&#39;</span>, <span class="st">&#39;FWD&#39;</span>, <span class="st">&#39;4WD&#39;</span>, <span class="st">&#39;2WD&#39;</span>, <span class="st">&#39;4WD&#39;</span>, <span class="st">&#39;RWD&#39;</span>, <span class="st">&#39;4WD&#39;</span>, <span class="st">&#39;4WD&#39;</span>, <span class="st">&#39;4WD&#39;</span>,</span>
<span id="cb121-4"><a href="#cb121-4" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;4WD&#39;</span>]</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="564" id="uUfis5pxDMIL">
<div class="sourceCode" id="cb122"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb122-1"><a href="#cb122-1" aria-hidden="true" tabindex="-1"></a><span class="co"># применим функцию для заполнения оставшихся пропусков</span></span>
<span id="cb122-2"><a href="#cb122-2" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> processing_last_nans(df, df1, <span class="st">&#39;тип_привода&#39;</span>, <span class="st">&#39;авто&#39;</span>,</span>
<span id="cb122-3"><a href="#cb122-3" aria-hidden="true" tabindex="-1"></a>                          auto_list, wheel_drives)</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="565"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="xrnw5dApDa8P" data-outputId="2436106d-cf14-4cf7-9b2e-fa543e6d18d5">
<div class="sourceCode" id="cb123"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb123-1"><a href="#cb123-1" aria-hidden="true" tabindex="-1"></a><span class="co"># выведем инфо о столбце</span></span>
<span id="cb123-2"><a href="#cb123-2" aria-hidden="true" tabindex="-1"></a>info(df, <span class="st">&#39;тип_привода&#39;</span>)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>&lt;class &#39;pandas.core.series.Series&#39;&gt;
Int64Index: 39960 entries, 0 to 39552
Series name: тип_привода
Non-Null Count  Dtype 
--------------  ----- 
39960 non-null  object
dtypes: object(1)
memory usage: 624.4+ KB
None 

[&#39;FWD&#39; &#39;4WD&#39; &#39;RWD&#39; &#39;2WD&#39;]
</code></pre>
</div>
</div>
<div class="cell markdown" id="XGCQWjkBEIX9">
<p>Пропуски заполнены, значения приведены к правильным.</p>
</div>
<section id="325-столбец-год_выпуска" class="cell markdown"
id="HnUcFub8Elqq">
<h3>3.2.5 Столбец 'год_выпуска'</h3>
</section>
<div class="cell code" data-execution_count="566"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="I2uYZa3Dhua7" data-outputId="f71c321d-1ecd-4942-a6c4-bafa95e61293">
<div class="sourceCode" id="cb125"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb125-1"><a href="#cb125-1" aria-hidden="true" tabindex="-1"></a><span class="co"># выведем инфо о столбце</span></span>
<span id="cb125-2"><a href="#cb125-2" aria-hidden="true" tabindex="-1"></a>info(df, <span class="st">&#39;год_выпуска&#39;</span>)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>&lt;class &#39;pandas.core.series.Series&#39;&gt;
Int64Index: 39960 entries, 0 to 39552
Series name: год_выпуска
Non-Null Count  Dtype 
--------------  ----- 
39459 non-null  object
dtypes: object(1)
memory usage: 624.4+ KB
None 

[&#39;2018&#39; &#39;2017&#39; &#39;2019&#39; nan &#39;2016&#39; &#39;2014&#39; &#39;2013&#39; &#39;2\xa0018&#39; &#39;2\xa0019&#39;
 &#39;2011&#39;]
</code></pre>
</div>
</div>
<div class="cell markdown" id="x9cFvXeGei0r">
<p>В столбце помимо пустых значений есть скрытые пробелы \xa0 –
достаточно частое явление при конвертации данных из excel таблиц.</p>
</div>
<div class="cell code" data-execution_count="567" id="AC_CoELvei7H">
<div class="sourceCode" id="cb127"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb127-1"><a href="#cb127-1" aria-hidden="true" tabindex="-1"></a><span class="co"># заменим некорректные написания годов</span></span>
<span id="cb127-2"><a href="#cb127-2" aria-hidden="true" tabindex="-1"></a>df[<span class="st">&#39;год_выпуска&#39;</span>] <span class="op">=</span> df[<span class="st">&#39;год_выпуска&#39;</span>].<span class="bu">str</span>.replace(<span class="st">&#39;</span><span class="ch">\xa0</span><span class="st">&#39;</span>, <span class="st">&#39;&#39;</span>)</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="568"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="y8wf5CdhKQtq" data-outputId="fe5b4383-b512-4b74-c4ec-ebfd03652eae">
<div class="sourceCode" id="cb128"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb128-1"><a href="#cb128-1" aria-hidden="true" tabindex="-1"></a>df[<span class="st">&#39;год_выпуска&#39;</span>].unique()</span></code></pre></div>
<div class="output execute_result" data-execution_count="568">
<pre><code>array([&#39;2018&#39;, &#39;2017&#39;, &#39;2019&#39;, nan, &#39;2016&#39;, &#39;2014&#39;, &#39;2013&#39;, &#39;2011&#39;],
      dtype=object)</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="569"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:36}"
id="oxwKS4m1ejhy" data-outputId="12bc352d-9599-44b1-8b97-d2ef4afc66bd">
<div class="sourceCode" id="cb130"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb130-1"><a href="#cb130-1" aria-hidden="true" tabindex="-1"></a><span class="ss">f&#39;Количество пропусков </span><span class="sc">{</span>df[<span class="st">&quot;год_выпуска&quot;</span>]<span class="sc">.</span>isna()<span class="sc">.</span><span class="bu">sum</span>()<span class="sc">}</span><span class="ss">&#39;</span></span></code></pre></div>
<div class="output execute_result" data-execution_count="569">
<div class="sourceCode" id="cb131"><pre
class="sourceCode json"><code class="sourceCode json"><span id="cb131-1"><a href="#cb131-1" aria-hidden="true" tabindex="-1"></a><span class="fu">{</span><span class="dt">&quot;type&quot;</span><span class="fu">:</span><span class="st">&quot;string&quot;</span><span class="fu">}</span></span></code></pre></div>
</div>
</div>
<div class="cell markdown" id="SHvA-6DnzTK6">
<p>Пропуски в столбце годов выпуска заполним заглушкой.</p>
</div>
<div class="cell code" data-execution_count="570" id="ShmJiQyH0BsL">
<div class="sourceCode" id="cb132"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb132-1"><a href="#cb132-1" aria-hidden="true" tabindex="-1"></a>df[<span class="st">&#39;год_выпуска&#39;</span>] <span class="op">=</span> df[<span class="st">&#39;год_выпуска&#39;</span>].fillna(<span class="st">&#39;неизвестно&#39;</span>)</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="571"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="KCIsl_CD0R5N" data-outputId="cb49b39a-d850-4f8b-f01b-86102bf5bc3e">
<div class="sourceCode" id="cb133"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb133-1"><a href="#cb133-1" aria-hidden="true" tabindex="-1"></a><span class="co"># выведем инфо о столбце</span></span>
<span id="cb133-2"><a href="#cb133-2" aria-hidden="true" tabindex="-1"></a>info(df, <span class="st">&#39;год_выпуска&#39;</span>)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>&lt;class &#39;pandas.core.series.Series&#39;&gt;
Int64Index: 39960 entries, 0 to 39552
Series name: год_выпуска
Non-Null Count  Dtype 
--------------  ----- 
39960 non-null  object
dtypes: object(1)
memory usage: 624.4+ KB
None 

[&#39;2018&#39; &#39;2017&#39; &#39;2019&#39; &#39;неизвестно&#39; &#39;2016&#39; &#39;2014&#39; &#39;2013&#39; &#39;2011&#39;]
</code></pre>
</div>
</div>
<div class="cell markdown" id="QfHLtp_M_UkG">
<p>Пропуски заполнены, значения приведены к правильным.</p>
</div>
<section id="326-столбец-тип_клиента" class="cell markdown"
id="eeEEcY_I0YMV">
<h3>3.2.6 Столбец 'тип_клиента'</h3>
</section>
<div class="cell code" data-execution_count="572"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="ywHco5wj0YEz" data-outputId="6ea56f29-adaa-4a26-9294-f42ce9720fc9">
<div class="sourceCode" id="cb135"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb135-1"><a href="#cb135-1" aria-hidden="true" tabindex="-1"></a>info(df, <span class="st">&#39;тип_клиента&#39;</span>)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>&lt;class &#39;pandas.core.series.Series&#39;&gt;
Int64Index: 39960 entries, 0 to 39552
Series name: тип_клиента
Non-Null Count  Dtype 
--------------  ----- 
32919 non-null  object
dtypes: object(1)
memory usage: 624.4+ KB
None 

[&#39;Физ. Лицо&#39; &#39;Юр. Лицо&#39; nan &#39;Юр.Лицо&#39; &#39;физ.лицо&#39; &#39;юридическое&#39;
 &#39;физическое&#39; &#39;ФизЛицо&#39; &#39;ЮрЛицо&#39; &#39;Корп. клиент&#39;]
</code></pre>
</div>
</div>
<div class="cell markdown" id="EXsX6JIj0X8U">
<p>В результате должны быть 2 уникальных значения: юрлицо или физлицо. В
столбце присутствуют неявные дубликаты, которые нужно заменить. Также
есть пропуски. Заполнять пропуски следует по следующему принципу</p>
<ul>
<li>если количество купленных авто 1-2 и транспорт некоммерческий - физ
лицо</li>
<li>если куплено более 2 машин, транспорт коммерческий. - юр лицо
(корпоративный клиент). Продажи в 100 единиц - норма (такси).</li>
</ul>
<p>Тип транспорта можно узнать в колонке 'сегментация_2013'.</p>
</div>
<div class="cell markdown" id="gclHuQum0Xz5">
<p>Для начала заменим неявные дубликаты.</p>
</div>
<div class="cell code" data-execution_count="573" id="8O-ymy152tva">
<div class="sourceCode" id="cb137"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb137-1"><a href="#cb137-1" aria-hidden="true" tabindex="-1"></a><span class="co"># создадим словари для 2 типов клиентов</span></span>
<span id="cb137-2"><a href="#cb137-2" aria-hidden="true" tabindex="-1"></a>f_dict <span class="op">=</span> new_dict(<span class="vs">r&#39;.*ф.*|.*rwd.*&#39;</span>, <span class="st">&#39;тип_клиента&#39;</span>, <span class="st">&#39;физлицо&#39;</span>)</span>
<span id="cb137-3"><a href="#cb137-3" aria-hidden="true" tabindex="-1"></a>u_dict <span class="op">=</span> new_dict(<span class="vs">r&#39;.*ю.*|.*кор.*&#39;</span>, <span class="st">&#39;тип_клиента&#39;</span>, <span class="st">&#39;юрлицо&#39;</span>)</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="574" id="kF7Kbct_2tnm">
<div class="sourceCode" id="cb138"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb138-1"><a href="#cb138-1" aria-hidden="true" tabindex="-1"></a><span class="co"># объединим словари</span></span>
<span id="cb138-2"><a href="#cb138-2" aria-hidden="true" tabindex="-1"></a>f_dict.update(u_dict)</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="575"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="0IwY15En_f3K" data-outputId="36c37190-477d-4774-9338-a9184a774aa5">
<div class="sourceCode" id="cb139"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb139-1"><a href="#cb139-1" aria-hidden="true" tabindex="-1"></a>f_dict</span></code></pre></div>
<div class="output execute_result" data-execution_count="575">
<pre><code>{&#39;Физ. Лицо&#39;: &#39;физлицо&#39;,
 &#39;физ.лицо&#39;: &#39;физлицо&#39;,
 &#39;физическое&#39;: &#39;физлицо&#39;,
 &#39;ФизЛицо&#39;: &#39;физлицо&#39;,
 &#39;Юр. Лицо&#39;: &#39;юрлицо&#39;,
 &#39;Юр.Лицо&#39;: &#39;юрлицо&#39;,
 &#39;юридическое&#39;: &#39;юрлицо&#39;,
 &#39;ЮрЛицо&#39;: &#39;юрлицо&#39;,
 &#39;Корп. клиент&#39;: &#39;юрлицо&#39;}</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="576" id="SeMIXEg32tdd">
<div class="sourceCode" id="cb141"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb141-1"><a href="#cb141-1" aria-hidden="true" tabindex="-1"></a><span class="co"># заменим название типа клиента в соответствии со словарем</span></span>
<span id="cb141-2"><a href="#cb141-2" aria-hidden="true" tabindex="-1"></a>df[<span class="st">&#39;тип_клиента&#39;</span>] <span class="op">=</span> df[<span class="st">&#39;тип_клиента&#39;</span>].<span class="bu">map</span>(f_dict)</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="577"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="UtV7rnvt2tVB" data-outputId="b4218976-47be-48c5-a7f6-f3aba06f7f76">
<div class="sourceCode" id="cb142"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb142-1"><a href="#cb142-1" aria-hidden="true" tabindex="-1"></a>df[<span class="st">&#39;тип_клиента&#39;</span>].unique()</span></code></pre></div>
<div class="output execute_result" data-execution_count="577">
<pre><code>array([&#39;физлицо&#39;, &#39;юрлицо&#39;, nan], dtype=object)</code></pre>
</div>
</div>
<div class="cell markdown" id="n9rPfzGB4Z-9">
<p>Заполним пропуски в соответствии с условиями определения юрлица и
физлица.</p>
</div>
<div class="cell code" data-execution_count="578"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:36}"
id="wXJR7iUC5RHM" data-outputId="430d9ddf-f64a-420a-bb1a-0dd0f19b3593">
<div class="sourceCode" id="cb144"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb144-1"><a href="#cb144-1" aria-hidden="true" tabindex="-1"></a><span class="ss">f&#39;Количество пропусков </span><span class="sc">{</span>df[<span class="st">&quot;тип_клиента&quot;</span>]<span class="sc">.</span>isna()<span class="sc">.</span><span class="bu">sum</span>()<span class="sc">}</span><span class="ss">&#39;</span></span></code></pre></div>
<div class="output execute_result" data-execution_count="578">
<div class="sourceCode" id="cb145"><pre
class="sourceCode json"><code class="sourceCode json"><span id="cb145-1"><a href="#cb145-1" aria-hidden="true" tabindex="-1"></a><span class="fu">{</span><span class="dt">&quot;type&quot;</span><span class="fu">:</span><span class="st">&quot;string&quot;</span><span class="fu">}</span></span></code></pre></div>
</div>
</div>
<div class="cell code" data-execution_count="579" id="5SCftrCR7lb0">
<div class="sourceCode" id="cb146"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb146-1"><a href="#cb146-1" aria-hidden="true" tabindex="-1"></a><span class="co"># заполним пропуски</span></span>
<span id="cb146-2"><a href="#cb146-2" aria-hidden="true" tabindex="-1"></a>df.loc[df.query(<span class="st">&#39;тип_клиента.isna() </span><span class="ch">\</span></span>
<span id="cb146-3"><a href="#cb146-3" aria-hidden="true" tabindex="-1"></a><span class="st">and количество &lt;=2 and сегментация_2013 != &quot;Коммерческие автомобили&quot;&#39;</span>).index,</span>
<span id="cb146-4"><a href="#cb146-4" aria-hidden="true" tabindex="-1"></a>       <span class="st">&#39;тип_клиента&#39;</span>] <span class="op">=</span> <span class="st">&#39;физлицо&#39;</span></span>
<span id="cb146-5"><a href="#cb146-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-6"><a href="#cb146-6" aria-hidden="true" tabindex="-1"></a>df.loc[df.query(<span class="st">&#39;тип_клиента.isna() </span><span class="ch">\</span></span>
<span id="cb146-7"><a href="#cb146-7" aria-hidden="true" tabindex="-1"></a><span class="st">and количество &gt; 2 or сегментация_2013 == &quot;Коммерческие автомобили&quot;&#39;</span>).index,</span>
<span id="cb146-8"><a href="#cb146-8" aria-hidden="true" tabindex="-1"></a>       <span class="st">&#39;тип_клиента&#39;</span>] <span class="op">=</span> <span class="st">&#39;юрлицо&#39;</span></span></code></pre></div>
</div>
<div class="cell code" data-execution_count="580"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="d4zREi6h7oyK" data-outputId="b59894b8-a1a7-4fb2-ee36-fd4232dd5e01">
<div class="sourceCode" id="cb147"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb147-1"><a href="#cb147-1" aria-hidden="true" tabindex="-1"></a><span class="co"># выведем инфо о столбце</span></span>
<span id="cb147-2"><a href="#cb147-2" aria-hidden="true" tabindex="-1"></a>info(df, <span class="st">&#39;тип_клиента&#39;</span>)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>&lt;class &#39;pandas.core.series.Series&#39;&gt;
Int64Index: 39960 entries, 0 to 39552
Series name: тип_клиента
Non-Null Count  Dtype 
--------------  ----- 
39960 non-null  object
dtypes: object(1)
memory usage: 1.6+ MB
None 

[&#39;физлицо&#39; &#39;юрлицо&#39;]
</code></pre>
</div>
</div>
<div class="cell markdown" id="no1cL2xq4vHA">
<p>Пропуски заполнены, значения приведены к правильным.</p>
</div>
<section id="33-обработка-неявных-дубликатов" class="cell markdown"
id="F4YQm1VnADlF">
<h2>3.3 Обработка неявных дубликатов</h2>
</section>
<div class="cell markdown" id="jm5NIzl5AIB8">
<p>Данные являются деперсонализированными. Соответственно каждая запись
относится к уникальному клиенту, id которого в исходный датафрейм не
включен. Но в некоторых столбцах могут встречаться неявные дубликаты.
Рассмотрим столбцы типа 'object' на наличие таких дубликатов:</p>
<ul>
<li>компания</li>
<li>бренд</li>
<li>страна-производитель</li>
<li>регион</li>
<li>наименование_дилерского_центра (можно удалить, так как совпадает с
компанией)</li>
<li>область</li>
<li>сегментация_2013</li>
<li>класс_2013</li>
<li>локализация_производства.</li>
</ul>
<p>В столбце 'регион' указаны города. Удобнее для анализа будет
рассматривать области и отдельно города Алматы и Нурсултан, так как они
крупные и, следовательно, продаж там будет бульше, чем в других
отдельных городах.</p>
</div>
<div class="cell code" data-execution_count="581" id="A83CmEaWQq83">
<div class="sourceCode" id="cb149"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb149-1"><a href="#cb149-1" aria-hidden="true" tabindex="-1"></a><span class="co"># удалим столбец</span></span>
<span id="cb149-2"><a href="#cb149-2" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> df.drop(columns<span class="op">=</span><span class="st">&#39;наименование_дилерского_центра&#39;</span>)</span></code></pre></div>
</div>
<section id="331-столбец-компания" class="cell markdown"
id="fusjuwcMBGIk">
<h3>3.3.1 Столбец 'компания'</h3>
</section>
<div class="cell code" data-execution_count="582" id="je-UUV1HBexN">
<div class="sourceCode" id="cb150"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb150-1"><a href="#cb150-1" aria-hidden="true" tabindex="-1"></a><span class="co"># создадим функцию для обработки столбцов</span></span>
<span id="cb150-2"><a href="#cb150-2" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> processing_col(col):</span>
<span id="cb150-3"><a href="#cb150-3" aria-hidden="true" tabindex="-1"></a>  <span class="co">&#39;&#39;&#39;</span></span>
<span id="cb150-4"><a href="#cb150-4" aria-hidden="true" tabindex="-1"></a><span class="co">  На вход функция получает колонку</span></span>
<span id="cb150-5"><a href="#cb150-5" aria-hidden="true" tabindex="-1"></a><span class="co">  Функция переводит колонку в нижний регистр и удаляет лишние пробелы</span></span>
<span id="cb150-6"><a href="#cb150-6" aria-hidden="true" tabindex="-1"></a><span class="co">  На выходе функция выводит уникальные значения столбца в алфавитном порядке</span></span>
<span id="cb150-7"><a href="#cb150-7" aria-hidden="true" tabindex="-1"></a><span class="co">  &#39;&#39;&#39;</span></span>
<span id="cb150-8"><a href="#cb150-8" aria-hidden="true" tabindex="-1"></a>  <span class="co"># приведем колонку к нижнему регистру</span></span>
<span id="cb150-9"><a href="#cb150-9" aria-hidden="true" tabindex="-1"></a>  df[col] <span class="op">=</span> df[col].<span class="bu">str</span>.lower()</span>
<span id="cb150-10"><a href="#cb150-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb150-11"><a href="#cb150-11" aria-hidden="true" tabindex="-1"></a>  <span class="co"># удалим лишние пробелы</span></span>
<span id="cb150-12"><a href="#cb150-12" aria-hidden="true" tabindex="-1"></a>  df[col] <span class="op">=</span> df[col].<span class="bu">str</span>.strip()</span>
<span id="cb150-13"><a href="#cb150-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb150-14"><a href="#cb150-14" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> pd.Series(df[col].unique()).sort_values()</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="583"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="R6ApIzcyCDdE" data-outputId="93be48a7-4fde-4a1f-c7e6-ee0990501cd3">
<div class="sourceCode" id="cb151"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb151-1"><a href="#cb151-1" aria-hidden="true" tabindex="-1"></a><span class="co"># применим функцию</span></span>
<span id="cb151-2"><a href="#cb151-2" aria-hidden="true" tabindex="-1"></a>processing_col(<span class="st">&#39;компания&#39;</span>)</span></code></pre></div>
<div class="output execute_result" data-execution_count="583">
<pre><code>11                      allur auto
12           almaty motors premium
8                    astana motors
16                     autokapital
6                   caspian motors
5            daewoo bus kazakhstan
4            eurasia motor premium
32                     hino motors
9     hyundai com trans kazakhstan
35      man truck &amp; bus kazakhstan
0                      mercur auto
20                    mercur autos
19                         mmc rus
10        nissan manufacturing rus
23          ravon motors kazakstan
24                  renault россия
30             scandinavian motors
36             scania central asia
25               subaru kazakhstan
13                    terra motors
14         toyota motor kazakhstan
26            volkswagen group rus
27              автодом motors kst
17                     автокапитал
38                      автомир гк
28                   автомир-центр
1                автоцентр-бавария
2                       бипэк авто
3                            вираж
7                   каспиан моторс
15                лифан моторс рус
18                         ммс рус
22          равон моторс казахстан
34                       свс-транс
37                           семаз
33                        тк камаз
29       тоо &quot;eurasia motor zhaik&quot;
21                узавто-казахстан
31           хино моторс казахстан
dtype: object</code></pre>
</div>
</div>
<div class="cell markdown" id="yAYIH0eeC36M">
<p>Видны следующие неявные дубликаты:</p>
<ul>
<li>mercur auto - mercur autos</li>
<li>автомир гк - автомир-центр</li>
<li>caspian motors - каспиан моторс</li>
<li>mmc rus - ммс рус</li>
<li>ravon motors kazakstan - равон моторс казахстан</li>
<li>eurasia motor premium - тоо "eurasia motor zhaik"</li>
<li>hino motors - хино моторс казахстан</li>
</ul>
</div>
<div class="cell code" data-execution_count="584" id="5Z4aCRVqAk2v">
<div class="sourceCode" id="cb153"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb153-1"><a href="#cb153-1" aria-hidden="true" tabindex="-1"></a><span class="co"># создадим словарь для замены</span></span>
<span id="cb153-2"><a href="#cb153-2" aria-hidden="true" tabindex="-1"></a>company_dict <span class="op">=</span> {</span>
<span id="cb153-3"><a href="#cb153-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;mercur autos&#39;</span>: <span class="st">&#39;mercur auto&#39;</span>,</span>
<span id="cb153-4"><a href="#cb153-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;автомир гк&#39;</span>: <span class="st">&#39;автомир-центр&#39;</span>,</span>
<span id="cb153-5"><a href="#cb153-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;caspian motors&#39;</span>: <span class="st">&#39;каспиан моторс&#39;</span>,</span>
<span id="cb153-6"><a href="#cb153-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;mmc rus&#39;</span>: <span class="st">&#39;ммс рус&#39;</span>,</span>
<span id="cb153-7"><a href="#cb153-7" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;равон моторс казахстан&#39;</span>: <span class="st">&#39;ravon motors kazakstan&#39;</span>,</span>
<span id="cb153-8"><a href="#cb153-8" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;тоо &quot;eurasia motor zhaik&quot;&#39;</span>: <span class="st">&#39;eurasia motor premium&#39;</span>,</span>
<span id="cb153-9"><a href="#cb153-9" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;хино моторс казахстан&#39;</span>: <span class="st">&#39;hino motors&#39;</span></span>
<span id="cb153-10"><a href="#cb153-10" aria-hidden="true" tabindex="-1"></a>                 }</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="585" id="XT5JZX3RT5fu">
<div class="sourceCode" id="cb154"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb154-1"><a href="#cb154-1" aria-hidden="true" tabindex="-1"></a><span class="co"># произведем замену</span></span>
<span id="cb154-2"><a href="#cb154-2" aria-hidden="true" tabindex="-1"></a>df[<span class="st">&#39;компания&#39;</span>] <span class="op">=</span> df[<span class="st">&#39;компания&#39;</span>].replace(company_dict)</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="586"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="M05atXEQUCtD" data-outputId="5dc4a203-c53f-47f6-9dcc-1fd5af627c90">
<div class="sourceCode" id="cb155"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb155-1"><a href="#cb155-1" aria-hidden="true" tabindex="-1"></a><span class="co"># применим функцию</span></span>
<span id="cb155-2"><a href="#cb155-2" aria-hidden="true" tabindex="-1"></a>processing_col(<span class="st">&#39;компания&#39;</span>)</span></code></pre></div>
<div class="output execute_result" data-execution_count="586">
<pre><code>10                      allur auto
11           almaty motors premium
7                    astana motors
15                     autokapital
5            daewoo bus kazakhstan
4            eurasia motor premium
26                     hino motors
8     hyundai com trans kazakhstan
29      man truck &amp; bus kazakhstan
0                      mercur auto
9         nissan manufacturing rus
19          ravon motors kazakstan
20                  renault россия
25             scandinavian motors
30             scania central asia
21               subaru kazakhstan
12                    terra motors
13         toyota motor kazakhstan
22            volkswagen group rus
23              автодом motors kst
16                     автокапитал
24                   автомир-центр
1                автоцентр-бавария
2                       бипэк авто
3                            вираж
6                   каспиан моторс
14                лифан моторс рус
17                         ммс рус
28                       свс-транс
31                           семаз
27                        тк камаз
18                узавто-казахстан
dtype: object</code></pre>
</div>
</div>
<div class="cell markdown" id="DNCf0PSvUfaS">
<p>Неявные дубликаты отсутствуют.</p>
</div>
<section id="332-столбец-бренд" class="cell markdown" id="Kzf-dX9TUmbb">
<h3>3.3.2 Столбец 'бренд'</h3>
</section>
<div class="cell code" data-execution_count="587"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="8k2FzCtiUt46" data-outputId="ed82cfff-598e-4279-e3b2-7fd449b40b64">
<div class="sourceCode" id="cb157"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb157-1"><a href="#cb157-1" aria-hidden="true" tabindex="-1"></a><span class="co"># применим функцию</span></span>
<span id="cb157-2"><a href="#cb157-2" aria-hidden="true" tabindex="-1"></a>processing_col(<span class="st">&#39;бренд&#39;</span>)</span></code></pre></div>
<div class="output execute_result" data-execution_count="587">
<pre><code>34                   ankai
0                     audi
1                      bmw
32                cadillac
2                chevrolet
3                   daewoo
45               dong feng
4                     ford
41                   foton
5                      gaz
33                    hino
6                  hyundai
7      hyundai truck &amp; bus
8                 infiniti
37                   isuzu
9                    iveco
10                     jac
11                  jaguar
36                   kamaz
12                     kia
13                    lada
14              land rover
15                   lexus
16                   lifan
39                     man
42                   mazda
17           mercedes-benz
18    mercedes-benz trucks
19                    mini
20              mitsubishi
38                   nefaz
21                  nissan
22                 peugeot
23                 porsche
24                   ravon
25                 renault
40                  scania
44                 shacman
26                   skoda
27                  subaru
28                  toyota
29                     uaz
30              volkswagen
31                   volvo
35                  yutong
43                    урал
dtype: object</code></pre>
</div>
</div>
<div class="cell markdown" id="oGmbtF4lWWEx">
<p>Неявные дубликаты отсутствуют.</p>
</div>
<section id="333-столбец-страна-производитель" class="cell markdown"
id="nEVOPRCaUwSf">
<h3>3.3.3 Столбец 'страна-производитель'</h3>
</section>
<div class="cell code" data-execution_count="588"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="JcKhGH8vU5oE" data-outputId="3938e26d-d1a1-431e-d70d-2ef0c1b26707">
<div class="sourceCode" id="cb159"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb159-1"><a href="#cb159-1" aria-hidden="true" tabindex="-1"></a><span class="co"># применим функцию</span></span>
<span id="cb159-2"><a href="#cb159-2" aria-hidden="true" tabindex="-1"></a>processing_col(<span class="st">&#39;страна-производитель&#39;</span>)</span></code></pre></div>
<div class="output execute_result" data-execution_count="588">
<pre><code>8                       uk
2                  австрия
16              белоруссия
17                 бельгия
9                  венгрия
0                 германия
11                 испания
7                    китай
5                    корея
18              нидерланды
14                  польша
3     республика казахстан
4     российская федерация
1                      сша
12                 таиланд
10                  турция
13              узбекистан
15                  швеция
6                   япония
dtype: object</code></pre>
</div>
</div>
<div class="cell markdown" id="-O8S1ebTW3_n">
<p>Так как все названия на русском, за исключением одного, заменим
его.</p>
</div>
<div class="cell code" data-execution_count="589" id="HF_YYhJoW8wp">
<div class="sourceCode" id="cb161"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb161-1"><a href="#cb161-1" aria-hidden="true" tabindex="-1"></a>df[<span class="st">&#39;страна-производитель&#39;</span>] <span class="op">=</span> (</span>
<span id="cb161-2"><a href="#cb161-2" aria-hidden="true" tabindex="-1"></a>    df[<span class="st">&#39;страна-производитель&#39;</span>].replace(<span class="st">&#39;uk&#39;</span>, <span class="st">&#39;великобритания&#39;</span>)</span>
<span id="cb161-3"><a href="#cb161-3" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
</div>
<section id="334-столбец-область" class="cell markdown"
id="uVMFcB08U0Xe">
<h3>3.3.4 Столбец 'область'</h3>
</section>
<div class="cell code" data-execution_count="590"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="f9FJCT7TU-Ls" data-outputId="8db80385-8717-469a-f31c-6d14d51618f8">
<div class="sourceCode" id="cb162"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb162-1"><a href="#cb162-1" aria-hidden="true" tabindex="-1"></a><span class="co"># применим функцию</span></span>
<span id="cb162-2"><a href="#cb162-2" aria-hidden="true" tabindex="-1"></a>processing_col(<span class="st">&#39;область&#39;</span>)</span></code></pre></div>
<div class="output execute_result" data-execution_count="590">
<pre><code>12               акмолинская область
9                актюбинская область
16               алматинская область
8                 атырауская область
2     восточно-казахстанская область
0                           г.алматы
1                       г.нур-султан
14                жамбылская область
3      западно-казахстанская область
10            карагандинская область
4               костанайская область
13            кызылординская область
7              мангистауская область
5               павлодарская область
11      северо-казахстанская область
15             туркестанская область
17                   экспорт область
6         южно-казахстанская область
dtype: object</code></pre>
</div>
</div>
<div class="cell markdown" id="_CU7xqWsaB8O">
<p>Неявные дубликаты отсутствуют. Область продажи 'экспорт' относится к
продаже авто за границу.</p>
</div>
<section id="335-столбец-сегментация_2013" class="cell markdown"
id="DX_1K0UOU0eC">
<h3>3.3.5 Столбец 'сегментация_2013'</h3>
</section>
<div class="cell code" data-execution_count="591"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="s1er5OU4VBwz" data-outputId="a47f02c8-64ea-43cd-d48b-cf0c6b6cc915">
<div class="sourceCode" id="cb164"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb164-1"><a href="#cb164-1" aria-hidden="true" tabindex="-1"></a><span class="co"># применим функцию</span></span>
<span id="cb164-2"><a href="#cb164-2" aria-hidden="true" tabindex="-1"></a>processing_col(<span class="st">&#39;сегментация_2013&#39;</span>)</span></code></pre></div>
<div class="output execute_result" data-execution_count="591">
<pre><code>1               внедорожники
2    коммерческие автомобили
0        легковые автомобили
3                   минивэны
4                     пикапы
dtype: object</code></pre>
</div>
</div>
<div class="cell markdown" id="AuRGEtESf2l0">
<p>Неявные дубликаты отсутствуют.</p>
</div>
<section id="336-столбец-класс_2013" class="cell markdown"
id="_Qsu0tUaU0lg">
<h3>3.3.6 Столбец 'класс_2013'</h3>
</section>
<div class="cell code" data-execution_count="592"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="yIr-0cg9VDiq" data-outputId="faf4819e-9744-4a19-ffec-4ae48b82c142">
<div class="sourceCode" id="cb166"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb166-1"><a href="#cb166-1" aria-hidden="true" tabindex="-1"></a><span class="co"># применим функцию</span></span>
<span id="cb166-2"><a href="#cb166-2" aria-hidden="true" tabindex="-1"></a>processing_col(<span class="st">&#39;класс_2013&#39;</span>)</span></code></pre></div>
<div class="output execute_result" data-execution_count="592">
<pre><code>18                      a класс
8                       b класс
0                       c класс
1                       d класс
2                       e класс
3                       f класс
20                     pick-ups
10             большие автобусы
19                   компактвэн
7                компактные suv
16    крупнотоннажные грузовики
12      малотоннажные грузовики
11                микроавтобусы
5            полноразмерные suv
14       полноразмерный минивэн
17         развозные автомобили
6         спортивные автомобили
4           среднеразмерные suv
13    среднетоннажные грузовики
15             средние автобусы
9             субкомпактные suv
dtype: object</code></pre>
</div>
</div>
<div class="cell markdown" id="sSOhQ2QZgGgX">
<p>Неявные дубликаты отсутствуют.</p>
</div>
<section id="337-столбец-локализация_производства" class="cell markdown"
id="uslVCh6BUl_k">
<h3>3.3.7 Столбец 'локализация_производства'</h3>
</section>
<div class="cell code" data-execution_count="593"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="VuFKnBHJUl4_" data-outputId="f1869669-10f2-49a3-950f-e9a8aae2434d">
<div class="sourceCode" id="cb168"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb168-1"><a href="#cb168-1" aria-hidden="true" tabindex="-1"></a>processing_col(<span class="st">&#39;локализация_производства&#39;</span>)</span></code></pre></div>
<div class="output execute_result" data-execution_count="593">
<pre><code>0                    импорт
1    локальное производство
dtype: object</code></pre>
</div>
</div>
<div class="cell markdown" id="srg0dgMugRrM">
<p>Неявные дубликаты отсутствуют.</p>
</div>
<section id="34-выбросы" class="cell markdown" id="luydDJgMMKSd">
<h2>3.4 Выбросы</h2>
</section>
<div class="cell code" data-execution_count="594"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:300}"
id="g206Y6L6hAuI" data-outputId="65dcf150-9cdf-4870-f54b-18df734ebc55">
<div class="sourceCode" id="cb170"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb170-1"><a href="#cb170-1" aria-hidden="true" tabindex="-1"></a><span class="co"># посмотрим на описание числовых данных</span></span>
<span id="cb170-2"><a href="#cb170-2" aria-hidden="true" tabindex="-1"></a>df.describe()</span></code></pre></div>
<div class="output execute_result" data-execution_count="594">

  <div id="df-1bb99138-2f0d-4b6b-9618-31d10e252523" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>год</th>
      <th>объём_двиг_л</th>
      <th>количество</th>
      <th>цена_usd</th>
      <th>продажа_usd</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>39960.00</td>
      <td>39960.00</td>
      <td>39960.00</td>
      <td>39960.00</td>
      <td>39960.00</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>2019.00</td>
      <td>2.50</td>
      <td>1.35</td>
      <td>28251.73</td>
      <td>33762.74</td>
    </tr>
    <tr>
      <th>std</th>
      <td>0.00</td>
      <td>1.69</td>
      <td>2.37</td>
      <td>20006.41</td>
      <td>50704.57</td>
    </tr>
    <tr>
      <th>min</th>
      <td>2019.00</td>
      <td>-1.00</td>
      <td>-1.00</td>
      <td>7100.00</td>
      <td>-35588.25</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>2019.00</td>
      <td>1.60</td>
      <td>1.00</td>
      <td>15518.50</td>
      <td>16623.53</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>2019.00</td>
      <td>2.00</td>
      <td>1.00</td>
      <td>24283.86</td>
      <td>26248.96</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>2019.00</td>
      <td>2.69</td>
      <td>1.00</td>
      <td>32505.66</td>
      <td>35000.00</td>
    </tr>
    <tr>
      <th>max</th>
      <td>2019.00</td>
      <td>14.90</td>
      <td>115.00</td>
      <td>328510.97</td>
      <td>3778206.26</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-1bb99138-2f0d-4b6b-9618-31d10e252523')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-1bb99138-2f0d-4b6b-9618-31d10e252523 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-1bb99138-2f0d-4b6b-9618-31d10e252523');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-ba8afc06-76fe-4e8f-aba9-7ed6952b790a">
  <button class="colab-df-quickchart" onclick="quickchart('df-ba8afc06-76fe-4e8f-aba9-7ed6952b790a')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-ba8afc06-76fe-4e8f-aba9-7ed6952b790a button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>
    </div>
  </div>

</div>
</div>
<div class="cell markdown" id="jqgFYCg4h-ks">
<p>Количество проданных автомобилей -1 означает возврат. Необходимо
посчитать количество таких строк и удалить, если их мало. В продаже есть
отрицательное значение. Скорее всего это тоже относится к возврату.</p>
<p>-1 в объёме двигателя является заглушкой для эклетрокаров.</p>
<p>Количество проданных автомобилей более 100 может относиться к закупке
авто такси. Ошибкой это не является.</p>
</div>
<div class="cell code" data-execution_count="595"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:135}"
id="Lj4Pmow_jQhG" data-outputId="8ecd3f7d-d263-4fc4-a0fc-0f43c58f4abd">
<div class="sourceCode" id="cb171"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb171-1"><a href="#cb171-1" aria-hidden="true" tabindex="-1"></a><span class="co"># выведем возвраты</span></span>
<span id="cb171-2"><a href="#cb171-2" aria-hidden="true" tabindex="-1"></a>df.query(<span class="st">&quot;количество &lt; 1&quot;</span>)</span></code></pre></div>
<div class="output execute_result" data-execution_count="595">

  <div id="df-9e617c68-5bb4-4e20-9ea2-82a12aa99911" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>год</th>
      <th>месяц</th>
      <th>компания</th>
      <th>бренд</th>
      <th>модель</th>
      <th>год_выпуска</th>
      <th>авто</th>
      <th>страна-производитель</th>
      <th>вид_топлива</th>
      <th>объём_двиг_л</th>
      <th>коробка_передач</th>
      <th>тип_привода</th>
      <th>регион</th>
      <th>тип_клиента</th>
      <th>количество</th>
      <th>цена_usd</th>
      <th>продажа_usd</th>
      <th>область</th>
      <th>сегментация_2013</th>
      <th>класс_2013</th>
      <th>локализация_производства</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>25728</th>
      <td>2019</td>
      <td>Август</td>
      <td>бипэк авто</td>
      <td>skoda</td>
      <td>superb</td>
      <td>2019</td>
      <td>skoda superb</td>
      <td>республика казахстан</td>
      <td>бензин</td>
      <td>2.00</td>
      <td>AT</td>
      <td>4WD</td>
      <td>Тараз</td>
      <td>физлицо</td>
      <td>-1.00</td>
      <td>35588.25</td>
      <td>-35588.25</td>
      <td>жамбылская область</td>
      <td>легковые автомобили</td>
      <td>d класс</td>
      <td>локальное производство</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-9e617c68-5bb4-4e20-9ea2-82a12aa99911')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-9e617c68-5bb4-4e20-9ea2-82a12aa99911 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-9e617c68-5bb4-4e20-9ea2-82a12aa99911');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>

    </div>
  </div>

</div>
</div>
<div class="cell markdown" id="ojl6bvLOjU3-">
<p>Так и есть. Отрицательное значение количества и суммы продажи в одной
строке и относятся к возврату. Можно их удалить.</p>
</div>
<div class="cell code" data-execution_count="596" id="g9yQiMlbiibU">
<div class="sourceCode" id="cb172"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb172-1"><a href="#cb172-1" aria-hidden="true" tabindex="-1"></a><span class="co"># удаляем строку с возвратом</span></span>
<span id="cb172-2"><a href="#cb172-2" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> df.query(<span class="st">&quot;количество &gt; 0&quot;</span>)</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="597"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:300}"
id="ed4x77Qj0XP4" data-outputId="836333f5-5404-458c-efe0-16a129f38bc0">
<div class="sourceCode" id="cb173"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb173-1"><a href="#cb173-1" aria-hidden="true" tabindex="-1"></a><span class="co"># посмотрим на описание числовых данных</span></span>
<span id="cb173-2"><a href="#cb173-2" aria-hidden="true" tabindex="-1"></a>df.describe()</span></code></pre></div>
<div class="output execute_result" data-execution_count="597">

  <div id="df-657db1cd-f14b-4d01-a02c-5656cb85d6e6" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>год</th>
      <th>объём_двиг_л</th>
      <th>количество</th>
      <th>цена_usd</th>
      <th>продажа_usd</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>39959.00</td>
      <td>39959.00</td>
      <td>39959.00</td>
      <td>39959.00</td>
      <td>39959.00</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>2019.00</td>
      <td>2.50</td>
      <td>1.35</td>
      <td>28251.55</td>
      <td>33764.47</td>
    </tr>
    <tr>
      <th>std</th>
      <td>0.00</td>
      <td>1.69</td>
      <td>2.37</td>
      <td>20006.63</td>
      <td>50704.02</td>
    </tr>
    <tr>
      <th>min</th>
      <td>2019.00</td>
      <td>-1.00</td>
      <td>1.00</td>
      <td>7100.00</td>
      <td>7100.00</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>2019.00</td>
      <td>1.60</td>
      <td>1.00</td>
      <td>15518.50</td>
      <td>16623.53</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>2019.00</td>
      <td>2.00</td>
      <td>1.00</td>
      <td>24282.27</td>
      <td>26248.96</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>2019.00</td>
      <td>2.69</td>
      <td>1.00</td>
      <td>32505.66</td>
      <td>35000.00</td>
    </tr>
    <tr>
      <th>max</th>
      <td>2019.00</td>
      <td>14.90</td>
      <td>115.00</td>
      <td>328510.97</td>
      <td>3778206.26</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-657db1cd-f14b-4d01-a02c-5656cb85d6e6')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-657db1cd-f14b-4d01-a02c-5656cb85d6e6 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-657db1cd-f14b-4d01-a02c-5656cb85d6e6');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-1be2b49b-1948-47a3-9eb1-b49f6ead9628">
  <button class="colab-df-quickchart" onclick="quickchart('df-1be2b49b-1948-47a3-9eb1-b49f6ead9628')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-1be2b49b-1948-47a3-9eb1-b49f6ead9628 button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>
    </div>
  </div>

</div>
</div>
<div class="cell markdown" id="F_WAkzgRjyIm">
<p>Данные избавлены от некорректных значений.</p>
</div>
<section id="35-категоризация-признаков" class="cell markdown"
id="IC-DRGaWj2-q">
<h2>3.5 Категоризация признаков</h2>
</section>
<div class="cell markdown" id="cIIrRB7nj6a3">
<p>В связи с тем, что столбец объём двигателя нужен для анализа, а
количество уникальных значений в нем слишком большое, то удобнее будет
разбить объёмы на следующие категории:</p>
<ul>
<li>до 1.5л - малолитражные</li>
<li>от 1.5 до 2л - среднелитражные</li>
<li>от 2 до 3.5 - большелитражные</li>
<li>от 3.5 - высшелитражные</li>
</ul>
</div>
<div class="cell code" data-execution_count="598" id="gZ59Y9QSl3Hh">
<div class="sourceCode" id="cb174"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb174-1"><a href="#cb174-1" aria-hidden="true" tabindex="-1"></a><span class="co"># зададим условия</span></span>
<span id="cb174-2"><a href="#cb174-2" aria-hidden="true" tabindex="-1"></a>conditions <span class="op">=</span> [</span>
<span id="cb174-3"><a href="#cb174-3" aria-hidden="true" tabindex="-1"></a>    df[<span class="st">&#39;объём_двиг_л&#39;</span>] <span class="op">&lt;</span> <span class="fl">1.5</span>,</span>
<span id="cb174-4"><a href="#cb174-4" aria-hidden="true" tabindex="-1"></a>    (df[<span class="st">&#39;объём_двиг_л&#39;</span>] <span class="op">&gt;=</span> <span class="fl">1.5</span>) <span class="op">&amp;</span> (df[<span class="st">&#39;объём_двиг_л&#39;</span>] <span class="op">&lt;</span> <span class="dv">2</span>),</span>
<span id="cb174-5"><a href="#cb174-5" aria-hidden="true" tabindex="-1"></a>    (df[<span class="st">&#39;объём_двиг_л&#39;</span>] <span class="op">&gt;=</span> <span class="dv">2</span>) <span class="op">&amp;</span> (df[<span class="st">&#39;объём_двиг_л&#39;</span>] <span class="op">&lt;</span> <span class="fl">3.5</span>),</span>
<span id="cb174-6"><a href="#cb174-6" aria-hidden="true" tabindex="-1"></a>    df[<span class="st">&#39;объём_двиг_л&#39;</span>] <span class="op">&gt;</span> <span class="dv">3</span></span>
<span id="cb174-7"><a href="#cb174-7" aria-hidden="true" tabindex="-1"></a>]</span>
<span id="cb174-8"><a href="#cb174-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb174-9"><a href="#cb174-9" aria-hidden="true" tabindex="-1"></a><span class="co"># установим категории</span></span>
<span id="cb174-10"><a href="#cb174-10" aria-hidden="true" tabindex="-1"></a>categories <span class="op">=</span> [<span class="st">&#39;микролитражный&#39;</span>, <span class="st">&#39;малолитражный&#39;</span>,</span>
<span id="cb174-11"><a href="#cb174-11" aria-hidden="true" tabindex="-1"></a>              <span class="st">&#39;среднелитражный&#39;</span>, <span class="st">&#39;высоколитражный&#39;</span>]</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="599" id="dkrGx1D9MdM3">
<div class="sourceCode" id="cb175"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb175-1"><a href="#cb175-1" aria-hidden="true" tabindex="-1"></a><span class="co"># создадим новый столбец с названием категорий</span></span>
<span id="cb175-2"><a href="#cb175-2" aria-hidden="true" tabindex="-1"></a>df[<span class="st">&#39;объем_двиг_кат&#39;</span>] <span class="op">=</span> np.select(conditions, categories)</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="600"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:660}"
id="vachZSXmn3uo" data-outputId="ad8ef1d3-81a0-4bf8-97d9-5107ec4dfb3b">
<div class="sourceCode" id="cb176"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb176-1"><a href="#cb176-1" aria-hidden="true" tabindex="-1"></a>df.sample(<span class="dv">10</span>)</span></code></pre></div>
<div class="output execute_result" data-execution_count="600">

  <div id="df-481749f0-14e2-435e-803f-c1c168b04ff9" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>год</th>
      <th>месяц</th>
      <th>компания</th>
      <th>бренд</th>
      <th>модель</th>
      <th>год_выпуска</th>
      <th>авто</th>
      <th>страна-производитель</th>
      <th>вид_топлива</th>
      <th>объём_двиг_л</th>
      <th>коробка_передач</th>
      <th>тип_привода</th>
      <th>регион</th>
      <th>тип_клиента</th>
      <th>количество</th>
      <th>цена_usd</th>
      <th>продажа_usd</th>
      <th>область</th>
      <th>сегментация_2013</th>
      <th>класс_2013</th>
      <th>локализация_производства</th>
      <th>объем_двиг_кат</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>19064</th>
      <td>2019</td>
      <td>Январь</td>
      <td>toyota motor kazakhstan</td>
      <td>lexus</td>
      <td>lx</td>
      <td>2018</td>
      <td>lexus lx</td>
      <td>япония</td>
      <td>бензин</td>
      <td>5.70</td>
      <td>AT</td>
      <td>4WD</td>
      <td>Нур-Султан</td>
      <td>физлицо</td>
      <td>1.00</td>
      <td>98419.75</td>
      <td>98419.75</td>
      <td>г.нур-султан</td>
      <td>внедорожники</td>
      <td>полноразмерные suv</td>
      <td>импорт</td>
      <td>высоколитражный</td>
    </tr>
    <tr>
      <th>1971</th>
      <td>2019</td>
      <td>Август</td>
      <td>вираж</td>
      <td>gaz</td>
      <td>3302</td>
      <td>2019</td>
      <td>gaz 3302</td>
      <td>республика казахстан</td>
      <td>бензин</td>
      <td>2.70</td>
      <td>MT</td>
      <td>RWD</td>
      <td>Павлодар</td>
      <td>юрлицо</td>
      <td>1.00</td>
      <td>15683.91</td>
      <td>15683.91</td>
      <td>павлодарская область</td>
      <td>коммерческие автомобили</td>
      <td>малотоннажные грузовики</td>
      <td>локальное производство</td>
      <td>среднелитражный</td>
    </tr>
    <tr>
      <th>27883</th>
      <td>2019</td>
      <td>Апрель</td>
      <td>toyota motor kazakhstan</td>
      <td>toyota</td>
      <td>camry</td>
      <td>2019</td>
      <td>toyota camry</td>
      <td>российская федерация</td>
      <td>бензин</td>
      <td>2.50</td>
      <td>AT</td>
      <td>FWD</td>
      <td>Шымкент</td>
      <td>физлицо</td>
      <td>1.00</td>
      <td>33118.43</td>
      <td>33118.43</td>
      <td>южно-казахстанская область</td>
      <td>легковые автомобили</td>
      <td>d класс</td>
      <td>импорт</td>
      <td>среднелитражный</td>
    </tr>
    <tr>
      <th>1182</th>
      <td>2019</td>
      <td>Январь</td>
      <td>вираж</td>
      <td>gaz</td>
      <td>3302</td>
      <td>2018</td>
      <td>gaz 3302</td>
      <td>республика казахстан</td>
      <td>бензин</td>
      <td>2.70</td>
      <td>MT</td>
      <td>RWD</td>
      <td>Атырау</td>
      <td>юрлицо</td>
      <td>1.00</td>
      <td>15280.96</td>
      <td>15280.96</td>
      <td>атырауская область</td>
      <td>коммерческие автомобили</td>
      <td>малотоннажные грузовики</td>
      <td>локальное производство</td>
      <td>среднелитражный</td>
    </tr>
    <tr>
      <th>11072</th>
      <td>2019</td>
      <td>Май</td>
      <td>astana motors</td>
      <td>hyundai</td>
      <td>tucson</td>
      <td>2019</td>
      <td>hyundai tucson</td>
      <td>республика казахстан</td>
      <td>бензин</td>
      <td>2.00</td>
      <td>AT</td>
      <td>4WD</td>
      <td>Алматы</td>
      <td>физлицо</td>
      <td>1.00</td>
      <td>29183.15</td>
      <td>29183.15</td>
      <td>г.алматы</td>
      <td>внедорожники</td>
      <td>компактные suv</td>
      <td>локальное производство</td>
      <td>среднелитражный</td>
    </tr>
    <tr>
      <th>22926</th>
      <td>2019</td>
      <td>Август</td>
      <td>ravon motors kazakstan</td>
      <td>ravon</td>
      <td>nexia r3</td>
      <td>2019</td>
      <td>ravon nexia r3</td>
      <td>республика казахстан</td>
      <td>бензин</td>
      <td>1.50</td>
      <td>AT</td>
      <td>FWD</td>
      <td>Шымкент</td>
      <td>физлицо</td>
      <td>1.00</td>
      <td>9893.93</td>
      <td>9893.93</td>
      <td>южно-казахстанская область</td>
      <td>легковые автомобили</td>
      <td>b класс</td>
      <td>локальное производство</td>
      <td>малолитражный</td>
    </tr>
    <tr>
      <th>26313</th>
      <td>2019</td>
      <td>Январь</td>
      <td>toyota motor kazakhstan</td>
      <td>toyota</td>
      <td>camry</td>
      <td>2018</td>
      <td>toyota camry</td>
      <td>российская федерация</td>
      <td>бензин</td>
      <td>2.50</td>
      <td>AT</td>
      <td>FWD</td>
      <td>Павлодар</td>
      <td>физлицо</td>
      <td>1.00</td>
      <td>28225.64</td>
      <td>28225.64</td>
      <td>павлодарская область</td>
      <td>легковые автомобили</td>
      <td>d класс</td>
      <td>импорт</td>
      <td>среднелитражный</td>
    </tr>
    <tr>
      <th>33238</th>
      <td>2019</td>
      <td>Январь</td>
      <td>toyota motor kazakhstan</td>
      <td>toyota</td>
      <td>lc prado</td>
      <td>2018</td>
      <td>toyota lc prado</td>
      <td>япония</td>
      <td>бензин</td>
      <td>2.70</td>
      <td>AT</td>
      <td>4WD</td>
      <td>Павлодар</td>
      <td>физлицо</td>
      <td>1.00</td>
      <td>50742.73</td>
      <td>50742.73</td>
      <td>павлодарская область</td>
      <td>внедорожники</td>
      <td>среднеразмерные suv</td>
      <td>импорт</td>
      <td>среднелитражный</td>
    </tr>
    <tr>
      <th>17814</th>
      <td>2019</td>
      <td>Январь</td>
      <td>бипэк авто</td>
      <td>lada</td>
      <td>vesta</td>
      <td>2018</td>
      <td>lada vesta</td>
      <td>республика казахстан</td>
      <td>бензин</td>
      <td>1.60</td>
      <td>MT</td>
      <td>FWD</td>
      <td>Актобе</td>
      <td>юрлицо</td>
      <td>4.00</td>
      <td>12900.00</td>
      <td>51600.00</td>
      <td>актюбинская область</td>
      <td>легковые автомобили</td>
      <td>b класс</td>
      <td>локальное производство</td>
      <td>малолитражный</td>
    </tr>
    <tr>
      <th>13484</th>
      <td>2019</td>
      <td>Июль</td>
      <td>allur auto</td>
      <td>jac</td>
      <td>s3</td>
      <td>2019</td>
      <td>jac s3</td>
      <td>республика казахстан</td>
      <td>бензин</td>
      <td>1.60</td>
      <td>AT</td>
      <td>2WD</td>
      <td>Нур-Султан</td>
      <td>физлицо</td>
      <td>1.00</td>
      <td>14695.80</td>
      <td>14695.80</td>
      <td>г.нур-султан</td>
      <td>внедорожники</td>
      <td>субкомпактные suv</td>
      <td>локальное производство</td>
      <td>малолитражный</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-481749f0-14e2-435e-803f-c1c168b04ff9')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-481749f0-14e2-435e-803f-c1c168b04ff9 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-481749f0-14e2-435e-803f-c1c168b04ff9');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-26030ccb-342a-4b2a-ae1c-c913129450db">
  <button class="colab-df-quickchart" onclick="quickchart('df-26030ccb-342a-4b2a-ae1c-c913129450db')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-26030ccb-342a-4b2a-ae1c-c913129450db button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>
    </div>
  </div>

</div>
</div>
<div class="cell markdown" id="HxJs1PoOn31b">
<p>Категоризация работает корректно.</p>
</div>
<section id="36-создание-столбца-дат" class="cell markdown"
id="UH6Im5qLn4PI">
<h2>3.6 Создание столбца дат</h2>
</section>
<div class="cell markdown" id="fA0xZo__n4Vf">
<p>Для удобства построения графиков и сгруппированных отчетов переведем
значения месяцев в цифры, соединим с годом и переведем в формат
даты.</p>
</div>
<div class="cell code" data-execution_count="601"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="68JOndicAUn2" data-outputId="c25df550-7087-4f23-f3db-22d63898c56f">
<div class="sourceCode" id="cb177"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb177-1"><a href="#cb177-1" aria-hidden="true" tabindex="-1"></a><span class="co"># выведем инфо о столбце</span></span>
<span id="cb177-2"><a href="#cb177-2" aria-hidden="true" tabindex="-1"></a>info(df, <span class="st">&#39;месяц&#39;</span>)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>&lt;class &#39;pandas.core.series.Series&#39;&gt;
Int64Index: 39959 entries, 0 to 39552
Series name: месяц
Non-Null Count  Dtype 
--------------  ----- 
39959 non-null  object
dtypes: object(1)
memory usage: 624.4+ KB
None 

[&#39;Май&#39; &#39;Август&#39; &#39;Апрель&#39; &#39;Июль&#39; &#39;Февраль&#39; &#39;Июнь&#39; &#39;Сентябрь&#39; &#39;Январь&#39;
 &#39;Март&#39;]
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="602"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="8tpgwriqAhLL" data-outputId="e65bbf98-2426-4c44-ab1d-7acb391a9185">
<div class="sourceCode" id="cb179"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb179-1"><a href="#cb179-1" aria-hidden="true" tabindex="-1"></a><span class="co"># приведем все к нижнему регистру</span></span>
<span id="cb179-2"><a href="#cb179-2" aria-hidden="true" tabindex="-1"></a>processing_col(<span class="st">&#39;месяц&#39;</span>)</span></code></pre></div>
<div class="output execute_result" data-execution_count="602">
<pre><code>1      август
2      апрель
3        июль
5        июнь
0         май
8        март
6    сентябрь
4     февраль
7      январь
dtype: object</code></pre>
</div>
</div>
<div class="cell markdown" id="YFRQq9fFAls8">
<p>Неявныйх дубликатов нет. Информация у нас представлена с января по
сентябрь</p>
</div>
<div class="cell code" data-execution_count="603" id="3-HMGSH7MRcl">
<div class="sourceCode" id="cb181"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb181-1"><a href="#cb181-1" aria-hidden="true" tabindex="-1"></a><span class="co"># создадим словарь месяц-цифра</span></span>
<span id="cb181-2"><a href="#cb181-2" aria-hidden="true" tabindex="-1"></a>month_dict <span class="op">=</span> {</span>
<span id="cb181-3"><a href="#cb181-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;январь&#39;</span>: <span class="st">&#39;01&#39;</span>,</span>
<span id="cb181-4"><a href="#cb181-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;февраль&#39;</span>: <span class="st">&#39;02&#39;</span>,</span>
<span id="cb181-5"><a href="#cb181-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;март&#39;</span>: <span class="st">&#39;03&#39;</span>,</span>
<span id="cb181-6"><a href="#cb181-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;апрель&#39;</span>: <span class="st">&#39;04&#39;</span>,</span>
<span id="cb181-7"><a href="#cb181-7" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;май&#39;</span>: <span class="st">&#39;05&#39;</span>,</span>
<span id="cb181-8"><a href="#cb181-8" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;июнь&#39;</span>: <span class="st">&#39;06&#39;</span>,</span>
<span id="cb181-9"><a href="#cb181-9" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;июль&#39;</span>: <span class="st">&#39;07&#39;</span>,</span>
<span id="cb181-10"><a href="#cb181-10" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;август&#39;</span>: <span class="st">&#39;08&#39;</span>,</span>
<span id="cb181-11"><a href="#cb181-11" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;сентябрь&#39;</span>: <span class="st">&#39;09&#39;</span></span>
<span id="cb181-12"><a href="#cb181-12" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb181-13"><a href="#cb181-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb181-14"><a href="#cb181-14" aria-hidden="true" tabindex="-1"></a><span class="co"># применим словарь к новому столбцу</span></span>
<span id="cb181-15"><a href="#cb181-15" aria-hidden="true" tabindex="-1"></a>df[<span class="st">&#39;месяц_цифра&#39;</span>] <span class="op">=</span> df[<span class="st">&#39;месяц&#39;</span>].<span class="bu">map</span>(month_dict)</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="604" id="APlvAR8UPIB8">
<div class="sourceCode" id="cb182"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb182-1"><a href="#cb182-1" aria-hidden="true" tabindex="-1"></a><span class="co"># создадим новый столбец даты</span></span>
<span id="cb182-2"><a href="#cb182-2" aria-hidden="true" tabindex="-1"></a>df[<span class="st">&#39;дата&#39;</span>] <span class="op">=</span> df[<span class="st">&#39;год&#39;</span>].astype(<span class="st">&#39;str&#39;</span>) <span class="op">+</span> <span class="st">&#39;-&#39;</span> <span class="op">+</span> df[<span class="st">&#39;месяц_цифра&#39;</span>]</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="605" id="KNHiwy79BjUw">
<div class="sourceCode" id="cb183"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb183-1"><a href="#cb183-1" aria-hidden="true" tabindex="-1"></a><span class="co"># переведем столбец в формат даты и времени</span></span>
<span id="cb183-2"><a href="#cb183-2" aria-hidden="true" tabindex="-1"></a>df[<span class="st">&#39;дата&#39;</span>] <span class="op">=</span> pd.to_datetime(df[<span class="st">&#39;дата&#39;</span>], <span class="bu">format</span><span class="op">=</span><span class="st">&#39;%Y-%m&#39;</span>)</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="606"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:348}"
id="Sa7aEMgYBjMy" data-outputId="1e670cf0-c2b9-4191-dc04-3cb61d614dd5">
<div class="sourceCode" id="cb184"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb184-1"><a href="#cb184-1" aria-hidden="true" tabindex="-1"></a>df.sample(<span class="dv">5</span>)</span></code></pre></div>
<div class="output execute_result" data-execution_count="606">

  <div id="df-c0bb2fb8-e2e1-4257-bfb3-a028d57f2b8f" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>год</th>
      <th>месяц</th>
      <th>компания</th>
      <th>бренд</th>
      <th>модель</th>
      <th>год_выпуска</th>
      <th>авто</th>
      <th>страна-производитель</th>
      <th>вид_топлива</th>
      <th>объём_двиг_л</th>
      <th>коробка_передач</th>
      <th>тип_привода</th>
      <th>регион</th>
      <th>тип_клиента</th>
      <th>количество</th>
      <th>цена_usd</th>
      <th>продажа_usd</th>
      <th>область</th>
      <th>сегментация_2013</th>
      <th>класс_2013</th>
      <th>локализация_производства</th>
      <th>объем_двиг_кат</th>
      <th>месяц_цифра</th>
      <th>дата</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>5210</th>
      <td>2019</td>
      <td>апрель</td>
      <td>astana motors</td>
      <td>hyundai</td>
      <td>creta</td>
      <td>2019</td>
      <td>hyundai creta</td>
      <td>республика казахстан</td>
      <td>бензин</td>
      <td>1.60</td>
      <td>AT</td>
      <td>2WD</td>
      <td>Нур-Султан</td>
      <td>физлицо</td>
      <td>1.00</td>
      <td>18680.16</td>
      <td>18680.16</td>
      <td>г.нур-султан</td>
      <td>внедорожники</td>
      <td>субкомпактные suv</td>
      <td>локальное производство</td>
      <td>малолитражный</td>
      <td>04</td>
      <td>2019-04-01</td>
    </tr>
    <tr>
      <th>24680</th>
      <td>2019</td>
      <td>февраль</td>
      <td>renault россия</td>
      <td>renault</td>
      <td>logan</td>
      <td>2018</td>
      <td>renault logan</td>
      <td>российская федерация</td>
      <td>бензин</td>
      <td>2.00</td>
      <td>AT</td>
      <td>2WD</td>
      <td>Нур-Султан</td>
      <td>физлицо</td>
      <td>1.00</td>
      <td>10519.57</td>
      <td>10519.57</td>
      <td>г.нур-султан</td>
      <td>легковые автомобили</td>
      <td>b класс</td>
      <td>импорт</td>
      <td>среднелитражный</td>
      <td>02</td>
      <td>2019-02-01</td>
    </tr>
    <tr>
      <th>24971</th>
      <td>2019</td>
      <td>сентябрь</td>
      <td>renault россия</td>
      <td>renault</td>
      <td>logan</td>
      <td>2019</td>
      <td>renault logan</td>
      <td>российская федерация</td>
      <td>бензин</td>
      <td>2.00</td>
      <td>AT</td>
      <td>2WD</td>
      <td>Нур-Султан</td>
      <td>физлицо</td>
      <td>1.00</td>
      <td>12550.93</td>
      <td>12550.93</td>
      <td>г.нур-султан</td>
      <td>легковые автомобили</td>
      <td>b класс</td>
      <td>импорт</td>
      <td>среднелитражный</td>
      <td>09</td>
      <td>2019-09-01</td>
    </tr>
    <tr>
      <th>24748</th>
      <td>2019</td>
      <td>март</td>
      <td>renault россия</td>
      <td>renault</td>
      <td>logan</td>
      <td>2018</td>
      <td>renault logan</td>
      <td>российская федерация</td>
      <td>бензин</td>
      <td>2.00</td>
      <td>AT</td>
      <td>2WD</td>
      <td>Алматы</td>
      <td>юрлицо</td>
      <td>1.00</td>
      <td>10651.13</td>
      <td>10651.13</td>
      <td>г.алматы</td>
      <td>легковые автомобили</td>
      <td>b класс</td>
      <td>импорт</td>
      <td>среднелитражный</td>
      <td>03</td>
      <td>2019-03-01</td>
    </tr>
    <tr>
      <th>31862</th>
      <td>2019</td>
      <td>июль</td>
      <td>toyota motor kazakhstan</td>
      <td>toyota</td>
      <td>corolla</td>
      <td>2019</td>
      <td>toyota corolla</td>
      <td>турция</td>
      <td>бензин</td>
      <td>4.00</td>
      <td>AT</td>
      <td>4WD</td>
      <td>Уральск</td>
      <td>физлицо</td>
      <td>1.00</td>
      <td>22282.39</td>
      <td>22282.39</td>
      <td>западно-казахстанская область</td>
      <td>легковые автомобили</td>
      <td>c класс</td>
      <td>импорт</td>
      <td>высоколитражный</td>
      <td>07</td>
      <td>2019-07-01</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-c0bb2fb8-e2e1-4257-bfb3-a028d57f2b8f')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-c0bb2fb8-e2e1-4257-bfb3-a028d57f2b8f button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-c0bb2fb8-e2e1-4257-bfb3-a028d57f2b8f');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-acf2899c-e9d8-4dd8-a686-04fd2821538e">
  <button class="colab-df-quickchart" onclick="quickchart('df-acf2899c-e9d8-4dd8-a686-04fd2821538e')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-acf2899c-e9d8-4dd8-a686-04fd2821538e button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>
    </div>
  </div>

</div>
</div>
<div class="cell code" data-execution_count="607" id="Z-y3eG2YGM3l">
<div class="sourceCode" id="cb185"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb185-1"><a href="#cb185-1" aria-hidden="true" tabindex="-1"></a><span class="co"># удалим столбец месяц_цифра</span></span>
<span id="cb185-2"><a href="#cb185-2" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> df.drop(columns<span class="op">=</span>[<span class="st">&#39;месяц_цифра&#39;</span>])</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="608"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="kBEnPObsD85w" data-outputId="290e48da-f6e4-42ba-9269-a3458d52a4e0">
<div class="sourceCode" id="cb186"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb186-1"><a href="#cb186-1" aria-hidden="true" tabindex="-1"></a>df[<span class="st">&#39;дата&#39;</span>].info()</span></code></pre></div>
<div class="output stream stdout">
<pre><code>&lt;class &#39;pandas.core.series.Series&#39;&gt;
Int64Index: 39959 entries, 0 to 39552
Series name: дата
Non-Null Count  Dtype         
--------------  -----         
39959 non-null  datetime64[ns]
dtypes: datetime64[ns](1)
memory usage: 624.4 KB
</code></pre>
</div>
</div>
<div class="cell markdown" id="11idrRIXBjjU">
<p>Столбец 'дата' отображае корректную информацию и приведен к
правильному типу данных.</p>
</div>
<div class="cell code" data-execution_count="609"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="j2Sztu59GgoB" data-outputId="f1d7596b-b27f-47de-99a4-a2585fca140e">
<div class="sourceCode" id="cb188"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb188-1"><a href="#cb188-1" aria-hidden="true" tabindex="-1"></a><span class="co"># посмотрим на финальную информацию о датафрейме после обработки</span></span>
<span id="cb188-2"><a href="#cb188-2" aria-hidden="true" tabindex="-1"></a>df.info()</span></code></pre></div>
<div class="output stream stdout">
<pre><code>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
Int64Index: 39959 entries, 0 to 39552
Data columns (total 23 columns):
 #   Column                    Non-Null Count  Dtype         
---  ------                    --------------  -----         
 0   год                       39959 non-null  int64         
 1   месяц                     39959 non-null  object        
 2   компания                  39959 non-null  object        
 3   бренд                     39959 non-null  object        
 4   модель                    39959 non-null  object        
 5   год_выпуска               39959 non-null  object        
 6   авто                      39959 non-null  object        
 7   страна-производитель      39959 non-null  object        
 8   вид_топлива               39959 non-null  object        
 9   объём_двиг_л              39959 non-null  float64       
 10  коробка_передач           39959 non-null  object        
 11  тип_привода               39959 non-null  object        
 12  регион                    39959 non-null  object        
 13  тип_клиента               39959 non-null  object        
 14  количество                39959 non-null  float64       
 15  цена_usd                  39959 non-null  float64       
 16  продажа_usd               39959 non-null  float64       
 17  область                   39959 non-null  object        
 18  сегментация_2013          39959 non-null  object        
 19  класс_2013                39959 non-null  object        
 20  локализация_производства  39959 non-null  object        
 21  объем_двиг_кат            39959 non-null  object        
 22  дата                      39959 non-null  datetime64[ns]
dtypes: datetime64[ns](1), float64(4), int64(1), object(17)
memory usage: 7.3+ MB
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="610"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:36}"
id="ZZbRs7jZHLUF" data-outputId="7b8c60b1-581e-443b-d0f1-f82a04a1da9b">
<div class="sourceCode" id="cb190"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb190-1"><a href="#cb190-1" aria-hidden="true" tabindex="-1"></a><span class="ss">f&#39;Строк потеряно после обработки </span><span class="sc">{</span>nrows_start <span class="op">-</span> df<span class="sc">.</span>shape[<span class="dv">0</span>]<span class="sc">}</span><span class="ss"> или </span><span class="ch">\</span></span>
<span id="cb190-2"><a href="#cb190-2" aria-hidden="true" tabindex="-1"></a><span class="sc">{</span>(nrows_start <span class="op">-</span> df.shape[<span class="dv">0</span>]) <span class="op">/</span> nrows_start<span class="sc">:.4f}</span><span class="ss">%&#39;</span></span></code></pre></div>
<div class="output execute_result" data-execution_count="610">
<div class="sourceCode" id="cb191"><pre
class="sourceCode json"><code class="sourceCode json"><span id="cb191-1"><a href="#cb191-1" aria-hidden="true" tabindex="-1"></a><span class="fu">{</span><span class="dt">&quot;type&quot;</span><span class="fu">:</span><span class="st">&quot;string&quot;</span><span class="fu">}</span></span></code></pre></div>
</div>
</div>
<section id="вывод-предобработки-данных" class="cell markdown"
id="w4O4t0ftEnvK">
<h1><strong>Вывод предобработки данных</strong></h1>
<p>В ходе предобработки данных было выполнено следующее:</p>
<ul>
<li>названия столбцов приведены к стандартам;</li>
<li>удалены лишние столбцы;</li>
<li>удалены некорректные значения;</li>
<li>заполнены пропуски в столбцах;</li>
<li>столбцы приведены к нужному типы;</li>
<li>для удобства последующего анализа созданы новые столбцы категории
объема двигателя и даты;</li>
<li>устранены неявные дубликаты в столбцах.</li>
</ul>
<p>После предобработки потеряно лишь 7 строк, что составляет 0.0002% от
изначального числа.</p>
<p>Результат заполнения пропусков:</p>
<p>|Столбец: | Пропуски до| Пропуски после :---: | :---: | :---:<br />
год_выпуска |501 |0 вид_топлива |3140 |0 объём_двиг_л |4258 |0
коробка_передач |3255 |0 тип_привода |4289 |0 тип_клиента |7047 |0
количество |6 |0</p>
</section>
<section id="4-eda" class="cell markdown" id="rU6UL0aHKUOw">
<h1>4 EDA</h1>
</section>
<section id="41-количество-брендов-на-компанию" class="cell markdown"
id="37tkpjcuomOy">
<h2>4.1 Количество брендов на компанию</h2>
</section>
<div class="cell markdown" id="pJ3uS-xHosz9">
<p>Посчитаем количество продаваемых брендов в каждой компании. Выясним,
сколько из них торгуют только одним брендом, а какие несколькими.</p>
</div>
<div class="cell code" data-execution_count="611"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:1000}"
id="p_cjCsOyo2Oi" data-outputId="7755b0de-f69c-49dd-c2e9-3d442dfa3ae3">
<div class="sourceCode" id="cb192"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb192-1"><a href="#cb192-1" aria-hidden="true" tabindex="-1"></a>company_brand_count <span class="op">=</span> (</span>
<span id="cb192-2"><a href="#cb192-2" aria-hidden="true" tabindex="-1"></a>    df.groupby(<span class="st">&#39;компания&#39;</span>, as_index<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb192-3"><a href="#cb192-3" aria-hidden="true" tabindex="-1"></a>    .agg({<span class="st">&#39;бренд&#39;</span>: <span class="st">&#39;nunique&#39;</span>})</span>
<span id="cb192-4"><a href="#cb192-4" aria-hidden="true" tabindex="-1"></a>    .rename(columns<span class="op">=</span>{<span class="st">&#39;бренд&#39;</span>: <span class="st">&#39;количество_брендов&#39;</span>})</span>
<span id="cb192-5"><a href="#cb192-5" aria-hidden="true" tabindex="-1"></a>    .sort_values(<span class="st">&#39;количество_брендов&#39;</span>, ascending<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb192-6"><a href="#cb192-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb192-7"><a href="#cb192-7" aria-hidden="true" tabindex="-1"></a>company_brand_count</span></code></pre></div>
<div class="output execute_result" data-execution_count="611">

  <div id="df-f6ab5aa5-bb52-40e0-8a6b-a15f62d8549d" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>компания</th>
      <th>количество_брендов</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>allur auto</td>
      <td>7</td>
    </tr>
    <tr>
      <th>23</th>
      <td>бипэк авто</td>
      <td>5</td>
    </tr>
    <tr>
      <th>29</th>
      <td>семаз</td>
      <td>4</td>
    </tr>
    <tr>
      <th>5</th>
      <td>eurasia motor premium</td>
      <td>3</td>
    </tr>
    <tr>
      <th>24</th>
      <td>вираж</td>
      <td>3</td>
    </tr>
    <tr>
      <th>9</th>
      <td>mercur auto</td>
      <td>3</td>
    </tr>
    <tr>
      <th>1</th>
      <td>almaty motors premium</td>
      <td>2</td>
    </tr>
    <tr>
      <th>30</th>
      <td>тк камаз</td>
      <td>2</td>
    </tr>
    <tr>
      <th>28</th>
      <td>свс-транс</td>
      <td>2</td>
    </tr>
    <tr>
      <th>22</th>
      <td>автоцентр-бавария</td>
      <td>2</td>
    </tr>
    <tr>
      <th>21</th>
      <td>автомир-центр</td>
      <td>2</td>
    </tr>
    <tr>
      <th>20</th>
      <td>автокапитал</td>
      <td>2</td>
    </tr>
    <tr>
      <th>17</th>
      <td>toyota motor kazakhstan</td>
      <td>2</td>
    </tr>
    <tr>
      <th>16</th>
      <td>terra motors</td>
      <td>2</td>
    </tr>
    <tr>
      <th>2</th>
      <td>astana motors</td>
      <td>2</td>
    </tr>
    <tr>
      <th>3</th>
      <td>autokapital</td>
      <td>2</td>
    </tr>
    <tr>
      <th>10</th>
      <td>nissan manufacturing rus</td>
      <td>2</td>
    </tr>
    <tr>
      <th>14</th>
      <td>scania central asia</td>
      <td>1</td>
    </tr>
    <tr>
      <th>6</th>
      <td>hino motors</td>
      <td>1</td>
    </tr>
    <tr>
      <th>4</th>
      <td>daewoo bus kazakhstan</td>
      <td>1</td>
    </tr>
    <tr>
      <th>27</th>
      <td>ммс рус</td>
      <td>1</td>
    </tr>
    <tr>
      <th>26</th>
      <td>лифан моторс рус</td>
      <td>1</td>
    </tr>
    <tr>
      <th>25</th>
      <td>каспиан моторс</td>
      <td>1</td>
    </tr>
    <tr>
      <th>7</th>
      <td>hyundai com trans kazakhstan</td>
      <td>1</td>
    </tr>
    <tr>
      <th>15</th>
      <td>subaru kazakhstan</td>
      <td>1</td>
    </tr>
    <tr>
      <th>8</th>
      <td>man truck &amp; bus kazakhstan</td>
      <td>1</td>
    </tr>
    <tr>
      <th>11</th>
      <td>ravon motors kazakstan</td>
      <td>1</td>
    </tr>
    <tr>
      <th>19</th>
      <td>автодом motors kst</td>
      <td>1</td>
    </tr>
    <tr>
      <th>18</th>
      <td>volkswagen group rus</td>
      <td>1</td>
    </tr>
    <tr>
      <th>12</th>
      <td>renault россия</td>
      <td>1</td>
    </tr>
    <tr>
      <th>13</th>
      <td>scandinavian motors</td>
      <td>1</td>
    </tr>
    <tr>
      <th>31</th>
      <td>узавто-казахстан</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-f6ab5aa5-bb52-40e0-8a6b-a15f62d8549d')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-f6ab5aa5-bb52-40e0-8a6b-a15f62d8549d button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-f6ab5aa5-bb52-40e0-8a6b-a15f62d8549d');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-c07fb07c-a128-48d6-a9ac-f9d10ef5c33c">
  <button class="colab-df-quickchart" onclick="quickchart('df-c07fb07c-a128-48d6-a9ac-f9d10ef5c33c')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-c07fb07c-a128-48d6-a9ac-f9d10ef5c33c button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>
    </div>
  </div>

</div>
</div>
<div class="cell code" data-execution_count="612"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="pS5WXQ8dpmXg" data-outputId="b138223c-f4ce-45fb-f537-76016062ed6e">
<div class="sourceCode" id="cb193"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb193-1"><a href="#cb193-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f&#39;Количество компаний, продающих один бренд:        | </span><span class="ch">\</span></span>
<span id="cb193-2"><a href="#cb193-2" aria-hidden="true" tabindex="-1"></a><span class="sc">{</span>company_brand_count [company_brand_count[<span class="st">&quot;количество_брендов&quot;</span>] <span class="op">==</span> <span class="dv">1</span>][<span class="st">&quot;компания&quot;</span>]<span class="sc">.</span>count()<span class="sc">}</span><span class="ss">&#39;</span>)</span>
<span id="cb193-3"><a href="#cb193-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f&#39;Количество компаний, продающих несколько брендов: | </span><span class="ch">\</span></span>
<span id="cb193-4"><a href="#cb193-4" aria-hidden="true" tabindex="-1"></a><span class="sc">{</span>company_brand_count[company_brand_count[<span class="st">&quot;количество_брендов&quot;</span>] <span class="op">&gt;</span> <span class="dv">1</span>][<span class="st">&quot;компания&quot;</span>]<span class="sc">.</span>count()<span class="sc">}</span><span class="ss">&#39;</span>)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Количество компаний, продающих один бренд:        | 15
Количество компаний, продающих несколько брендов: | 17
</code></pre>
</div>
</div>
<div class="cell markdown" id="ZWaimyKOqfYQ">
<p>Всего представлено 32 компании по продаже авто. Из них 15 продает
только одну марку авто, 17 - несколько. Самое большое количество
продаваемых марок у allur auto.</p>
</div>
<section id="42-количество-моделей-у-разных-марок" class="cell markdown"
id="GkHmERpirvWj">
<h2>4.2 Количество моделей у разных марок</h2>
</section>
<div class="cell code" data-execution_count="613"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="Zb6sN0cvsfY9" data-outputId="0bab0578-b248-45ff-d99a-0848413c0e4b">
<div class="sourceCode" id="cb195"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb195-1"><a href="#cb195-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f&#39;Количество марок:   | </span><span class="sc">{</span>df[<span class="st">&quot;бренд&quot;</span>]<span class="sc">.</span>nunique()<span class="sc">}</span><span class="ss">&#39;</span>)</span>
<span id="cb195-2"><a href="#cb195-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f&#39;Количество моделей: | </span><span class="sc">{</span>df[<span class="st">&quot;модель&quot;</span>]<span class="sc">.</span>nunique()<span class="sc">}</span><span class="ss">&#39;</span>)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Количество марок:   | 46
Количество моделей: | 273
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="614"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:363}"
id="qokEynBOryIn" data-outputId="9c22a0a0-1aa7-4756-e606-e0601469b189">
<div class="sourceCode" id="cb197"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb197-1"><a href="#cb197-1" aria-hidden="true" tabindex="-1"></a>brand_model_count <span class="op">=</span> (</span>
<span id="cb197-2"><a href="#cb197-2" aria-hidden="true" tabindex="-1"></a>    df.groupby(<span class="st">&#39;бренд&#39;</span>, as_index<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb197-3"><a href="#cb197-3" aria-hidden="true" tabindex="-1"></a>    .agg({<span class="st">&#39;модель&#39;</span>: <span class="st">&#39;nunique&#39;</span>})</span>
<span id="cb197-4"><a href="#cb197-4" aria-hidden="true" tabindex="-1"></a>    .rename(columns<span class="op">=</span>{<span class="st">&#39;модель&#39;</span>: <span class="st">&#39;количество_моделей&#39;</span>})</span>
<span id="cb197-5"><a href="#cb197-5" aria-hidden="true" tabindex="-1"></a>    .sort_values(<span class="st">&#39;количество_моделей&#39;</span>, ascending<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb197-6"><a href="#cb197-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb197-7"><a href="#cb197-7" aria-hidden="true" tabindex="-1"></a>brand_model_count.nlargest(<span class="dv">10</span>, <span class="st">&#39;количество_моделей&#39;</span>)</span></code></pre></div>
<div class="output execute_result" data-execution_count="614">

  <div id="df-b0287493-974e-4dcd-84cf-e0f211c3d3a6" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>бренд</th>
      <th>количество_моделей</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>18</th>
      <td>kamaz</td>
      <td>24</td>
    </tr>
    <tr>
      <th>2</th>
      <td>bmw</td>
      <td>14</td>
    </tr>
    <tr>
      <th>26</th>
      <td>mercedes-benz</td>
      <td>14</td>
    </tr>
    <tr>
      <th>42</th>
      <td>volkswagen</td>
      <td>13</td>
    </tr>
    <tr>
      <th>12</th>
      <td>hyundai truck &amp; bus</td>
      <td>10</td>
    </tr>
    <tr>
      <th>41</th>
      <td>uaz</td>
      <td>10</td>
    </tr>
    <tr>
      <th>9</th>
      <td>gaz</td>
      <td>9</td>
    </tr>
    <tr>
      <th>19</th>
      <td>kia</td>
      <td>9</td>
    </tr>
    <tr>
      <th>16</th>
      <td>jac</td>
      <td>9</td>
    </tr>
    <tr>
      <th>1</th>
      <td>audi</td>
      <td>9</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-b0287493-974e-4dcd-84cf-e0f211c3d3a6')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-b0287493-974e-4dcd-84cf-e0f211c3d3a6 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-b0287493-974e-4dcd-84cf-e0f211c3d3a6');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-96511bbb-8548-4625-a924-023df40530a5">
  <button class="colab-df-quickchart" onclick="quickchart('df-96511bbb-8548-4625-a924-023df40530a5')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-96511bbb-8548-4625-a924-023df40530a5 button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>
    </div>
  </div>

</div>
</div>
<div class="cell code" data-execution_count="615"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="Wb8DPA6nsRVE" data-outputId="2febf9db-ce75-4c98-dc2d-3c1a7f1dbfdd">
<div class="sourceCode" id="cb198"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb198-1"><a href="#cb198-1" aria-hidden="true" tabindex="-1"></a>brand_model_count.nlargest(<span class="dv">10</span>, <span class="st">&#39;количество_моделей&#39;</span>)[<span class="st">&#39;бренд&#39;</span>].unique()</span></code></pre></div>
<div class="output execute_result" data-execution_count="615">
<pre><code>array([&#39;kamaz&#39;, &#39;bmw&#39;, &#39;mercedes-benz&#39;, &#39;volkswagen&#39;,
       &#39;hyundai truck &amp; bus&#39;, &#39;uaz&#39;, &#39;gaz&#39;, &#39;kia&#39;, &#39;jac&#39;, &#39;audi&#39;],
      dtype=object)</code></pre>
</div>
</div>
<div class="cell markdown" id="r-LAb7O6r1jE">
<p>Всего представлено 46 марок авто и 273 модели.</p>
<p>Наибольшее количество различных моделей у авто марок: kamaz, bmw,
mercedes-benz, volkswagen, hyundai truck &amp; bus, uaz, gaz, kia, jac,
audi. Лидер по количеству моделей - kamaz (24 модели).</p>
</div>
<section id="43-емкость-рынка" class="cell markdown" id="PAZvBKGCKegK">
<h2>4.3 Емкость рынка</h2>
</section>
<div class="cell markdown" id="8CGF3KGbKVbL">
<p>Посчитаем емкость рынка в денежном и количественном выражении (общий,
коммерческий и некоммерческий).</p>
<p>Данные представлены до с января по сентябрь. Для подсчета прогнозного
значения за год необходимо суммировать значение за 9 месяцев с 4
кварталом, емкость которого равна 40% от суммы за 9 месяцев, так как 4
квартал является довольно прибыльным.</p>
</div>
<div class="cell code" data-execution_count="616" id="vQzL-TVFMk97">
<div class="sourceCode" id="cb200"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb200-1"><a href="#cb200-1" aria-hidden="true" tabindex="-1"></a><span class="co"># столбец количество в int</span></span>
<span id="cb200-2"><a href="#cb200-2" aria-hidden="true" tabindex="-1"></a>df[<span class="st">&#39;количество&#39;</span>] <span class="op">=</span> df[<span class="st">&#39;количество&#39;</span>].astype(<span class="st">&#39;int&#39;</span>)</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="617" id="NLoO58oaMQao">
<div class="sourceCode" id="cb201"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb201-1"><a href="#cb201-1" aria-hidden="true" tabindex="-1"></a><span class="co"># емкость рынка в долларах</span></span>
<span id="cb201-2"><a href="#cb201-2" aria-hidden="true" tabindex="-1"></a>market_dol <span class="op">=</span> <span class="bu">round</span>(df[<span class="st">&quot;продажа_usd&quot;</span>].<span class="bu">sum</span>(), <span class="dv">2</span>)</span>
<span id="cb201-3"><a href="#cb201-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb201-4"><a href="#cb201-4" aria-hidden="true" tabindex="-1"></a><span class="co"># емкость рынка в долларах некоммерческого транспорта</span></span>
<span id="cb201-5"><a href="#cb201-5" aria-hidden="true" tabindex="-1"></a>market_uncom_dol <span class="op">=</span> <span class="bu">round</span>(</span>
<span id="cb201-6"><a href="#cb201-6" aria-hidden="true" tabindex="-1"></a>    df[df[<span class="st">&#39;сегментация_2013&#39;</span>] <span class="op">!=</span> <span class="st">&#39;коммерческие автомобили&#39;</span>][<span class="st">&quot;продажа_usd&quot;</span>]</span>
<span id="cb201-7"><a href="#cb201-7" aria-hidden="true" tabindex="-1"></a>    .<span class="bu">sum</span>(),</span>
<span id="cb201-8"><a href="#cb201-8" aria-hidden="true" tabindex="-1"></a>    <span class="dv">2</span></span>
<span id="cb201-9"><a href="#cb201-9" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb201-10"><a href="#cb201-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb201-11"><a href="#cb201-11" aria-hidden="true" tabindex="-1"></a><span class="co"># емкость рынка в долларах коммерческого транспорта</span></span>
<span id="cb201-12"><a href="#cb201-12" aria-hidden="true" tabindex="-1"></a>market_com_dol <span class="op">=</span> <span class="bu">round</span>(</span>
<span id="cb201-13"><a href="#cb201-13" aria-hidden="true" tabindex="-1"></a>    df[df[<span class="st">&#39;сегментация_2013&#39;</span>] <span class="op">==</span> <span class="st">&#39;коммерческие автомобили&#39;</span>][<span class="st">&quot;продажа_usd&quot;</span>]</span>
<span id="cb201-14"><a href="#cb201-14" aria-hidden="true" tabindex="-1"></a>    .<span class="bu">sum</span>(),</span>
<span id="cb201-15"><a href="#cb201-15" aria-hidden="true" tabindex="-1"></a>    <span class="dv">2</span></span>
<span id="cb201-16"><a href="#cb201-16" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb201-17"><a href="#cb201-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb201-18"><a href="#cb201-18" aria-hidden="true" tabindex="-1"></a><span class="co"># емкость рынка в количестве проданных авто</span></span>
<span id="cb201-19"><a href="#cb201-19" aria-hidden="true" tabindex="-1"></a>market_quantity <span class="op">=</span> df[<span class="st">&quot;количество&quot;</span>].<span class="bu">sum</span>()</span>
<span id="cb201-20"><a href="#cb201-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb201-21"><a href="#cb201-21" aria-hidden="true" tabindex="-1"></a><span class="co"># емкость рынка в количестве проданного некоммерческого авто</span></span>
<span id="cb201-22"><a href="#cb201-22" aria-hidden="true" tabindex="-1"></a>market__uncom_quantity <span class="op">=</span> (</span>
<span id="cb201-23"><a href="#cb201-23" aria-hidden="true" tabindex="-1"></a>    df[df[<span class="st">&#39;сегментация_2013&#39;</span>] <span class="op">!=</span> <span class="st">&#39;коммерческие автомобили&#39;</span>][<span class="st">&quot;количество&quot;</span>].<span class="bu">sum</span>()</span>
<span id="cb201-24"><a href="#cb201-24" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb201-25"><a href="#cb201-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb201-26"><a href="#cb201-26" aria-hidden="true" tabindex="-1"></a><span class="co"># емкость рынка в количестве проданного коммерческого авто</span></span>
<span id="cb201-27"><a href="#cb201-27" aria-hidden="true" tabindex="-1"></a>market_com_quantity <span class="op">=</span> (</span>
<span id="cb201-28"><a href="#cb201-28" aria-hidden="true" tabindex="-1"></a>    df[df[<span class="st">&#39;сегментация_2013&#39;</span>] <span class="op">==</span> <span class="st">&#39;коммерческие автомобили&#39;</span>][<span class="st">&quot;количество&quot;</span>].<span class="bu">sum</span>()</span>
<span id="cb201-29"><a href="#cb201-29" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="618"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:237}"
id="00EGFuepOSZy" data-outputId="549c6828-f9d1-4347-d07a-632d9634fe62">
<div class="sourceCode" id="cb202"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb202-1"><a href="#cb202-1" aria-hidden="true" tabindex="-1"></a><span class="co"># занесем данные в таблицу</span></span>
<span id="cb202-2"><a href="#cb202-2" aria-hidden="true" tabindex="-1"></a>market_value <span class="op">=</span> pd.DataFrame(data<span class="op">=</span>{<span class="st">&#39;9 мес&#39;</span>: [market_dol,</span>
<span id="cb202-3"><a href="#cb202-3" aria-hidden="true" tabindex="-1"></a>                                            market_uncom_dol,</span>
<span id="cb202-4"><a href="#cb202-4" aria-hidden="true" tabindex="-1"></a>                                            market_com_dol,</span>
<span id="cb202-5"><a href="#cb202-5" aria-hidden="true" tabindex="-1"></a>                                            <span class="bu">round</span>(market_quantity),</span>
<span id="cb202-6"><a href="#cb202-6" aria-hidden="true" tabindex="-1"></a>                                            <span class="bu">round</span>(market__uncom_quantity),</span>
<span id="cb202-7"><a href="#cb202-7" aria-hidden="true" tabindex="-1"></a>                                            <span class="bu">round</span>(market_com_quantity)],</span>
<span id="cb202-8"><a href="#cb202-8" aria-hidden="true" tabindex="-1"></a>                                  <span class="st">&#39;Год (прогноз)&#39;</span>: [market_dol <span class="op">*</span> <span class="fl">1.4</span>,</span>
<span id="cb202-9"><a href="#cb202-9" aria-hidden="true" tabindex="-1"></a>                                                    market_uncom_dol <span class="op">*</span> <span class="fl">1.4</span>,</span>
<span id="cb202-10"><a href="#cb202-10" aria-hidden="true" tabindex="-1"></a>                                                    market_com_dol <span class="op">*</span> <span class="fl">1.4</span>,</span>
<span id="cb202-11"><a href="#cb202-11" aria-hidden="true" tabindex="-1"></a>                                                    <span class="bu">round</span>(market_quantity <span class="op">*</span> <span class="fl">1.4</span>),</span>
<span id="cb202-12"><a href="#cb202-12" aria-hidden="true" tabindex="-1"></a>                                                    <span class="bu">round</span>(market__uncom_quantity <span class="op">*</span> <span class="fl">1.4</span>),</span>
<span id="cb202-13"><a href="#cb202-13" aria-hidden="true" tabindex="-1"></a>                                                    <span class="bu">round</span>(market_com_quantity <span class="op">*</span> <span class="fl">1.4</span>)]},</span>
<span id="cb202-14"><a href="#cb202-14" aria-hidden="true" tabindex="-1"></a>                            index<span class="op">=</span>[<span class="st">&#39;Общая емкость рынка, $&#39;</span>,</span>
<span id="cb202-15"><a href="#cb202-15" aria-hidden="true" tabindex="-1"></a>                                   <span class="st">&#39;Емкость рынка некоммерческого транспорта, $&#39;</span>,</span>
<span id="cb202-16"><a href="#cb202-16" aria-hidden="true" tabindex="-1"></a>                                   <span class="st">&#39;Емкость рынка коммерческого транспорта, $&#39;</span>,</span>
<span id="cb202-17"><a href="#cb202-17" aria-hidden="true" tabindex="-1"></a>                                   <span class="st">&#39;Общая емкость рынка, шт.&#39;</span>,</span>
<span id="cb202-18"><a href="#cb202-18" aria-hidden="true" tabindex="-1"></a>                                   <span class="st">&#39;Емкость рынка некоммерческого транспорта, шт.&#39;</span>,</span>
<span id="cb202-19"><a href="#cb202-19" aria-hidden="true" tabindex="-1"></a>                                   <span class="st">&#39;Емкость рынка коммерческого транспорта, шт.&#39;</span>]</span>
<span id="cb202-20"><a href="#cb202-20" aria-hidden="true" tabindex="-1"></a>             ).reset_index().rename(columns<span class="op">=</span>{<span class="st">&#39;index&#39;</span>: <span class="st">&#39;Значение&#39;</span>})</span>
<span id="cb202-21"><a href="#cb202-21" aria-hidden="true" tabindex="-1"></a>market_value</span></code></pre></div>
<div class="output execute_result" data-execution_count="618">

  <div id="df-1ef912b8-17f8-43f1-a3bb-3f70fcc1e3df" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Значение</th>
      <th>9 мес</th>
      <th>Год (прогноз)</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Общая емкость рынка, $</td>
      <td>1349194556.31</td>
      <td>1888872378.83</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Емкость рынка некоммерческого транспорта, $</td>
      <td>1163382622.05</td>
      <td>1628735670.87</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Емкость рынка коммерческого транспорта, $</td>
      <td>185811934.25</td>
      <td>260136707.95</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Общая емкость рынка, шт.</td>
      <td>53875.00</td>
      <td>75425.00</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Емкость рынка некоммерческого транспорта, шт.</td>
      <td>48629.00</td>
      <td>68081.00</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Емкость рынка коммерческого транспорта, шт.</td>
      <td>5246.00</td>
      <td>7344.00</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-1ef912b8-17f8-43f1-a3bb-3f70fcc1e3df')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-1ef912b8-17f8-43f1-a3bb-3f70fcc1e3df button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-1ef912b8-17f8-43f1-a3bb-3f70fcc1e3df');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-6f8e1aa9-4f12-4dc0-bc5b-46a315e7aed7">
  <button class="colab-df-quickchart" onclick="quickchart('df-6f8e1aa9-4f12-4dc0-bc5b-46a315e7aed7')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-6f8e1aa9-4f12-4dc0-bc5b-46a315e7aed7 button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>
    </div>
  </div>

</div>
</div>
<div class="cell markdown" id="td1btemGPfyt">
<p>Объем рынка некоммерческого транспорта больше коммерческого как в
денежном, так и в количественном значении. Больше покупают автомобили
для личного пользования.</p>
<p>Рассмотрим динамику объема рынка авто за 9 мес.</p>
</div>
<section id="44-динамика-рынка" class="cell markdown" id="G10PdzJBp2x6">
<h2>4.4 Динамика рынка</h2>
</section>
<section id="441-общая" class="cell markdown" id="Pk--6Vucp8v9">
<h3>4.4.1 Общая</h3>
</section>
<div class="cell code" data-execution_count="619"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:331}"
id="m1OI29IudLuk" data-outputId="84284e31-b17d-4f0b-ea38-24940e35ece9">
<div class="sourceCode" id="cb203"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb203-1"><a href="#cb203-1" aria-hidden="true" tabindex="-1"></a><span class="co"># создадим сводную таблицу</span></span>
<span id="cb203-2"><a href="#cb203-2" aria-hidden="true" tabindex="-1"></a>market_dynamic <span class="op">=</span> (</span>
<span id="cb203-3"><a href="#cb203-3" aria-hidden="true" tabindex="-1"></a>    df.groupby(<span class="st">&#39;дата&#39;</span>, as_index<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb203-4"><a href="#cb203-4" aria-hidden="true" tabindex="-1"></a>    .agg({<span class="st">&#39;продажа_usd&#39;</span>: <span class="st">&#39;sum&#39;</span>,</span>
<span id="cb203-5"><a href="#cb203-5" aria-hidden="true" tabindex="-1"></a>          <span class="st">&#39;количество&#39;</span>: <span class="st">&#39;sum&#39;</span>})</span>
<span id="cb203-6"><a href="#cb203-6" aria-hidden="true" tabindex="-1"></a>    .rename(columns<span class="op">=</span>{<span class="st">&#39;продажа_usd&#39;</span>: <span class="st">&#39;объем, тыс. $&#39;</span>,</span>
<span id="cb203-7"><a href="#cb203-7" aria-hidden="true" tabindex="-1"></a>                     <span class="st">&#39;количество&#39;</span>: <span class="st">&#39;количество, шт.&#39;</span>})</span>
<span id="cb203-8"><a href="#cb203-8" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb203-9"><a href="#cb203-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb203-10"><a href="#cb203-10" aria-hidden="true" tabindex="-1"></a><span class="co"># переведем продажи в тысячи</span></span>
<span id="cb203-11"><a href="#cb203-11" aria-hidden="true" tabindex="-1"></a>market_dynamic[<span class="st">&#39;объем, тыс. $&#39;</span>] <span class="op">=</span> market_dynamic[<span class="st">&#39;объем, тыс. $&#39;</span>] <span class="op">/</span> <span class="dv">1000</span></span>
<span id="cb203-12"><a href="#cb203-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb203-13"><a href="#cb203-13" aria-hidden="true" tabindex="-1"></a>market_dynamic</span></code></pre></div>
<div class="output execute_result" data-execution_count="619">

  <div id="df-1b1c7c5f-0bba-42bb-934b-0ee8de5a3ec7" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>дата</th>
      <th>объем, тыс. $</th>
      <th>количество, шт.</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2019-01-01</td>
      <td>113868.00</td>
      <td>4517</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2019-02-01</td>
      <td>110346.69</td>
      <td>4493</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2019-03-01</td>
      <td>128066.97</td>
      <td>5055</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2019-04-01</td>
      <td>146099.54</td>
      <td>5868</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2019-05-01</td>
      <td>164125.51</td>
      <td>6438</td>
    </tr>
    <tr>
      <th>5</th>
      <td>2019-06-01</td>
      <td>162764.05</td>
      <td>6459</td>
    </tr>
    <tr>
      <th>6</th>
      <td>2019-07-01</td>
      <td>203179.86</td>
      <td>7778</td>
    </tr>
    <tr>
      <th>7</th>
      <td>2019-08-01</td>
      <td>158222.44</td>
      <td>6626</td>
    </tr>
    <tr>
      <th>8</th>
      <td>2019-09-01</td>
      <td>162521.49</td>
      <td>6641</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-1b1c7c5f-0bba-42bb-934b-0ee8de5a3ec7')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-1b1c7c5f-0bba-42bb-934b-0ee8de5a3ec7 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-1b1c7c5f-0bba-42bb-934b-0ee8de5a3ec7');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-df7bf42e-31b9-465f-a6a4-c7807f27a2c7">
  <button class="colab-df-quickchart" onclick="quickchart('df-df7bf42e-31b9-465f-a6a4-c7807f27a2c7')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-df7bf42e-31b9-465f-a6a4-c7807f27a2c7 button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>
    </div>
  </div>

</div>
</div>
<div class="cell code" data-execution_count="620"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:595}"
id="BKOEG2V2Utpf" data-outputId="361f0263-77c5-4124-e969-ced7dc116f25">
<div class="sourceCode" id="cb204"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb204-1"><a href="#cb204-1" aria-hidden="true" tabindex="-1"></a><span class="co"># построим линейный график</span></span>
<span id="cb204-2"><a href="#cb204-2" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">15</span>, <span class="dv">6</span>))</span>
<span id="cb204-3"><a href="#cb204-3" aria-hidden="true" tabindex="-1"></a>sns.lineplot(data<span class="op">=</span>market_dynamic,</span>
<span id="cb204-4"><a href="#cb204-4" aria-hidden="true" tabindex="-1"></a>             x<span class="op">=</span><span class="st">&#39;дата&#39;</span>,</span>
<span id="cb204-5"><a href="#cb204-5" aria-hidden="true" tabindex="-1"></a>             y<span class="op">=</span><span class="st">&#39;объем, тыс. $&#39;</span>,</span>
<span id="cb204-6"><a href="#cb204-6" aria-hidden="true" tabindex="-1"></a>             marker<span class="op">=</span><span class="st">&#39;s&#39;</span>)</span>
<span id="cb204-7"><a href="#cb204-7" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">&#39;Динамика объема рынка, тыс.$&#39;</span>)</span>
<span id="cb204-8"><a href="#cb204-8" aria-hidden="true" tabindex="-1"></a>plt.xticks(rotation<span class="op">=</span><span class="dv">45</span>)<span class="op">;</span></span></code></pre></div>
<div class="output display_data">
<p><img
src="vertopal_9b40e0aaef914c45a9852524805a792d/9fe544654e3c69cbab9b7016b5a9c5f7d42073a6.png" /></p>
</div>
</div>
<div class="cell markdown" id="XWCx_g0AZR3K">
<p>С января на февраль произошла небольшая просадка, за которой пошел
стремительный рост вплость до мая. С мая на июнь значение снизилось, но
далье пошел бурный рост в июле и спад в августе. С июля на сентябрь
значение слегка увеличилось.</p>
<p>Можно сделать вывод, что самый активный сезон продажи это весна и
июль.</p>
</div>
<section id="442-по-сегментам" class="cell markdown" id="4f6CFwpDqEKy">
<h3>4.4.2 По сегментам</h3>
</section>
<div class="cell code" data-execution_count="621"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:363}"
id="CdFdSVqjqIGW" data-outputId="8547d2b0-6a71-44f6-e7bd-780ae103d243">
<div class="sourceCode" id="cb205"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb205-1"><a href="#cb205-1" aria-hidden="true" tabindex="-1"></a><span class="co"># построим сводную таблицу по сегментам и дате</span></span>
<span id="cb205-2"><a href="#cb205-2" aria-hidden="true" tabindex="-1"></a>segment_market_dynamic <span class="op">=</span> (</span>
<span id="cb205-3"><a href="#cb205-3" aria-hidden="true" tabindex="-1"></a>    df.groupby([<span class="st">&#39;сегментация_2013&#39;</span>, <span class="st">&#39;дата&#39;</span>], as_index<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb205-4"><a href="#cb205-4" aria-hidden="true" tabindex="-1"></a>    .agg({<span class="st">&#39;продажа_usd&#39;</span>: <span class="st">&#39;sum&#39;</span>})</span>
<span id="cb205-5"><a href="#cb205-5" aria-hidden="true" tabindex="-1"></a>    .rename(columns<span class="op">=</span>{<span class="st">&#39;продажа_usd&#39;</span>: <span class="st">&#39;Продажи, тыс.$&#39;</span>})</span>
<span id="cb205-6"><a href="#cb205-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb205-7"><a href="#cb205-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb205-8"><a href="#cb205-8" aria-hidden="true" tabindex="-1"></a><span class="co"># переведем продажи в тысячи</span></span>
<span id="cb205-9"><a href="#cb205-9" aria-hidden="true" tabindex="-1"></a>segment_market_dynamic[<span class="st">&#39;Продажи, тыс.$&#39;</span>] <span class="op">=</span> (</span>
<span id="cb205-10"><a href="#cb205-10" aria-hidden="true" tabindex="-1"></a>    segment_market_dynamic[<span class="st">&#39;Продажи, тыс.$&#39;</span>] <span class="op">/</span> <span class="dv">1000</span></span>
<span id="cb205-11"><a href="#cb205-11" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb205-12"><a href="#cb205-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb205-13"><a href="#cb205-13" aria-hidden="true" tabindex="-1"></a>segment_market_dynamic.head(<span class="dv">10</span>)</span></code></pre></div>
<div class="output execute_result" data-execution_count="621">

  <div id="df-5c498fe0-c2bf-4117-9900-63ea1cc75676" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>сегментация_2013</th>
      <th>дата</th>
      <th>Продажи, тыс.$</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>внедорожники</td>
      <td>2019-01-01</td>
      <td>58907.18</td>
    </tr>
    <tr>
      <th>1</th>
      <td>внедорожники</td>
      <td>2019-02-01</td>
      <td>61831.74</td>
    </tr>
    <tr>
      <th>2</th>
      <td>внедорожники</td>
      <td>2019-03-01</td>
      <td>58112.34</td>
    </tr>
    <tr>
      <th>3</th>
      <td>внедорожники</td>
      <td>2019-04-01</td>
      <td>79619.59</td>
    </tr>
    <tr>
      <th>4</th>
      <td>внедорожники</td>
      <td>2019-05-01</td>
      <td>78252.47</td>
    </tr>
    <tr>
      <th>5</th>
      <td>внедорожники</td>
      <td>2019-06-01</td>
      <td>84311.81</td>
    </tr>
    <tr>
      <th>6</th>
      <td>внедорожники</td>
      <td>2019-07-01</td>
      <td>88977.96</td>
    </tr>
    <tr>
      <th>7</th>
      <td>внедорожники</td>
      <td>2019-08-01</td>
      <td>77331.58</td>
    </tr>
    <tr>
      <th>8</th>
      <td>внедорожники</td>
      <td>2019-09-01</td>
      <td>76646.46</td>
    </tr>
    <tr>
      <th>9</th>
      <td>коммерческие автомобили</td>
      <td>2019-01-01</td>
      <td>10461.06</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-5c498fe0-c2bf-4117-9900-63ea1cc75676')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-5c498fe0-c2bf-4117-9900-63ea1cc75676 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-5c498fe0-c2bf-4117-9900-63ea1cc75676');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-e6ce0e73-460b-4d10-b829-17ecd4e582d2">
  <button class="colab-df-quickchart" onclick="quickchart('df-e6ce0e73-460b-4d10-b829-17ecd4e582d2')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-e6ce0e73-460b-4d10-b829-17ecd4e582d2 button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>
    </div>
  </div>

</div>
</div>
<div class="cell code" data-execution_count="622"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:806}"
id="okH3Fo50rdM_" data-outputId="c2a477bf-ab01-4d6a-da34-9c723bd11832">
<div class="sourceCode" id="cb206"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb206-1"><a href="#cb206-1" aria-hidden="true" tabindex="-1"></a><span class="co"># создадим сетку графиков</span></span>
<span id="cb206-2"><a href="#cb206-2" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(<span class="bu">int</span>(np.ceil(</span>
<span id="cb206-3"><a href="#cb206-3" aria-hidden="true" tabindex="-1"></a>    <span class="bu">len</span>(segment_market_dynamic[<span class="st">&#39;сегментация_2013&#39;</span>].unique()) <span class="op">/</span> <span class="dv">2</span></span>
<span id="cb206-4"><a href="#cb206-4" aria-hidden="true" tabindex="-1"></a>    )),</span>
<span id="cb206-5"><a href="#cb206-5" aria-hidden="true" tabindex="-1"></a>                       <span class="dv">2</span>,</span>
<span id="cb206-6"><a href="#cb206-6" aria-hidden="true" tabindex="-1"></a>                       sharex<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb206-7"><a href="#cb206-7" aria-hidden="true" tabindex="-1"></a>                       figsize<span class="op">=</span>(<span class="dv">15</span>, <span class="dv">8</span>))</span>
<span id="cb206-8"><a href="#cb206-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb206-9"><a href="#cb206-9" aria-hidden="true" tabindex="-1"></a><span class="co"># приведем переменную ax к одномерному массиву для удобства</span></span>
<span id="cb206-10"><a href="#cb206-10" aria-hidden="true" tabindex="-1"></a>ax<span class="op">=</span>ax.flatten()</span>
<span id="cb206-11"><a href="#cb206-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb206-12"><a href="#cb206-12" aria-hidden="true" tabindex="-1"></a><span class="co"># установим общее название для всех графиков</span></span>
<span id="cb206-13"><a href="#cb206-13" aria-hidden="true" tabindex="-1"></a>plt.suptitle(<span class="st">&#39;Динамика рынка по сегментам&#39;</span>)</span>
<span id="cb206-14"><a href="#cb206-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb206-15"><a href="#cb206-15" aria-hidden="true" tabindex="-1"></a><span class="co"># построим линейный график для каждого сегмента</span></span>
<span id="cb206-16"><a href="#cb206-16" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i, segment <span class="kw">in</span> <span class="bu">enumerate</span>(segment_market_dynamic[<span class="st">&#39;сегментация_2013&#39;</span>].unique()):</span>
<span id="cb206-17"><a href="#cb206-17" aria-hidden="true" tabindex="-1"></a>  sns.lineplot(segment_market_dynamic.query(<span class="st">&#39;сегментация_2013 == @segment&#39;</span>),</span>
<span id="cb206-18"><a href="#cb206-18" aria-hidden="true" tabindex="-1"></a>                x<span class="op">=</span><span class="st">&#39;дата&#39;</span>,</span>
<span id="cb206-19"><a href="#cb206-19" aria-hidden="true" tabindex="-1"></a>                y<span class="op">=</span><span class="st">&#39;Продажи, тыс.$&#39;</span>,</span>
<span id="cb206-20"><a href="#cb206-20" aria-hidden="true" tabindex="-1"></a>               marker<span class="op">=</span><span class="st">&#39;s&#39;</span>,</span>
<span id="cb206-21"><a href="#cb206-21" aria-hidden="true" tabindex="-1"></a>                ax<span class="op">=</span>ax[i])</span>
<span id="cb206-22"><a href="#cb206-22" aria-hidden="true" tabindex="-1"></a>  ax[i].<span class="bu">set</span>(title<span class="op">=</span>segment,</span>
<span id="cb206-23"><a href="#cb206-23" aria-hidden="true" tabindex="-1"></a>            xlabel<span class="op">=</span><span class="st">&#39;Дата&#39;</span>)</span>
<span id="cb206-24"><a href="#cb206-24" aria-hidden="true" tabindex="-1"></a>  ax[i].tick_params(axis<span class="op">=</span><span class="st">&#39;x&#39;</span>, rotation<span class="op">=</span><span class="dv">45</span>)</span>
<span id="cb206-25"><a href="#cb206-25" aria-hidden="true" tabindex="-1"></a>  plt.tight_layout()</span>
<span id="cb206-26"><a href="#cb206-26" aria-hidden="true" tabindex="-1"></a>  plt.xlabel(<span class="st">&#39;Дата&#39;</span>)</span>
<span id="cb206-27"><a href="#cb206-27" aria-hidden="true" tabindex="-1"></a>  plt.xticks(rotation<span class="op">=</span><span class="dv">45</span>)</span>
<span id="cb206-28"><a href="#cb206-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb206-29"><a href="#cb206-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb206-30"><a href="#cb206-30" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<div class="output display_data">
<p><img
src="vertopal_9b40e0aaef914c45a9852524805a792d/e2018ebb638ed7e3db73556e3c44774687bcf9d9.png" /></p>
</div>
</div>
<div class="cell markdown" id="yzvijuRGumU5">
<p>Динамика рынка продаж внедорожников показывает резкий скачок вверх с
марта на апрель, далее небольшой спад в мае и рост вплоть до июля.
Возможно это связано с сезонностью, желанием людей проводить активный
отдых, устраивать поездки на свежий воздух.</p>
<p>Продажи коммерческих автомобилей претерпевают подъемы и спады на
протяжении всего периода. Самый сильный подъем и затем спад наблюдается
в июле.</p>
<p>Продажи легковых автомобилей в основном растут, за исключением спада
в феврале и августе. Легковой автомобиль является самым популярным для
покупателей. К тому же часто покупателями становятся фирмы такси,
которые приобретают сразу несколько авто.</p>
<p>У минивэнов наблюдается рост с февраля по апрель. Затем спад до июля,
подъем в августе и спад и сентябре.</p>
<p>Пикапы на рынке растут в продажах с января по февраль, затем спад до
марта. С марта происходит высокий рост вплоть до мая и достигает пика,
затем идет спад до июля, небольшой рост до августа и спад до сентября.
Рост весной может быть связан с покупкой авто для дачи, рыбалки, охоты и
других хобби, которые требуют перевозки большого количества инструментов
с собой.</p>
</div>
<section id="45-марки-лидеры-на-рынке" class="cell markdown"
id="J0x89ik_fbUy">
<h2>4.5 Марки лидеры на рынке</h2>
</section>
<div class="cell code" data-execution_count="623" id="DsiTJVWXhBOY">
<div class="sourceCode" id="cb207"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb207-1"><a href="#cb207-1" aria-hidden="true" tabindex="-1"></a><span class="co"># создадим датафреймы с коммерческим и некоммерческим транспортом</span></span>
<span id="cb207-2"><a href="#cb207-2" aria-hidden="true" tabindex="-1"></a>com_df <span class="op">=</span> df.query(<span class="st">&#39;сегментация_2013 == &quot;коммерческие автомобили&quot;&#39;</span>)</span>
<span id="cb207-3"><a href="#cb207-3" aria-hidden="true" tabindex="-1"></a>uncom_df <span class="op">=</span> df.query(<span class="st">&#39;сегментация_2013 != &quot;коммерческие автомобили&quot;&#39;</span>)</span></code></pre></div>
</div>
<div class="cell markdown" id="4BH5fQPXfoHp">
<p>Рассмотрим ТОП-10 марок лидеров на рынке автомобилей. Построим
сводные таблицы марок и объема продаж на рынке в денежном и
количественном значении.</p>
<p>Для удобства создадим функцию по сравнению продаж на рынке в тыс.$ и
шт. для различных категорий.</p>
</div>
<div class="cell code" data-execution_count="624" id="iHGjFbJA41Y-">
<div class="sourceCode" id="cb208"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb208-1"><a href="#cb208-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> compare_usd_quantity(df, col_group, agg_func, top<span class="op">=</span><span class="va">True</span>):</span>
<span id="cb208-2"><a href="#cb208-2" aria-hidden="true" tabindex="-1"></a>  <span class="co">&#39;&#39;&#39;</span></span>
<span id="cb208-3"><a href="#cb208-3" aria-hidden="true" tabindex="-1"></a><span class="co">  Функция на вход принимает датафрейм, колонку для группировки,</span></span>
<span id="cb208-4"><a href="#cb208-4" aria-hidden="true" tabindex="-1"></a><span class="co">  агрегирующую функцию и необходимость выведения ТОПа.</span></span>
<span id="cb208-5"><a href="#cb208-5" aria-hidden="true" tabindex="-1"></a><span class="co">  На выходе получаем 2 сгруппированные таблицы, отсортированные по убыванию.</span></span>
<span id="cb208-6"><a href="#cb208-6" aria-hidden="true" tabindex="-1"></a><span class="co">  &#39;&#39;&#39;</span></span>
<span id="cb208-7"><a href="#cb208-7" aria-hidden="true" tabindex="-1"></a>  <span class="co"># создаем сводную таблицу по продажам в $</span></span>
<span id="cb208-8"><a href="#cb208-8" aria-hidden="true" tabindex="-1"></a>  df1_group <span class="op">=</span> (</span>
<span id="cb208-9"><a href="#cb208-9" aria-hidden="true" tabindex="-1"></a>    df.groupby(col_group).agg({<span class="st">&#39;продажа_usd&#39;</span>: agg_func})</span>
<span id="cb208-10"><a href="#cb208-10" aria-hidden="true" tabindex="-1"></a>    .sort_values(by<span class="op">=</span><span class="st">&#39;продажа_usd&#39;</span>, ascending<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb208-11"><a href="#cb208-11" aria-hidden="true" tabindex="-1"></a>    .reset_index()</span>
<span id="cb208-12"><a href="#cb208-12" aria-hidden="true" tabindex="-1"></a>    .rename(columns<span class="op">=</span>{<span class="st">&#39;продажа_usd&#39;</span>: <span class="st">&#39;Продажи, тыс.$&#39;</span>})</span>
<span id="cb208-13"><a href="#cb208-13" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb208-14"><a href="#cb208-14" aria-hidden="true" tabindex="-1"></a>  <span class="co"># переводим продажи в тысячи</span></span>
<span id="cb208-15"><a href="#cb208-15" aria-hidden="true" tabindex="-1"></a>  df1_group[<span class="st">&#39;Продажи, тыс.$&#39;</span>] <span class="op">=</span> <span class="bu">round</span>(df1_group[<span class="st">&#39;Продажи, тыс.$&#39;</span>] <span class="op">/</span> <span class="dv">1000</span>, <span class="dv">2</span>)</span>
<span id="cb208-16"><a href="#cb208-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-17"><a href="#cb208-17" aria-hidden="true" tabindex="-1"></a>  <span class="co"># создаем сводную таблицу по продажам в шт.</span></span>
<span id="cb208-18"><a href="#cb208-18" aria-hidden="true" tabindex="-1"></a>  df2_group <span class="op">=</span> (</span>
<span id="cb208-19"><a href="#cb208-19" aria-hidden="true" tabindex="-1"></a>      df.groupby(col_group).agg({<span class="st">&#39;количество&#39;</span>: agg_func})</span>
<span id="cb208-20"><a href="#cb208-20" aria-hidden="true" tabindex="-1"></a>      .sort_values(by<span class="op">=</span><span class="st">&#39;количество&#39;</span>, ascending<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb208-21"><a href="#cb208-21" aria-hidden="true" tabindex="-1"></a>      .reset_index()</span>
<span id="cb208-22"><a href="#cb208-22" aria-hidden="true" tabindex="-1"></a>      .rename(columns<span class="op">=</span>{<span class="st">&#39;количество&#39;</span>: <span class="st">&#39;Продажи, шт.&#39;</span>})</span>
<span id="cb208-23"><a href="#cb208-23" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb208-24"><a href="#cb208-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-25"><a href="#cb208-25" aria-hidden="true" tabindex="-1"></a>  <span class="co"># если нужно создать ТОП из лидеров берем первые 10 значений</span></span>
<span id="cb208-26"><a href="#cb208-26" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> top:</span>
<span id="cb208-27"><a href="#cb208-27" aria-hidden="true" tabindex="-1"></a>    df1_group <span class="op">=</span> df1_group.head(<span class="dv">10</span>)</span>
<span id="cb208-28"><a href="#cb208-28" aria-hidden="true" tabindex="-1"></a>    df2_group <span class="op">=</span> df2_group.head(<span class="dv">10</span>)</span>
<span id="cb208-29"><a href="#cb208-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-30"><a href="#cb208-30" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> df1_group, df2_group</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="625" id="qyBizPkYAhNd">
<div class="sourceCode" id="cb209"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb209-1"><a href="#cb209-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> barplot(df1, df2, first_count, title):</span>
<span id="cb209-2"><a href="#cb209-2" aria-hidden="true" tabindex="-1"></a>  <span class="co">&#39;&#39;&#39;</span></span>
<span id="cb209-3"><a href="#cb209-3" aria-hidden="true" tabindex="-1"></a><span class="co">  Функция на вход принимает 2 сгруппированные таблицы, количество</span></span>
<span id="cb209-4"><a href="#cb209-4" aria-hidden="true" tabindex="-1"></a><span class="co">  выделяемых лидеров и общий заголовок.</span></span>
<span id="cb209-5"><a href="#cb209-5" aria-hidden="true" tabindex="-1"></a><span class="co">  На выходе получаем 2 графика barplot.</span></span>
<span id="cb209-6"><a href="#cb209-6" aria-hidden="true" tabindex="-1"></a><span class="co">  &#39;&#39;&#39;</span></span>
<span id="cb209-7"><a href="#cb209-7" aria-hidden="true" tabindex="-1"></a>  <span class="co"># создаем список цветов для каждого элемента таблицы</span></span>
<span id="cb209-8"><a href="#cb209-8" aria-hidden="true" tabindex="-1"></a>  colors <span class="op">=</span> [<span class="st">&#39;lightgray&#39;</span>] <span class="op">*</span> df1.shape[<span class="dv">0</span>]</span>
<span id="cb209-9"><a href="#cb209-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-10"><a href="#cb209-10" aria-hidden="true" tabindex="-1"></a>  <span class="co"># создаем выделение лидеров на графике в размере first_count</span></span>
<span id="cb209-11"><a href="#cb209-11" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(first_count):</span>
<span id="cb209-12"><a href="#cb209-12" aria-hidden="true" tabindex="-1"></a>    colors[i] <span class="op">=</span> <span class="st">&#39;#051094&#39;</span></span>
<span id="cb209-13"><a href="#cb209-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-14"><a href="#cb209-14" aria-hidden="true" tabindex="-1"></a>  <span class="co"># строим сетку графиков, задаем размер</span></span>
<span id="cb209-15"><a href="#cb209-15" aria-hidden="true" tabindex="-1"></a>  fig, (ax1, ax2) <span class="op">=</span> plt.subplots(<span class="dv">1</span>, <span class="dv">2</span>, figsize<span class="op">=</span>(<span class="dv">15</span>, <span class="dv">6</span>))</span>
<span id="cb209-16"><a href="#cb209-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-17"><a href="#cb209-17" aria-hidden="true" tabindex="-1"></a>  <span class="co"># устанавливаем общее название графиков</span></span>
<span id="cb209-18"><a href="#cb209-18" aria-hidden="true" tabindex="-1"></a>  plt.suptitle(title)</span>
<span id="cb209-19"><a href="#cb209-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-20"><a href="#cb209-20" aria-hidden="true" tabindex="-1"></a>  <span class="co"># построим столбчатую диаграмму по продажам в тыс.$</span></span>
<span id="cb209-21"><a href="#cb209-21" aria-hidden="true" tabindex="-1"></a>  sns.barplot(df1,</span>
<span id="cb209-22"><a href="#cb209-22" aria-hidden="true" tabindex="-1"></a>              x<span class="op">=</span>df1.iloc[:, <span class="dv">1</span>],</span>
<span id="cb209-23"><a href="#cb209-23" aria-hidden="true" tabindex="-1"></a>              y<span class="op">=</span>df1.iloc[:, <span class="dv">0</span>],</span>
<span id="cb209-24"><a href="#cb209-24" aria-hidden="true" tabindex="-1"></a>              ax<span class="op">=</span>ax1,</span>
<span id="cb209-25"><a href="#cb209-25" aria-hidden="true" tabindex="-1"></a>              palette<span class="op">=</span>colors)</span>
<span id="cb209-26"><a href="#cb209-26" aria-hidden="true" tabindex="-1"></a>  <span class="co"># устанавливаем название для этого графика</span></span>
<span id="cb209-27"><a href="#cb209-27" aria-hidden="true" tabindex="-1"></a>  ax1.<span class="bu">set</span>(title<span class="op">=</span><span class="st">&#39;По денежному объему, тыс.$&#39;</span>)</span>
<span id="cb209-28"><a href="#cb209-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-29"><a href="#cb209-29" aria-hidden="true" tabindex="-1"></a>  <span class="co"># построим столбчатую диаграмму по продажам в шт.</span></span>
<span id="cb209-30"><a href="#cb209-30" aria-hidden="true" tabindex="-1"></a>  sns.barplot(df2,</span>
<span id="cb209-31"><a href="#cb209-31" aria-hidden="true" tabindex="-1"></a>              x<span class="op">=</span>df2.iloc[:, <span class="dv">1</span>],</span>
<span id="cb209-32"><a href="#cb209-32" aria-hidden="true" tabindex="-1"></a>              y<span class="op">=</span>df2.iloc[:, <span class="dv">0</span>],</span>
<span id="cb209-33"><a href="#cb209-33" aria-hidden="true" tabindex="-1"></a>              ax<span class="op">=</span>ax2,</span>
<span id="cb209-34"><a href="#cb209-34" aria-hidden="true" tabindex="-1"></a>              palette<span class="op">=</span>colors)</span>
<span id="cb209-35"><a href="#cb209-35" aria-hidden="true" tabindex="-1"></a>  <span class="co"># устанавливаем название для этого графика</span></span>
<span id="cb209-36"><a href="#cb209-36" aria-hidden="true" tabindex="-1"></a>  ax2.<span class="bu">set</span>(title<span class="op">=</span><span class="st">&#39;По количественному объему, шт.&#39;</span>)<span class="op">;</span></span>
<span id="cb209-37"><a href="#cb209-37" aria-hidden="true" tabindex="-1"></a>  plt.tight_layout()</span>
<span id="cb209-38"><a href="#cb209-38" aria-hidden="true" tabindex="-1"></a>  <span class="co"># выводим графики</span></span>
<span id="cb209-39"><a href="#cb209-39" aria-hidden="true" tabindex="-1"></a>  plt.show()</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="626"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:609}"
id="GHMC968k8HOT" data-outputId="802aabbe-78a8-4d4f-bef7-9df54ee0d7aa">
<div class="sourceCode" id="cb210"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb210-1"><a href="#cb210-1" aria-hidden="true" tabindex="-1"></a><span class="co"># применим функции</span></span>
<span id="cb210-2"><a href="#cb210-2" aria-hidden="true" tabindex="-1"></a>df_usd, df_count <span class="op">=</span> compare_usd_quantity(df, <span class="st">&#39;бренд&#39;</span>, <span class="st">&#39;sum&#39;</span>, <span class="va">True</span>)</span>
<span id="cb210-3"><a href="#cb210-3" aria-hidden="true" tabindex="-1"></a>barplot(df_usd, df_count, <span class="dv">3</span>, <span class="st">&#39;ТОП-10 марок лидеров на рынке&#39;</span>)</span></code></pre></div>
<div class="output display_data">
<p><img
src="vertopal_9b40e0aaef914c45a9852524805a792d/fb045a20e046f0e52172615439f9294aab12db11.png" /></p>
</div>
</div>
<div class="cell markdown" id="3wBdncX2g8ay">
<p>С большим отрывом по денежному объему первое место занимает Toyota,
далее идет Hyundai и Lada. По количеству больше покупают Lada, Toyota,
Hyundai, между которыми небольшая разница. Скорее всего авто данных
марок покупают не только физлица, но и также и фирмы такси. От этого
такой отрыв от остальных марок по объему покупок.</p>
<p>Lexus, Kamaz и Ankai не входят в ТОП-10 по количеству, но входят в
ТОП-10 по денежному объему. Модели данных марок покупают не так часто,
но высокая цена позволяет приносить много денег.</p>
</div>
<div class="cell markdown" id="0_vZ9Cf9BJC_">
<p>Рассмотрим продажи по маркам в денежном значении в разрезе
коммерческого и некоммерческого транспорта. Возьмем ТОП-10 марок каждого
типа.</p>
</div>
<div class="cell code" data-execution_count="627"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:708}"
id="ImExqMThBOgP" data-outputId="ef94b688-be4c-43ee-a11a-0462411c2a05">
<div class="sourceCode" id="cb211"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb211-1"><a href="#cb211-1" aria-hidden="true" tabindex="-1"></a><span class="co"># создадим таблицу продаж марок для коммерческого транспорта</span></span>
<span id="cb211-2"><a href="#cb211-2" aria-hidden="true" tabindex="-1"></a>brand_com_revenue <span class="op">=</span> (</span>
<span id="cb211-3"><a href="#cb211-3" aria-hidden="true" tabindex="-1"></a>    com_df.groupby(<span class="st">&#39;бренд&#39;</span>, as_index<span class="op">=</span><span class="va">False</span>)[<span class="st">&#39;продажа_usd&#39;</span>].<span class="bu">sum</span>()</span>
<span id="cb211-4"><a href="#cb211-4" aria-hidden="true" tabindex="-1"></a>    .rename(columns<span class="op">=</span>{<span class="st">&#39;продажа_usd&#39;</span>: <span class="st">&#39;продажа, тыс.$&#39;</span>})</span>
<span id="cb211-5"><a href="#cb211-5" aria-hidden="true" tabindex="-1"></a>    .sort_values(by<span class="op">=</span><span class="st">&#39;продажа, тыс.$&#39;</span>, ascending<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb211-6"><a href="#cb211-6" aria-hidden="true" tabindex="-1"></a>    .reset_index(drop<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb211-7"><a href="#cb211-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb211-8"><a href="#cb211-8" aria-hidden="true" tabindex="-1"></a><span class="co"># переведем продажи в тыс.$</span></span>
<span id="cb211-9"><a href="#cb211-9" aria-hidden="true" tabindex="-1"></a>brand_com_revenue[<span class="st">&#39;продажа, тыс.$&#39;</span>] <span class="op">=</span> (</span>
<span id="cb211-10"><a href="#cb211-10" aria-hidden="true" tabindex="-1"></a>    <span class="bu">round</span>(brand_com_revenue[<span class="st">&#39;продажа, тыс.$&#39;</span>] <span class="op">/</span> <span class="dv">1000</span>, <span class="dv">2</span>)</span>
<span id="cb211-11"><a href="#cb211-11" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb211-12"><a href="#cb211-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb211-13"><a href="#cb211-13" aria-hidden="true" tabindex="-1"></a>brand_com_revenue</span></code></pre></div>
<div class="output execute_result" data-execution_count="627">

  <div id="df-c9104796-a520-471c-9d97-ff3ae550935e" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>бренд</th>
      <th>продажа, тыс.$</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>kamaz</td>
      <td>46092.68</td>
    </tr>
    <tr>
      <th>1</th>
      <td>gaz</td>
      <td>32286.20</td>
    </tr>
    <tr>
      <th>2</th>
      <td>ankai</td>
      <td>28907.06</td>
    </tr>
    <tr>
      <th>3</th>
      <td>daewoo</td>
      <td>12162.70</td>
    </tr>
    <tr>
      <th>4</th>
      <td>uaz</td>
      <td>11248.28</td>
    </tr>
    <tr>
      <th>5</th>
      <td>hyundai truck &amp; bus</td>
      <td>9710.61</td>
    </tr>
    <tr>
      <th>6</th>
      <td>man</td>
      <td>7799.87</td>
    </tr>
    <tr>
      <th>7</th>
      <td>shacman</td>
      <td>5468.19</td>
    </tr>
    <tr>
      <th>8</th>
      <td>dong feng</td>
      <td>4374.49</td>
    </tr>
    <tr>
      <th>9</th>
      <td>yutong</td>
      <td>4127.63</td>
    </tr>
    <tr>
      <th>10</th>
      <td>isuzu</td>
      <td>4050.70</td>
    </tr>
    <tr>
      <th>11</th>
      <td>jac</td>
      <td>3994.04</td>
    </tr>
    <tr>
      <th>12</th>
      <td>mercedes-benz trucks</td>
      <td>3610.27</td>
    </tr>
    <tr>
      <th>13</th>
      <td>урал</td>
      <td>3016.35</td>
    </tr>
    <tr>
      <th>14</th>
      <td>hino</td>
      <td>2603.15</td>
    </tr>
    <tr>
      <th>15</th>
      <td>scania</td>
      <td>2076.89</td>
    </tr>
    <tr>
      <th>16</th>
      <td>foton</td>
      <td>1750.85</td>
    </tr>
    <tr>
      <th>17</th>
      <td>iveco</td>
      <td>1006.44</td>
    </tr>
    <tr>
      <th>18</th>
      <td>volkswagen</td>
      <td>741.19</td>
    </tr>
    <tr>
      <th>19</th>
      <td>mercedes-benz</td>
      <td>661.09</td>
    </tr>
    <tr>
      <th>20</th>
      <td>nefaz</td>
      <td>123.25</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-c9104796-a520-471c-9d97-ff3ae550935e')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-c9104796-a520-471c-9d97-ff3ae550935e button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-c9104796-a520-471c-9d97-ff3ae550935e');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-d164113e-7838-42dc-9852-1c399f7fd220">
  <button class="colab-df-quickchart" onclick="quickchart('df-d164113e-7838-42dc-9852-1c399f7fd220')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-d164113e-7838-42dc-9852-1c399f7fd220 button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>
    </div>
  </div>

</div>
</div>
<div class="cell markdown" id="i6KoWy_ahi74">
<p>Получилось много брендов авто. На графике это будет выглядеть
громоздко. Поэтому выделим все бренды, которые не входят в ТОП-3 в
отдельную категорию 'others'.</p>
</div>
<div class="cell code" data-execution_count="628"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:175}"
id="0crCNj_AhUAM" data-outputId="b51f96b5-204e-42c8-c930-3cded4c384d5">
<div class="sourceCode" id="cb212"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb212-1"><a href="#cb212-1" aria-hidden="true" tabindex="-1"></a><span class="co"># выведем все авто не в ТОП-3 в отдельный датафрейм</span></span>
<span id="cb212-2"><a href="#cb212-2" aria-hidden="true" tabindex="-1"></a>brand_com_revenue_others <span class="op">=</span> brand_com_revenue.iloc[<span class="dv">3</span>:]</span>
<span id="cb212-3"><a href="#cb212-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-4"><a href="#cb212-4" aria-hidden="true" tabindex="-1"></a><span class="co"># зададим название категории вместо брендов</span></span>
<span id="cb212-5"><a href="#cb212-5" aria-hidden="true" tabindex="-1"></a>brand_com_revenue_others[<span class="st">&#39;бренд&#39;</span>] <span class="op">=</span> <span class="st">&#39;others&#39;</span></span>
<span id="cb212-6"><a href="#cb212-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-7"><a href="#cb212-7" aria-hidden="true" tabindex="-1"></a><span class="co"># посчитаем суммарные продажи по категории</span></span>
<span id="cb212-8"><a href="#cb212-8" aria-hidden="true" tabindex="-1"></a>brand_com_revenue_others <span class="op">=</span> (</span>
<span id="cb212-9"><a href="#cb212-9" aria-hidden="true" tabindex="-1"></a>    brand_com_revenue_others</span>
<span id="cb212-10"><a href="#cb212-10" aria-hidden="true" tabindex="-1"></a>    .groupby(<span class="st">&#39;бренд&#39;</span>, as_index<span class="op">=</span><span class="va">False</span>)[<span class="st">&#39;продажа, тыс.$&#39;</span>].<span class="bu">sum</span>()</span>
<span id="cb212-11"><a href="#cb212-11" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb212-12"><a href="#cb212-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-13"><a href="#cb212-13" aria-hidden="true" tabindex="-1"></a><span class="co"># объединим датафреймы</span></span>
<span id="cb212-14"><a href="#cb212-14" aria-hidden="true" tabindex="-1"></a>brand_com_revenue <span class="op">=</span> pd.concat([brand_com_revenue.iloc[:<span class="dv">3</span>],</span>
<span id="cb212-15"><a href="#cb212-15" aria-hidden="true" tabindex="-1"></a>                               brand_com_revenue_others],</span>
<span id="cb212-16"><a href="#cb212-16" aria-hidden="true" tabindex="-1"></a>                              axis<span class="op">=</span><span class="dv">0</span>).sort_values(by<span class="op">=</span><span class="st">&#39;продажа, тыс.$&#39;</span>,</span>
<span id="cb212-17"><a href="#cb212-17" aria-hidden="true" tabindex="-1"></a>                                                  ascending<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb212-18"><a href="#cb212-18" aria-hidden="true" tabindex="-1"></a>brand_com_revenue</span></code></pre></div>
<div class="output execute_result" data-execution_count="628">

  <div id="df-0c4d3ae1-a2a7-4164-a8c5-5e8e65ea8804" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>бренд</th>
      <th>продажа, тыс.$</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>others</td>
      <td>78525.99</td>
    </tr>
    <tr>
      <th>0</th>
      <td>kamaz</td>
      <td>46092.68</td>
    </tr>
    <tr>
      <th>1</th>
      <td>gaz</td>
      <td>32286.20</td>
    </tr>
    <tr>
      <th>2</th>
      <td>ankai</td>
      <td>28907.06</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-0c4d3ae1-a2a7-4164-a8c5-5e8e65ea8804')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-0c4d3ae1-a2a7-4164-a8c5-5e8e65ea8804 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-0c4d3ae1-a2a7-4164-a8c5-5e8e65ea8804');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-ab5a56be-083f-4d38-8ce3-d20086864983">
  <button class="colab-df-quickchart" onclick="quickchart('df-ab5a56be-083f-4d38-8ce3-d20086864983')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-ab5a56be-083f-4d38-8ce3-d20086864983 button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>
    </div>
  </div>

</div>
</div>
<div class="cell code" data-execution_count="629"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:990}"
id="Qr1pVii2B2sA" data-outputId="aabf9151-4e63-4605-e42e-23c22fdbcb49">
<div class="sourceCode" id="cb213"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb213-1"><a href="#cb213-1" aria-hidden="true" tabindex="-1"></a><span class="co"># создадим таблицу продаж марок для некоммерческого транспорта</span></span>
<span id="cb213-2"><a href="#cb213-2" aria-hidden="true" tabindex="-1"></a>brand_uncom_revenue <span class="op">=</span> (</span>
<span id="cb213-3"><a href="#cb213-3" aria-hidden="true" tabindex="-1"></a>    uncom_df.groupby(<span class="st">&#39;бренд&#39;</span>, as_index<span class="op">=</span><span class="va">False</span>)[<span class="st">&#39;продажа_usd&#39;</span>].<span class="bu">sum</span>()</span>
<span id="cb213-4"><a href="#cb213-4" aria-hidden="true" tabindex="-1"></a>    .rename(columns<span class="op">=</span>{<span class="st">&#39;продажа_usd&#39;</span>: <span class="st">&#39;продажа, тыс.$&#39;</span>})</span>
<span id="cb213-5"><a href="#cb213-5" aria-hidden="true" tabindex="-1"></a>    .sort_values(by<span class="op">=</span><span class="st">&#39;продажа, тыс.$&#39;</span>, ascending<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb213-6"><a href="#cb213-6" aria-hidden="true" tabindex="-1"></a>    .reset_index(drop<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb213-7"><a href="#cb213-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb213-8"><a href="#cb213-8" aria-hidden="true" tabindex="-1"></a><span class="co"># переведем продажи в тыс.$</span></span>
<span id="cb213-9"><a href="#cb213-9" aria-hidden="true" tabindex="-1"></a>brand_uncom_revenue[<span class="st">&#39;продажа, тыс.$&#39;</span>] <span class="op">=</span> (</span>
<span id="cb213-10"><a href="#cb213-10" aria-hidden="true" tabindex="-1"></a>    <span class="bu">round</span>(brand_uncom_revenue[<span class="st">&#39;продажа, тыс.$&#39;</span>] <span class="op">/</span> <span class="dv">1000</span>, <span class="dv">2</span>)</span>
<span id="cb213-11"><a href="#cb213-11" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb213-12"><a href="#cb213-12" aria-hidden="true" tabindex="-1"></a>brand_uncom_revenue</span></code></pre></div>
<div class="output execute_result" data-execution_count="629">

  <div id="df-1d73fcf5-bb64-463f-9601-4f568e674ae9" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>бренд</th>
      <th>продажа, тыс.$</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>toyota</td>
      <td>402500.07</td>
    </tr>
    <tr>
      <th>1</th>
      <td>hyundai</td>
      <td>229307.60</td>
    </tr>
    <tr>
      <th>2</th>
      <td>lada</td>
      <td>107847.48</td>
    </tr>
    <tr>
      <th>3</th>
      <td>lexus</td>
      <td>77376.37</td>
    </tr>
    <tr>
      <th>4</th>
      <td>kia</td>
      <td>45669.70</td>
    </tr>
    <tr>
      <th>5</th>
      <td>nissan</td>
      <td>40012.77</td>
    </tr>
    <tr>
      <th>6</th>
      <td>bmw</td>
      <td>28735.77</td>
    </tr>
    <tr>
      <th>7</th>
      <td>jac</td>
      <td>26595.34</td>
    </tr>
    <tr>
      <th>8</th>
      <td>volkswagen</td>
      <td>25149.67</td>
    </tr>
    <tr>
      <th>9</th>
      <td>renault</td>
      <td>24184.91</td>
    </tr>
    <tr>
      <th>10</th>
      <td>skoda</td>
      <td>20207.19</td>
    </tr>
    <tr>
      <th>11</th>
      <td>ravon</td>
      <td>17638.18</td>
    </tr>
    <tr>
      <th>12</th>
      <td>subaru</td>
      <td>16189.34</td>
    </tr>
    <tr>
      <th>13</th>
      <td>land rover</td>
      <td>15188.16</td>
    </tr>
    <tr>
      <th>14</th>
      <td>mitsubishi</td>
      <td>15035.60</td>
    </tr>
    <tr>
      <th>15</th>
      <td>mercedes-benz</td>
      <td>14246.82</td>
    </tr>
    <tr>
      <th>16</th>
      <td>chevrolet</td>
      <td>8983.79</td>
    </tr>
    <tr>
      <th>17</th>
      <td>mazda</td>
      <td>8216.97</td>
    </tr>
    <tr>
      <th>18</th>
      <td>uaz</td>
      <td>7770.99</td>
    </tr>
    <tr>
      <th>19</th>
      <td>infiniti</td>
      <td>6276.72</td>
    </tr>
    <tr>
      <th>20</th>
      <td>cadillac</td>
      <td>5853.81</td>
    </tr>
    <tr>
      <th>21</th>
      <td>porsche</td>
      <td>5113.51</td>
    </tr>
    <tr>
      <th>22</th>
      <td>audi</td>
      <td>4059.49</td>
    </tr>
    <tr>
      <th>23</th>
      <td>lifan</td>
      <td>2890.11</td>
    </tr>
    <tr>
      <th>24</th>
      <td>volvo</td>
      <td>2866.92</td>
    </tr>
    <tr>
      <th>25</th>
      <td>jaguar</td>
      <td>2448.19</td>
    </tr>
    <tr>
      <th>26</th>
      <td>isuzu</td>
      <td>2049.20</td>
    </tr>
    <tr>
      <th>27</th>
      <td>mini</td>
      <td>483.95</td>
    </tr>
    <tr>
      <th>28</th>
      <td>peugeot</td>
      <td>415.57</td>
    </tr>
    <tr>
      <th>29</th>
      <td>ford</td>
      <td>68.43</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-1d73fcf5-bb64-463f-9601-4f568e674ae9')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-1d73fcf5-bb64-463f-9601-4f568e674ae9 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-1d73fcf5-bb64-463f-9601-4f568e674ae9');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-18635a6b-7268-4c22-9f02-ab255aaebb61">
  <button class="colab-df-quickchart" onclick="quickchart('df-18635a6b-7268-4c22-9f02-ab255aaebb61')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-18635a6b-7268-4c22-9f02-ab255aaebb61 button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>
    </div>
  </div>

</div>
</div>
<div class="cell markdown" id="zyV659epiOtH">
<p>Далее проделаем то же самое, что и с коммерческим транспортом.</p>
</div>
<div class="cell code" data-execution_count="630"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:175}"
id="ncCNdI_eigcO" data-outputId="ceebea63-3b63-414b-c77f-da1aa7f76c0a">
<div class="sourceCode" id="cb214"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb214-1"><a href="#cb214-1" aria-hidden="true" tabindex="-1"></a><span class="co"># выведем все авто не в ТОП-3 в отдельный датафрейм</span></span>
<span id="cb214-2"><a href="#cb214-2" aria-hidden="true" tabindex="-1"></a>brand_uncom_revenue_others <span class="op">=</span> brand_uncom_revenue.iloc[<span class="dv">3</span>:]</span>
<span id="cb214-3"><a href="#cb214-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb214-4"><a href="#cb214-4" aria-hidden="true" tabindex="-1"></a><span class="co"># зададим название категории вместо брендов</span></span>
<span id="cb214-5"><a href="#cb214-5" aria-hidden="true" tabindex="-1"></a>brand_uncom_revenue_others[<span class="st">&#39;бренд&#39;</span>] <span class="op">=</span> <span class="st">&#39;others&#39;</span></span>
<span id="cb214-6"><a href="#cb214-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb214-7"><a href="#cb214-7" aria-hidden="true" tabindex="-1"></a><span class="co"># посчитаем суммарные продажи по категории</span></span>
<span id="cb214-8"><a href="#cb214-8" aria-hidden="true" tabindex="-1"></a>brand_uncom_revenue_others <span class="op">=</span> (</span>
<span id="cb214-9"><a href="#cb214-9" aria-hidden="true" tabindex="-1"></a>    brand_uncom_revenue_others</span>
<span id="cb214-10"><a href="#cb214-10" aria-hidden="true" tabindex="-1"></a>    .groupby(<span class="st">&#39;бренд&#39;</span>, as_index<span class="op">=</span><span class="va">False</span>)[<span class="st">&#39;продажа, тыс.$&#39;</span>].<span class="bu">sum</span>()</span>
<span id="cb214-11"><a href="#cb214-11" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb214-12"><a href="#cb214-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb214-13"><a href="#cb214-13" aria-hidden="true" tabindex="-1"></a><span class="co"># объединим датафреймы</span></span>
<span id="cb214-14"><a href="#cb214-14" aria-hidden="true" tabindex="-1"></a>brand_uncom_revenue <span class="op">=</span> pd.concat([brand_uncom_revenue.iloc[:<span class="dv">3</span>],</span>
<span id="cb214-15"><a href="#cb214-15" aria-hidden="true" tabindex="-1"></a>                                 brand_uncom_revenue_others],</span>
<span id="cb214-16"><a href="#cb214-16" aria-hidden="true" tabindex="-1"></a>                                axis<span class="op">=</span><span class="dv">0</span>).sort_values(by<span class="op">=</span><span class="st">&#39;продажа, тыс.$&#39;</span>,</span>
<span id="cb214-17"><a href="#cb214-17" aria-hidden="true" tabindex="-1"></a>                                                    ascending<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb214-18"><a href="#cb214-18" aria-hidden="true" tabindex="-1"></a>brand_uncom_revenue</span></code></pre></div>
<div class="output execute_result" data-execution_count="630">

  <div id="df-e1f639bb-d019-440e-974b-77ef4435e00d" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>бренд</th>
      <th>продажа, тыс.$</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>others</td>
      <td>423727.47</td>
    </tr>
    <tr>
      <th>0</th>
      <td>toyota</td>
      <td>402500.07</td>
    </tr>
    <tr>
      <th>1</th>
      <td>hyundai</td>
      <td>229307.60</td>
    </tr>
    <tr>
      <th>2</th>
      <td>lada</td>
      <td>107847.48</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-e1f639bb-d019-440e-974b-77ef4435e00d')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-e1f639bb-d019-440e-974b-77ef4435e00d button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-e1f639bb-d019-440e-974b-77ef4435e00d');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-501138a6-8c49-4d4d-a9c6-bd2f2525ffb8">
  <button class="colab-df-quickchart" onclick="quickchart('df-501138a6-8c49-4d4d-a9c6-bd2f2525ffb8')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-501138a6-8c49-4d4d-a9c6-bd2f2525ffb8 button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>
    </div>
  </div>

</div>
</div>
<div class="cell code" data-execution_count="631"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:542}"
id="FUdT2KiTBaqo" data-outputId="0a3813a3-86e3-4ae1-d4ec-6cf8499ad9aa">
<div class="sourceCode" id="cb215"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb215-1"><a href="#cb215-1" aria-hidden="true" tabindex="-1"></a><span class="co"># построим графики</span></span>
<span id="cb215-2"><a href="#cb215-2" aria-hidden="true" tabindex="-1"></a><span class="co"># создадим сетку графиков и название каждого</span></span>
<span id="cb215-3"><a href="#cb215-3" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> make_subplots(<span class="dv">1</span>, <span class="dv">2</span>, specs<span class="op">=</span>[[{<span class="st">&#39;type&#39;</span>:<span class="st">&#39;domain&#39;</span>}, {<span class="st">&#39;type&#39;</span>:<span class="st">&#39;domain&#39;</span>}]],</span>
<span id="cb215-4"><a href="#cb215-4" aria-hidden="true" tabindex="-1"></a>                    subplot_titles<span class="op">=</span>[<span class="st">&#39;Коммерческие авто&#39;</span>, <span class="st">&#39;Некоммерческие авто&#39;</span>])</span>
<span id="cb215-5"><a href="#cb215-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb215-6"><a href="#cb215-6" aria-hidden="true" tabindex="-1"></a><span class="co"># построим график для коммерческого трансорта</span></span>
<span id="cb215-7"><a href="#cb215-7" aria-hidden="true" tabindex="-1"></a>fig.add_trace(go.Pie(labels<span class="op">=</span><span class="bu">list</span>(brand_com_revenue[<span class="st">&#39;бренд&#39;</span>]),</span>
<span id="cb215-8"><a href="#cb215-8" aria-hidden="true" tabindex="-1"></a>                     values<span class="op">=</span><span class="bu">list</span>(brand_com_revenue[<span class="st">&#39;продажа, тыс.$&#39;</span>]),</span>
<span id="cb215-9"><a href="#cb215-9" aria-hidden="true" tabindex="-1"></a>                     pull<span class="op">=</span>[<span class="dv">0</span>] <span class="op">+</span> [<span class="fl">.2</span>] <span class="op">+</span> [<span class="dv">0</span>] <span class="op">*</span> <span class="dv">2</span>,</span>
<span id="cb215-10"><a href="#cb215-10" aria-hidden="true" tabindex="-1"></a>                     marker_colors<span class="op">=</span>[<span class="st">&#39;#FF0000&#39;</span>] <span class="op">+</span> [<span class="st">&#39;#DC143C&#39;</span>] <span class="op">+</span></span>
<span id="cb215-11"><a href="#cb215-11" aria-hidden="true" tabindex="-1"></a>                      [<span class="st">&#39;#FA8072&#39;</span>] <span class="op">+</span> [<span class="st">&#39;#FFA07A&#39;</span>]),</span>
<span id="cb215-12"><a href="#cb215-12" aria-hidden="true" tabindex="-1"></a>              <span class="dv">1</span>, <span class="dv">1</span>)</span>
<span id="cb215-13"><a href="#cb215-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb215-14"><a href="#cb215-14" aria-hidden="true" tabindex="-1"></a><span class="co"># построим график для некоммерческого трансорта</span></span>
<span id="cb215-15"><a href="#cb215-15" aria-hidden="true" tabindex="-1"></a>fig.add_trace(go.Pie(labels<span class="op">=</span><span class="bu">list</span>(brand_uncom_revenue[<span class="st">&#39;бренд&#39;</span>]),</span>
<span id="cb215-16"><a href="#cb215-16" aria-hidden="true" tabindex="-1"></a>                     values<span class="op">=</span><span class="bu">list</span>(brand_uncom_revenue[<span class="st">&#39;продажа, тыс.$&#39;</span>]),</span>
<span id="cb215-17"><a href="#cb215-17" aria-hidden="true" tabindex="-1"></a>                     pull<span class="op">=</span>[<span class="dv">0</span>] <span class="op">+</span> [<span class="fl">.2</span>] <span class="op">+</span> [<span class="dv">0</span>] <span class="op">*</span> <span class="dv">2</span>,</span>
<span id="cb215-18"><a href="#cb215-18" aria-hidden="true" tabindex="-1"></a>                     marker_colors<span class="op">=</span>[<span class="st">&#39;#0000FF&#39;</span>] <span class="op">+</span> [<span class="st">&#39;#1E90FF&#39;</span>] <span class="op">+</span></span>
<span id="cb215-19"><a href="#cb215-19" aria-hidden="true" tabindex="-1"></a>                      [<span class="st">&#39;#00BFFF&#39;</span>] <span class="op">+</span> [<span class="st">&#39;#87CEFA&#39;</span>]),</span>
<span id="cb215-20"><a href="#cb215-20" aria-hidden="true" tabindex="-1"></a>              <span class="dv">1</span>, <span class="dv">2</span>)</span>
<span id="cb215-21"><a href="#cb215-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb215-22"><a href="#cb215-22" aria-hidden="true" tabindex="-1"></a><span class="co"># настроим отоброжение информации на графиках</span></span>
<span id="cb215-23"><a href="#cb215-23" aria-hidden="true" tabindex="-1"></a>fig.update_traces(textinfo<span class="op">=</span><span class="st">&#39;label+percent&#39;</span>)</span>
<span id="cb215-24"><a href="#cb215-24" aria-hidden="true" tabindex="-1"></a>fig.update_layout(title_text<span class="op">=</span><span class="ss">f&#39;Продажи по маркам, тыс.$&#39;</span>,</span>
<span id="cb215-25"><a href="#cb215-25" aria-hidden="true" tabindex="-1"></a>                  title_x<span class="op">=</span><span class="fl">0.47</span>,</span>
<span id="cb215-26"><a href="#cb215-26" aria-hidden="true" tabindex="-1"></a>                  showlegend<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb215-27"><a href="#cb215-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb215-28"><a href="#cb215-28" aria-hidden="true" tabindex="-1"></a><span class="co"># выведем графики</span></span>
<span id="cb215-29"><a href="#cb215-29" aria-hidden="true" tabindex="-1"></a>fig.show()</span></code></pre></div>
<div class="output display_data">
<html>
<head><meta charset="utf-8" /></head>
<body>
    <div>            <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_SVG"></script><script type="text/javascript">if (window.MathJax && window.MathJax.Hub && window.MathJax.Hub.Config) {window.MathJax.Hub.Config({SVG: {font: "STIX-Web"}});}</script>                <script type="text/javascript">window.PlotlyConfig = {MathJaxConfig: 'local'};</script>
        <script charset="utf-8" src="https://cdn.plot.ly/plotly-2.24.1.min.js"></script>                <div id="f20260e3-2677-42b1-81a3-c1712b145774" class="plotly-graph-div" style="height:525px; width:100%;"></div>            <script type="text/javascript">                                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("f20260e3-2677-42b1-81a3-c1712b145774")) {                    Plotly.newPlot(                        "f20260e3-2677-42b1-81a3-c1712b145774",                        [{"labels":["others","kamaz","gaz","ankai"],"marker":{"colors":["#FF0000","#DC143C","#FA8072","#FFA07A"]},"pull":[0,0.2,0,0],"values":[78525.99,46092.68,32286.2,28907.06],"type":"pie","domain":{"x":[0.0,0.45],"y":[0.0,1.0]},"textinfo":"label+percent"},{"labels":["others","toyota","hyundai","lada"],"marker":{"colors":["#0000FF","#1E90FF","#00BFFF","#87CEFA"]},"pull":[0,0.2,0,0],"values":[423727.47,402500.07,229307.6,107847.48],"type":"pie","domain":{"x":[0.55,1.0],"y":[0.0,1.0]},"textinfo":"label+percent"}],                        {"template":{"data":{"histogram2dcontour":[{"type":"histogram2dcontour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"choropleth":[{"type":"choropleth","colorbar":{"outlinewidth":0,"ticks":""}}],"histogram2d":[{"type":"histogram2d","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmap":[{"type":"heatmap","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmapgl":[{"type":"heatmapgl","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"contourcarpet":[{"type":"contourcarpet","colorbar":{"outlinewidth":0,"ticks":""}}],"contour":[{"type":"contour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"surface":[{"type":"surface","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"mesh3d":[{"type":"mesh3d","colorbar":{"outlinewidth":0,"ticks":""}}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"parcoords":[{"type":"parcoords","line":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolargl":[{"type":"scatterpolargl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"scattergeo":[{"type":"scattergeo","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolar":[{"type":"scatterpolar","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"scattergl":[{"type":"scattergl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatter3d":[{"type":"scatter3d","line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattermapbox":[{"type":"scattermapbox","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterternary":[{"type":"scatterternary","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattercarpet":[{"type":"scattercarpet","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"type":"carpet"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}],"barpolar":[{"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"pie":[{"automargin":true,"type":"pie"}]},"layout":{"autotypenumbers":"strict","colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"hovermode":"closest","hoverlabel":{"align":"left"},"paper_bgcolor":"white","plot_bgcolor":"#E5ECF6","polar":{"bgcolor":"#E5ECF6","angularaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"radialaxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"ternary":{"bgcolor":"#E5ECF6","aaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"baxis":{"gridcolor":"white","linecolor":"white","ticks":""},"caxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]]},"xaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"yaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"scene":{"xaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"yaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"zaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"geo":{"bgcolor":"white","landcolor":"#E5ECF6","subunitcolor":"white","showland":true,"showlakes":true,"lakecolor":"white"},"title":{"x":0.05},"mapbox":{"style":"light"}}},"annotations":[{"font":{"size":16},"showarrow":false,"text":"\u041a\u043e\u043c\u043c\u0435\u0440\u0447\u0435\u0441\u043a\u0438\u0435 \u0430\u0432\u0442\u043e","x":0.225,"xanchor":"center","xref":"paper","y":1.0,"yanchor":"bottom","yref":"paper"},{"font":{"size":16},"showarrow":false,"text":"\u041d\u0435\u043a\u043e\u043c\u043c\u0435\u0440\u0447\u0435\u0441\u043a\u0438\u0435 \u0430\u0432\u0442\u043e","x":0.775,"xanchor":"center","xref":"paper","y":1.0,"yanchor":"bottom","yref":"paper"}],"title":{"text":"\u041f\u0440\u043e\u0434\u0430\u0436\u0438 \u043f\u043e \u043c\u0430\u0440\u043a\u0430\u043c, \u0442\u044b\u0441.$","x":0.47},"showlegend":false},                        {"responsive": true}                    ).then(function(){
                            
var gd = document.getElementById('f20260e3-2677-42b1-81a3-c1712b145774');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })                };                            </script>        </div>
</body>
</html>
</div>
</div>
<div class="cell markdown" id="Qwe28OW4G_WN">
<p>Среди коммерческих авто ТОП-3 занимают:</p>
<ol>
<li>Kamaz (24.8%)</li>
<li>Gaz (17.4%)</li>
<li>Ankai (15.6%)</li>
</ol>
<p>Среди некоммерческих авто ТОП-3 занимают:</p>
<ol>
<li>Toyota (34.6%)</li>
<li>Hyundai (19.7%)</li>
<li>Lada (9.27%)</li>
</ol>
</div>
<section id="46-rfm-анализ" class="cell markdown" id="xaQbgqd3oes2">
<h2>4.6 RFM анализ</h2>
</section>
<div class="cell markdown" id="Oa6LBHZlHuE4">
<p>Проведем RFM-анализ моделей авто. Использовать будем только
показатели Frequency и Monetary. Показатели могут принимать значения от
1 до 3, где для Frequency (частота покупок):</p>
<ul>
<li>1 - часто;</li>
<li>2 - средне;</li>
<li>3 - редко.</li>
</ul>
<p>Для Monetary (сумма покупок):</p>
<ul>
<li>1 - большая;</li>
<li>2 - средняя;</li>
<li>3 - маленькая.</li>
</ul>
</div>
<div class="cell code" data-execution_count="632" id="QYExKcJkHuTl">
<div class="sourceCode" id="cb216"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb216-1"><a href="#cb216-1" aria-hidden="true" tabindex="-1"></a><span class="co"># для каждой модели занесем информацию</span></span>
<span id="cb216-2"><a href="#cb216-2" aria-hidden="true" tabindex="-1"></a><span class="co"># о количестве покупок</span></span>
<span id="cb216-3"><a href="#cb216-3" aria-hidden="true" tabindex="-1"></a>df[<span class="st">&#39;freq&#39;</span>] <span class="op">=</span> df.groupby(<span class="st">&#39;авто&#39;</span>)[<span class="st">&#39;авто&#39;</span>].transform(<span class="st">&#39;count&#39;</span>)</span>
<span id="cb216-4"><a href="#cb216-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb216-5"><a href="#cb216-5" aria-hidden="true" tabindex="-1"></a><span class="co"># о сумме покупок</span></span>
<span id="cb216-6"><a href="#cb216-6" aria-hidden="true" tabindex="-1"></a>df[<span class="st">&#39;mon&#39;</span>] <span class="op">=</span> df.groupby(<span class="st">&#39;авто&#39;</span>)[<span class="st">&#39;продажа_usd&#39;</span>].transform(<span class="st">&#39;sum&#39;</span>)</span>
<span id="cb216-7"><a href="#cb216-7" aria-hidden="true" tabindex="-1"></a><span class="co"># переведем в тысячи</span></span>
<span id="cb216-8"><a href="#cb216-8" aria-hidden="true" tabindex="-1"></a>df[<span class="st">&#39;mon&#39;</span>] <span class="op">=</span> <span class="bu">round</span>(df[<span class="st">&#39;mon&#39;</span>] <span class="op">/</span> <span class="dv">1000</span>, <span class="dv">2</span>)</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="633" id="444ytRbXujXd">
<div class="sourceCode" id="cb217"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb217-1"><a href="#cb217-1" aria-hidden="true" tabindex="-1"></a><span class="co"># найдем значения frequency</span></span>
<span id="cb217-2"><a href="#cb217-2" aria-hidden="true" tabindex="-1"></a><span class="co"># разделим данные на 3 равные части и присвоим значения</span></span>
<span id="cb217-3"><a href="#cb217-3" aria-hidden="true" tabindex="-1"></a>df[<span class="st">&#39;f_value&#39;</span>] <span class="op">=</span> pd.qcut(df[<span class="st">&#39;freq&#39;</span>], q<span class="op">=</span><span class="dv">3</span>, labels<span class="op">=</span>[<span class="dv">3</span>, <span class="dv">2</span>, <span class="dv">1</span>])</span>
<span id="cb217-4"><a href="#cb217-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb217-5"><a href="#cb217-5" aria-hidden="true" tabindex="-1"></a><span class="co"># найдем значения monetary</span></span>
<span id="cb217-6"><a href="#cb217-6" aria-hidden="true" tabindex="-1"></a>df[<span class="st">&#39;m_value&#39;</span>] <span class="op">=</span> pd.qcut(df[<span class="st">&#39;mon&#39;</span>], q<span class="op">=</span><span class="dv">3</span>, labels<span class="op">=</span>[<span class="dv">3</span>, <span class="dv">2</span>, <span class="dv">1</span>])</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="634"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="SyIb84XGurLs" data-outputId="eecd70c7-85ef-418a-b3cd-0cabe5b1eece">
<div class="sourceCode" id="cb218"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb218-1"><a href="#cb218-1" aria-hidden="true" tabindex="-1"></a><span class="co"># объединим значения</span></span>
<span id="cb218-2"><a href="#cb218-2" aria-hidden="true" tabindex="-1"></a>df[<span class="st">&#39;fm&#39;</span>] <span class="op">=</span> df[<span class="st">&#39;f_value&#39;</span>].astype(<span class="st">&#39;str&#39;</span>) <span class="op">+</span> df[<span class="st">&#39;m_value&#39;</span>].astype(<span class="st">&#39;str&#39;</span>)</span>
<span id="cb218-3"><a href="#cb218-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb218-4"><a href="#cb218-4" aria-hidden="true" tabindex="-1"></a><span class="co"># выведем уникальные значения</span></span>
<span id="cb218-5"><a href="#cb218-5" aria-hidden="true" tabindex="-1"></a><span class="bu">sorted</span>(df[<span class="st">&#39;fm&#39;</span>].unique())</span></code></pre></div>
<div class="output execute_result" data-execution_count="634">
<pre><code>[&#39;11&#39;, &#39;12&#39;, &#39;21&#39;, &#39;22&#39;, &#39;23&#39;, &#39;32&#39;, &#39;33&#39;]</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="635" id="CQFSaBoZu0NE">
<div class="sourceCode" id="cb220"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb220-1"><a href="#cb220-1" aria-hidden="true" tabindex="-1"></a><span class="co"># удаляем ненужные столбцы</span></span>
<span id="cb220-2"><a href="#cb220-2" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> df.drop(columns<span class="op">=</span>[<span class="st">&#39;freq&#39;</span>, <span class="st">&#39;mon&#39;</span>, <span class="st">&#39;f_value&#39;</span>, <span class="st">&#39;m_value&#39;</span>])</span></code></pre></div>
</div>
<div class="cell markdown" id="UaSILQFbLRTB">
<p>Итого у нас есть 7 уникальных значений показателей FM. Рассмотрим
значение каждого:</p>
<ul>
<li>11 - часто и много покупают</li>
<li>12 - часто и средне покупают</li>
<li>21 - нечасто и много покупают</li>
<li>22 - нечасто и средне покупают</li>
<li>23 - нечасто и мало покупают</li>
<li>32 - редко и средне покупают</li>
<li>33 - рекдо и мало покупают.</li>
</ul>
</div>
<div class="cell code" data-execution_count="636"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:269}"
id="z6nTg9i9LFRt" data-outputId="135bf326-1dcf-4fbf-c798-7e06b2d11257">
<div class="sourceCode" id="cb221"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb221-1"><a href="#cb221-1" aria-hidden="true" tabindex="-1"></a><span class="co"># посчитаем сколько авто входит в каждую группу</span></span>
<span id="cb221-2"><a href="#cb221-2" aria-hidden="true" tabindex="-1"></a>fm_group <span class="op">=</span> df.groupby(<span class="st">&#39;fm&#39;</span>)[<span class="st">&#39;fm&#39;</span>].agg({<span class="st">&#39;count&#39;</span>}).reset_index()</span>
<span id="cb221-3"><a href="#cb221-3" aria-hidden="true" tabindex="-1"></a>fm_group</span></code></pre></div>
<div class="output execute_result" data-execution_count="636">

  <div id="df-3967a2ce-4632-42e3-8bee-21a96b920e4a" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>fm</th>
      <th>count</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>11</td>
      <td>10186</td>
    </tr>
    <tr>
      <th>1</th>
      <td>12</td>
      <td>2211</td>
    </tr>
    <tr>
      <th>2</th>
      <td>21</td>
      <td>2490</td>
    </tr>
    <tr>
      <th>3</th>
      <td>22</td>
      <td>9155</td>
    </tr>
    <tr>
      <th>4</th>
      <td>23</td>
      <td>2272</td>
    </tr>
    <tr>
      <th>5</th>
      <td>32</td>
      <td>2537</td>
    </tr>
    <tr>
      <th>6</th>
      <td>33</td>
      <td>11108</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-3967a2ce-4632-42e3-8bee-21a96b920e4a')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-3967a2ce-4632-42e3-8bee-21a96b920e4a button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-3967a2ce-4632-42e3-8bee-21a96b920e4a');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-04eea4ef-f563-41ee-b1d8-f89f6d79710b">
  <button class="colab-df-quickchart" onclick="quickchart('df-04eea4ef-f563-41ee-b1d8-f89f6d79710b')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-04eea4ef-f563-41ee-b1d8-f89f6d79710b button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>
    </div>
  </div>

</div>
</div>
<div class="cell code" data-execution_count="637"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:542}"
id="sIsn1wXUlT4Z" data-outputId="25dd3bcd-299f-49ca-e08d-6ee6febf0700">
<div class="sourceCode" id="cb222"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb222-1"><a href="#cb222-1" aria-hidden="true" tabindex="-1"></a><span class="co"># визуализируем результат</span></span>
<span id="cb222-2"><a href="#cb222-2" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> px.treemap(fm_group,</span>
<span id="cb222-3"><a href="#cb222-3" aria-hidden="true" tabindex="-1"></a>           path<span class="op">=</span>[<span class="st">&#39;fm&#39;</span>],</span>
<span id="cb222-4"><a href="#cb222-4" aria-hidden="true" tabindex="-1"></a>           values<span class="op">=</span><span class="st">&#39;count&#39;</span>)</span>
<span id="cb222-5"><a href="#cb222-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb222-6"><a href="#cb222-6" aria-hidden="true" tabindex="-1"></a>fig.data[<span class="dv">0</span>].textinfo <span class="op">=</span> <span class="st">&#39;label+value&#39;</span></span>
<span id="cb222-7"><a href="#cb222-7" aria-hidden="true" tabindex="-1"></a>fig.update_layout(title_text<span class="op">=</span><span class="ss">f&#39;Распределение моделей по значениям F и M&#39;</span>,</span>
<span id="cb222-8"><a href="#cb222-8" aria-hidden="true" tabindex="-1"></a>                  title_x<span class="op">=</span><span class="fl">0.47</span>,</span>
<span id="cb222-9"><a href="#cb222-9" aria-hidden="true" tabindex="-1"></a>                  showlegend<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb222-10"><a href="#cb222-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb222-11"><a href="#cb222-11" aria-hidden="true" tabindex="-1"></a><span class="co"># выведем графики</span></span>
<span id="cb222-12"><a href="#cb222-12" aria-hidden="true" tabindex="-1"></a>fig.show()</span></code></pre></div>
<div class="output display_data">
<html>
<head><meta charset="utf-8" /></head>
<body>
    <div>            <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_SVG"></script><script type="text/javascript">if (window.MathJax && window.MathJax.Hub && window.MathJax.Hub.Config) {window.MathJax.Hub.Config({SVG: {font: "STIX-Web"}});}</script>                <script type="text/javascript">window.PlotlyConfig = {MathJaxConfig: 'local'};</script>
        <script charset="utf-8" src="https://cdn.plot.ly/plotly-2.24.1.min.js"></script>                <div id="95e69f0f-0ded-4d95-9ff8-5cdd5a499197" class="plotly-graph-div" style="height:525px; width:100%;"></div>            <script type="text/javascript">                                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("95e69f0f-0ded-4d95-9ff8-5cdd5a499197")) {                    Plotly.newPlot(                        "95e69f0f-0ded-4d95-9ff8-5cdd5a499197",                        [{"branchvalues":"total","domain":{"x":[0.0,1.0],"y":[0.0,1.0]},"hovertemplate":"labels=%{label}\u003cbr\u003ecount=%{value}\u003cbr\u003eparent=%{parent}\u003cbr\u003eid=%{id}\u003cextra\u003e\u003c\u002fextra\u003e","ids":["11","12","21","22","23","32","33"],"labels":["11","12","21","22","23","32","33"],"name":"","parents":["","","","","","",""],"values":[10186,2211,2490,9155,2272,2537,11108],"type":"treemap","textinfo":"label+value"}],                        {"template":{"data":{"histogram2dcontour":[{"type":"histogram2dcontour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"choropleth":[{"type":"choropleth","colorbar":{"outlinewidth":0,"ticks":""}}],"histogram2d":[{"type":"histogram2d","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmap":[{"type":"heatmap","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmapgl":[{"type":"heatmapgl","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"contourcarpet":[{"type":"contourcarpet","colorbar":{"outlinewidth":0,"ticks":""}}],"contour":[{"type":"contour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"surface":[{"type":"surface","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"mesh3d":[{"type":"mesh3d","colorbar":{"outlinewidth":0,"ticks":""}}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"parcoords":[{"type":"parcoords","line":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolargl":[{"type":"scatterpolargl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"scattergeo":[{"type":"scattergeo","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolar":[{"type":"scatterpolar","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"scattergl":[{"type":"scattergl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatter3d":[{"type":"scatter3d","line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattermapbox":[{"type":"scattermapbox","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterternary":[{"type":"scatterternary","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattercarpet":[{"type":"scattercarpet","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"type":"carpet"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}],"barpolar":[{"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"pie":[{"automargin":true,"type":"pie"}]},"layout":{"autotypenumbers":"strict","colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"hovermode":"closest","hoverlabel":{"align":"left"},"paper_bgcolor":"white","plot_bgcolor":"#E5ECF6","polar":{"bgcolor":"#E5ECF6","angularaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"radialaxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"ternary":{"bgcolor":"#E5ECF6","aaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"baxis":{"gridcolor":"white","linecolor":"white","ticks":""},"caxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]]},"xaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"yaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"scene":{"xaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"yaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"zaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"geo":{"bgcolor":"white","landcolor":"#E5ECF6","subunitcolor":"white","showland":true,"showlakes":true,"lakecolor":"white"},"title":{"x":0.05},"mapbox":{"style":"light"}}},"legend":{"tracegroupgap":0},"margin":{"t":60},"title":{"text":"\u0420\u0430\u0441\u043f\u0440\u0435\u0434\u0435\u043b\u0435\u043d\u0438\u0435 \u043c\u043e\u0434\u0435\u043b\u0435\u0439 \u043f\u043e \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u044f\u043c F \u0438 M","x":0.47},"showlegend":false},                        {"responsive": true}                    ).then(function(){
                            
var gd = document.getElementById('95e69f0f-0ded-4d95-9ff8-5cdd5a499197');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })                };                            </script>        </div>
</body>
</html>
</div>
</div>
<div class="cell markdown" id="5NvctGTyQWkW">
<p>Большинство моделей авто редко покупают, да еще и за низкую цену. Но
на втором месте с небольшой разнице находятся авто которые покупают
часто и за высокую цену. Также интересны авто, которые покупают не так
часто, но за высокую цену (21) и которые, наоборот, покупаю часто за
среднюю цену (12).</p>
<p>Посмотрим, что это за авто.</p>
</div>
<div class="cell code" data-execution_count="638"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:175}"
id="8FBzyM9oQ6Os" data-outputId="dd32d320-83a4-463b-8650-3d75cf29e806">
<div class="sourceCode" id="cb223"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb223-1"><a href="#cb223-1" aria-hidden="true" tabindex="-1"></a><span class="co"># рассмотрим авто 11</span></span>
<span id="cb223-2"><a href="#cb223-2" aria-hidden="true" tabindex="-1"></a>df[df[<span class="st">&#39;fm&#39;</span>] <span class="op">==</span> <span class="st">&#39;11&#39;</span>].groupby([<span class="st">&#39;бренд&#39;</span>, <span class="st">&#39;модель&#39;</span>])[<span class="st">&#39;модель&#39;</span>].agg({<span class="st">&#39;count&#39;</span>})</span></code></pre></div>
<div class="output execute_result" data-execution_count="638">

  <div id="df-01adff4f-ae18-4a18-b527-338b18677994" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th>count</th>
    </tr>
    <tr>
      <th>бренд</th>
      <th>модель</th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="2" valign="top">hyundai</th>
      <th>elantra</th>
      <td>2062</td>
    </tr>
    <tr>
      <th>tucson</th>
      <td>3271</td>
    </tr>
    <tr>
      <th>toyota</th>
      <th>camry</th>
      <td>4853</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-01adff4f-ae18-4a18-b527-338b18677994')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-01adff4f-ae18-4a18-b527-338b18677994 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-01adff4f-ae18-4a18-b527-338b18677994');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-add362c9-5adc-4d9f-be18-8b26d6efb511">
  <button class="colab-df-quickchart" onclick="quickchart('df-add362c9-5adc-4d9f-be18-8b26d6efb511')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-add362c9-5adc-4d9f-be18-8b26d6efb511 button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>
    </div>
  </div>

</div>
</div>
<div class="cell code" data-execution_count="639"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:143}"
id="F2ZxTME5Reg-" data-outputId="82f0911a-54b2-4df7-fd4b-7f195a80d367">
<div class="sourceCode" id="cb224"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb224-1"><a href="#cb224-1" aria-hidden="true" tabindex="-1"></a><span class="co"># рассмотрим авто 21</span></span>
<span id="cb224-2"><a href="#cb224-2" aria-hidden="true" tabindex="-1"></a>df[df[<span class="st">&#39;fm&#39;</span>] <span class="op">==</span> <span class="st">&#39;21&#39;</span>].groupby([<span class="st">&#39;бренд&#39;</span>, <span class="st">&#39;модель&#39;</span>])[<span class="st">&#39;модель&#39;</span>].agg({<span class="st">&#39;count&#39;</span>})</span></code></pre></div>
<div class="output execute_result" data-execution_count="639">

  <div id="df-a632ab90-266a-47ca-82e5-10376d86b652" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th>count</th>
    </tr>
    <tr>
      <th>бренд</th>
      <th>модель</th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="2" valign="top">toyota</th>
      <th>lc prado</th>
      <td>1711</td>
    </tr>
    <tr>
      <th>lc200</th>
      <td>779</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-a632ab90-266a-47ca-82e5-10376d86b652')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-a632ab90-266a-47ca-82e5-10376d86b652 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-a632ab90-266a-47ca-82e5-10376d86b652');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-d8641553-5c2a-47f0-94a0-91bfc3857d77">
  <button class="colab-df-quickchart" onclick="quickchart('df-d8641553-5c2a-47f0-94a0-91bfc3857d77')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-d8641553-5c2a-47f0-94a0-91bfc3857d77 button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>
    </div>
  </div>

</div>
</div>
<div class="cell code" data-execution_count="640"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:112}"
id="TOpvCQR5RggX" data-outputId="f84526b6-6b61-4557-9ae7-1bba10970e1f">
<div class="sourceCode" id="cb225"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb225-1"><a href="#cb225-1" aria-hidden="true" tabindex="-1"></a><span class="co"># рассмотрим авто 12</span></span>
<span id="cb225-2"><a href="#cb225-2" aria-hidden="true" tabindex="-1"></a>df[df[<span class="st">&#39;fm&#39;</span>] <span class="op">==</span> <span class="st">&#39;12&#39;</span>].groupby([<span class="st">&#39;бренд&#39;</span>, <span class="st">&#39;модель&#39;</span>])[<span class="st">&#39;модель&#39;</span>].agg({<span class="st">&#39;count&#39;</span>})</span></code></pre></div>
<div class="output execute_result" data-execution_count="640">

  <div id="df-e9441879-4c2b-45fa-849a-a6d222bdefbb" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th>count</th>
    </tr>
    <tr>
      <th>бренд</th>
      <th>модель</th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>hyundai</th>
      <th>accent</th>
      <td>2211</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-e9441879-4c2b-45fa-849a-a6d222bdefbb')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-e9441879-4c2b-45fa-849a-a6d222bdefbb button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-e9441879-4c2b-45fa-849a-a6d222bdefbb');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>

    </div>
  </div>

</div>
</div>
<div class="cell markdown" id="-4WopAuBRSfw">
<p>Самыми топовыми авто с точки зрения частоты покупки и цены являются
Hyundai Elantra и Tuscon, а также Toyota Camry.</p>
<p>Машины, которые покупают не так часто, но приносят много денег -
Toyota Land Cruiser Prado и Land Cruiser 200.</p>
<p>Машины, которые покупают часто за среднюю цену - Hyundai Accent.</p>
<p>Дилерам следует присмотреться к данным авто для продажи.</p>
</div>
<section id="47-продажи-автомобилей-в-разрезе-бренд--сегмент"
class="cell markdown" id="LzdlwuBJfS_B">
<h2>4.7 Продажи автомобилей в разрезе бренд / сегмент</h2>
</section>
<div class="cell code" data-execution_count="641" id="UtScw24Ai_Ti">
<div class="sourceCode" id="cb226"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb226-1"><a href="#cb226-1" aria-hidden="true" tabindex="-1"></a><span class="co"># создадим функцию</span></span>
<span id="cb226-2"><a href="#cb226-2" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> revenue_by_segment(com, uncom, col1):</span>
<span id="cb226-3"><a href="#cb226-3" aria-hidden="true" tabindex="-1"></a>  <span class="co">&#39;&#39;&#39;</span></span>
<span id="cb226-4"><a href="#cb226-4" aria-hidden="true" tabindex="-1"></a><span class="co">  Функция на вход принимает 2 датафрейма коммерческго и</span></span>
<span id="cb226-5"><a href="#cb226-5" aria-hidden="true" tabindex="-1"></a><span class="co">  некоммерческого транспорта</span></span>
<span id="cb226-6"><a href="#cb226-6" aria-hidden="true" tabindex="-1"></a><span class="co">  и колонку для создания сводной таблицы по сегменту.</span></span>
<span id="cb226-7"><a href="#cb226-7" aria-hidden="true" tabindex="-1"></a><span class="co">  На выходе функция строит хитмэн продаж авто в разрезе указанных колонок.</span></span>
<span id="cb226-8"><a href="#cb226-8" aria-hidden="true" tabindex="-1"></a><span class="co">  А также выводит самый прибыльный сегмент по col1.</span></span>
<span id="cb226-9"><a href="#cb226-9" aria-hidden="true" tabindex="-1"></a><span class="co">  &#39;&#39;&#39;</span></span>
<span id="cb226-10"><a href="#cb226-10" aria-hidden="true" tabindex="-1"></a>  <span class="co"># создадим сводные таблицы</span></span>
<span id="cb226-11"><a href="#cb226-11" aria-hidden="true" tabindex="-1"></a>  <span class="co"># для коммерческого транспорта будем использовать столбец класс_2013</span></span>
<span id="cb226-12"><a href="#cb226-12" aria-hidden="true" tabindex="-1"></a>  <span class="co"># переведем в тыс.$</span></span>
<span id="cb226-13"><a href="#cb226-13" aria-hidden="true" tabindex="-1"></a>  com_grouped_df <span class="op">=</span> com.pivot_table(index<span class="op">=</span>col1,</span>
<span id="cb226-14"><a href="#cb226-14" aria-hidden="true" tabindex="-1"></a>                                  columns<span class="op">=</span><span class="st">&#39;класс_2013&#39;</span>,</span>
<span id="cb226-15"><a href="#cb226-15" aria-hidden="true" tabindex="-1"></a>                                  values<span class="op">=</span><span class="st">&#39;продажа_usd&#39;</span>,</span>
<span id="cb226-16"><a href="#cb226-16" aria-hidden="true" tabindex="-1"></a>                                  aggfunc<span class="op">=</span><span class="st">&#39;sum&#39;</span>,</span>
<span id="cb226-17"><a href="#cb226-17" aria-hidden="true" tabindex="-1"></a>                                  fill_value<span class="op">=</span><span class="dv">0</span>) <span class="op">/</span> <span class="dv">1000</span></span>
<span id="cb226-18"><a href="#cb226-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb226-19"><a href="#cb226-19" aria-hidden="true" tabindex="-1"></a>  <span class="co"># сводная таблица некоммерческого транспорта</span></span>
<span id="cb226-20"><a href="#cb226-20" aria-hidden="true" tabindex="-1"></a>  <span class="co"># для нее используем столбец сегментация_2013</span></span>
<span id="cb226-21"><a href="#cb226-21" aria-hidden="true" tabindex="-1"></a>  <span class="co"># переведем в тыс.$</span></span>
<span id="cb226-22"><a href="#cb226-22" aria-hidden="true" tabindex="-1"></a>  uncom_grouped_df <span class="op">=</span> uncom.pivot_table(index<span class="op">=</span>col1,</span>
<span id="cb226-23"><a href="#cb226-23" aria-hidden="true" tabindex="-1"></a>                                      columns<span class="op">=</span><span class="st">&#39;сегментация_2013&#39;</span>,</span>
<span id="cb226-24"><a href="#cb226-24" aria-hidden="true" tabindex="-1"></a>                                      values<span class="op">=</span><span class="st">&#39;продажа_usd&#39;</span>,</span>
<span id="cb226-25"><a href="#cb226-25" aria-hidden="true" tabindex="-1"></a>                                      aggfunc<span class="op">=</span><span class="st">&#39;sum&#39;</span>,</span>
<span id="cb226-26"><a href="#cb226-26" aria-hidden="true" tabindex="-1"></a>                                      fill_value<span class="op">=</span><span class="dv">0</span>) <span class="op">/</span> <span class="dv">1000</span></span>
<span id="cb226-27"><a href="#cb226-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb226-28"><a href="#cb226-28" aria-hidden="true" tabindex="-1"></a>  <span class="co"># построим хитмэпы</span></span>
<span id="cb226-29"><a href="#cb226-29" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> i, df_grouped <span class="kw">in</span> <span class="bu">enumerate</span>([com_grouped_df, uncom_grouped_df]):</span>
<span id="cb226-30"><a href="#cb226-30" aria-hidden="true" tabindex="-1"></a>    plt.figure(figsize<span class="op">=</span>(<span class="dv">15</span>, <span class="dv">6</span>))</span>
<span id="cb226-31"><a href="#cb226-31" aria-hidden="true" tabindex="-1"></a>    sns.heatmap(df_grouped,</span>
<span id="cb226-32"><a href="#cb226-32" aria-hidden="true" tabindex="-1"></a>                annot<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb226-33"><a href="#cb226-33" aria-hidden="true" tabindex="-1"></a>                fmt<span class="op">=</span><span class="st">&#39;.1f&#39;</span>,</span>
<span id="cb226-34"><a href="#cb226-34" aria-hidden="true" tabindex="-1"></a>                cbar<span class="op">=</span><span class="va">False</span>,</span>
<span id="cb226-35"><a href="#cb226-35" aria-hidden="true" tabindex="-1"></a>                linewidth<span class="op">=</span><span class="dv">2</span>,</span>
<span id="cb226-36"><a href="#cb226-36" aria-hidden="true" tabindex="-1"></a>                cmap<span class="op">=</span><span class="st">&#39;Blues&#39;</span>,</span>
<span id="cb226-37"><a href="#cb226-37" aria-hidden="true" tabindex="-1"></a>                vmin<span class="op">=</span><span class="dv">0</span>,</span>
<span id="cb226-38"><a href="#cb226-38" aria-hidden="true" tabindex="-1"></a>                center<span class="op">=</span><span class="dv">3000</span>,</span>
<span id="cb226-39"><a href="#cb226-39" aria-hidden="true" tabindex="-1"></a>                vmax<span class="op">=</span><span class="dv">10000</span>)</span>
<span id="cb226-40"><a href="#cb226-40" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> i <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb226-41"><a href="#cb226-41" aria-hidden="true" tabindex="-1"></a>      plt.title(<span class="ss">f&#39;Продажи коммерческих авто в разрезе </span><span class="sc">{</span>col1<span class="sc">}</span><span class="ss"> / сегмент, тыс. $&#39;</span>)</span>
<span id="cb226-42"><a href="#cb226-42" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb226-43"><a href="#cb226-43" aria-hidden="true" tabindex="-1"></a>      plt.title(<span class="ss">f&#39;Продажи некоммерческих авто в разрезе </span><span class="sc">{</span>col1<span class="sc">}</span><span class="ss"> / сегмент, тыс. $&#39;</span>)</span>
<span id="cb226-44"><a href="#cb226-44" aria-hidden="true" tabindex="-1"></a>    plt.tight_layout()</span>
<span id="cb226-45"><a href="#cb226-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb226-46"><a href="#cb226-46" aria-hidden="true" tabindex="-1"></a>    <span class="co"># создадим столбец с названием самого прибыльного сегмента</span></span>
<span id="cb226-47"><a href="#cb226-47" aria-hidden="true" tabindex="-1"></a>    df_grouped[<span class="st">&#39;прибыльный_сегмент&#39;</span>] <span class="op">=</span> df_grouped.idxmax(axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb226-48"><a href="#cb226-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb226-49"><a href="#cb226-49" aria-hidden="true" tabindex="-1"></a>    <span class="co"># выведем графики</span></span>
<span id="cb226-50"><a href="#cb226-50" aria-hidden="true" tabindex="-1"></a>    plt.show()</span>
<span id="cb226-51"><a href="#cb226-51" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(df_grouped[[<span class="st">&#39;прибыльный_сегмент&#39;</span>]])</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="642"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:1000}"
id="UyGmY9mGl66e" data-outputId="91e8f1d0-4b68-4a55-b32d-12834849d784">
<div class="sourceCode" id="cb227"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb227-1"><a href="#cb227-1" aria-hidden="true" tabindex="-1"></a>revenue_by_segment(com_df, uncom_df, <span class="st">&#39;бренд&#39;</span>)</span></code></pre></div>
<div class="output display_data">
<p><img
src="vertopal_9b40e0aaef914c45a9852524805a792d/bca70bc878b0a52923060f8b1d51231dadc5816f.png" /></p>
</div>
<div class="output stream stdout">
<pre><code>класс_2013                   прибыльный_сегмент
бренд                                          
ankai                          большие автобусы
daewoo                         большие автобусы
dong feng                      средние автобусы
foton                 крупнотоннажные грузовики
gaz                     малотоннажные грузовики
hino                    малотоннажные грузовики
hyundai truck &amp; bus     малотоннажные грузовики
isuzu                   малотоннажные грузовики
iveco                   малотоннажные грузовики
jac                   среднетоннажные грузовики
kamaz                 крупнотоннажные грузовики
man                   крупнотоннажные грузовики
mercedes-benz                     микроавтобусы
mercedes-benz trucks  крупнотоннажные грузовики
nefaz                          большие автобусы
scania                крупнотоннажные грузовики
shacman               крупнотоннажные грузовики
uaz                        развозные автомобили
volkswagen                        микроавтобусы
yutong                         средние автобусы
урал                    малотоннажные грузовики
</code></pre>
</div>
<div class="output display_data">
<p><img
src="vertopal_9b40e0aaef914c45a9852524805a792d/48687b763bd68254efaa589c7b49997f231dc5bc.png" /></p>
</div>
<div class="output stream stdout">
<pre><code>сегментация_2013   прибыльный_сегмент
бренд                                
audi                     внедорожники
bmw                      внедорожники
cadillac                 внедорожники
chevrolet                внедорожники
ford              легковые автомобили
hyundai                  внедорожники
infiniti                 внедорожники
isuzu                          пикапы
jac                      внедорожники
jaguar                   внедорожники
kia               легковые автомобили
lada              легковые автомобили
land rover               внедорожники
lexus                    внедорожники
lifan                    внедорожники
mazda                    внедорожники
mercedes-benz            внедорожники
mini                     внедорожники
mitsubishi               внедорожники
nissan                   внедорожники
peugeot           легковые автомобили
porsche                  внедорожники
ravon             легковые автомобили
renault                  внедорожники
skoda             легковые автомобили
subaru                   внедорожники
toyota            легковые автомобили
uaz                      внедорожники
volkswagen        легковые автомобили
volvo                    внедорожники
</code></pre>
</div>
</div>
<div class="cell markdown" id="y589si1yxd9A">
<p>Минивэны нигде не являются самым прибыльным сегментом. Пикапы по
прибыльности доминируют только у марки Isuzu.</p>
</div>
<section id="48-продажи-автомобилей-в-разрезе-область--сегмент"
class="cell markdown" id="ze5Nj-PkZqux">
<h2>4.8 Продажи автомобилей в разрезе область / сегмент</h2>
</section>
<div class="cell code" data-execution_count="643"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:1000}"
id="mg-2UJQIZwm0" data-outputId="f0e08e67-c5b7-4e93-8493-2d804983ac39">
<div class="sourceCode" id="cb230"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb230-1"><a href="#cb230-1" aria-hidden="true" tabindex="-1"></a><span class="co"># применим функцию</span></span>
<span id="cb230-2"><a href="#cb230-2" aria-hidden="true" tabindex="-1"></a>revenue_by_segment(com_df, uncom_df, <span class="st">&#39;область&#39;</span>)</span></code></pre></div>
<div class="output display_data">
<p><img
src="vertopal_9b40e0aaef914c45a9852524805a792d/52c9323ecdca330be7c3856bad1ccd091327d238.png" /></p>
</div>
<div class="output stream stdout">
<pre><code>класс_2013                             прибыльный_сегмент
область                                                  
акмолинская область               малотоннажные грузовики
актюбинская область             крупнотоннажные грузовики
алматинская область                  развозные автомобили
атырауская область                       большие автобусы
восточно-казахстанская область           большие автобусы
г.алматы                        крупнотоннажные грузовики
г.нур-султан                    крупнотоннажные грузовики
жамбылская область                       средние автобусы
западно-казахстанская область   крупнотоннажные грузовики
карагандинская область            малотоннажные грузовики
костанайская область                     большие автобусы
кызылординская область               развозные автомобили
мангистауская область           крупнотоннажные грузовики
павлодарская область              малотоннажные грузовики
северо-казахстанская область      малотоннажные грузовики
туркестанская область                    большие автобусы
экспорт область                 среднетоннажные грузовики
южно-казахстанская область        малотоннажные грузовики
</code></pre>
</div>
<div class="output display_data">
<p><img
src="vertopal_9b40e0aaef914c45a9852524805a792d/31089b9497f8744c328450996acb8f462e152cdf.png" /></p>
</div>
<div class="output stream stdout">
<pre><code>сегментация_2013                 прибыльный_сегмент
область                                            
акмолинская область                    внедорожники
актюбинская область                    внедорожники
алматинская область                    внедорожники
атырауская область                     внедорожники
восточно-казахстанская область         внедорожники
г.алматы                               внедорожники
г.нур-султан                           внедорожники
жамбылская область              легковые автомобили
западно-казахстанская область          внедорожники
карагандинская область                 внедорожники
костанайская область                   внедорожники
кызылординская область                 внедорожники
мангистауская область                  внедорожники
павлодарская область                   внедорожники
северо-казахстанская область           внедорожники
туркестанская область                  внедорожники
экспорт область                        внедорожники
южно-казахстанская область             внедорожники
</code></pre>
</div>
</div>
<div class="cell markdown" id="8EE82fZEZtM9">
<p>Среди некоммерческого транспорта во всех областях, кроме одной,
внедорожники составляют самый крупный по объему продаж сегмент. В
Жамбылской области доминируют легковые автомобили.</p>
</div>
<section id="49-продажи-по-регионам" class="cell markdown"
id="zNa2unpJfupT">
<h2>4.9 Продажи по регионам</h2>
</section>
<div class="cell markdown" id="G5XRuDs_tBp-">
<p>Рассмотрим продажи по регионам в денежном и количественном
значении.</p>
</div>
<div class="cell code" data-execution_count="644"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:36}"
id="yDeeZR3OvSIX" data-outputId="15856de7-3405-49dc-e91d-d314db5b1255">
<div class="sourceCode" id="cb233"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb233-1"><a href="#cb233-1" aria-hidden="true" tabindex="-1"></a><span class="ss">f&#39;Количество регионов: </span><span class="sc">{</span>df[<span class="st">&quot;область&quot;</span>]<span class="sc">.</span>nunique()<span class="sc">}</span><span class="ss">&#39;</span></span></code></pre></div>
<div class="output execute_result" data-execution_count="644">
<div class="sourceCode" id="cb234"><pre
class="sourceCode json"><code class="sourceCode json"><span id="cb234-1"><a href="#cb234-1" aria-hidden="true" tabindex="-1"></a><span class="fu">{</span><span class="dt">&quot;type&quot;</span><span class="fu">:</span><span class="st">&quot;string&quot;</span><span class="fu">}</span></span></code></pre></div>
</div>
</div>
<div class="cell code" data-execution_count="645"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:609}"
id="0oRkK2zd7YD8" data-outputId="5b53b911-9bb6-4eec-8c45-e85eaf577fc4">
<div class="sourceCode" id="cb235"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb235-1"><a href="#cb235-1" aria-hidden="true" tabindex="-1"></a><span class="co"># применим функции</span></span>
<span id="cb235-2"><a href="#cb235-2" aria-hidden="true" tabindex="-1"></a>df_usd, df_count <span class="op">=</span> compare_usd_quantity(com_df, <span class="st">&#39;область&#39;</span>, <span class="st">&#39;sum&#39;</span>, <span class="va">True</span>)</span>
<span id="cb235-3"><a href="#cb235-3" aria-hidden="true" tabindex="-1"></a>barplot(df_usd, df_count, <span class="dv">5</span>,</span>
<span id="cb235-4"><a href="#cb235-4" aria-hidden="true" tabindex="-1"></a>        <span class="st">&#39;ТОП-10 регионов по продаже коммерческого транспорта&#39;</span>)</span></code></pre></div>
<div class="output display_data">
<p><img
src="vertopal_9b40e0aaef914c45a9852524805a792d/81753de29c8be3b335398fe33af0f186d39fe861.png" /></p>
</div>
</div>
<div class="cell markdown" id="5KQCdp9pvj86">
<p>По продажам коммерческого транспорта в тыс.$ и шт. в топ-5 входят:
г.Алматы, г.Нур-Султан, Костанайская обл., Восточно-Казахстанская обл.,
Атырауская обл. Алматы лидирует с большим отрывом, так как это большой
город.</p>
<p>Худшие показатели в денежном значении у Карагандинской обл., в
количественном - у Южно-Казахстанской.</p>
</div>
<div class="cell code" data-execution_count="646"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:609}"
id="dbXtzpCYx01B" data-outputId="f1e861b1-5b71-44a8-9f85-278c4e284a5b">
<div class="sourceCode" id="cb236"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb236-1"><a href="#cb236-1" aria-hidden="true" tabindex="-1"></a><span class="co"># применим функции</span></span>
<span id="cb236-2"><a href="#cb236-2" aria-hidden="true" tabindex="-1"></a>df_usd, df_count <span class="op">=</span> compare_usd_quantity(uncom_df, <span class="st">&#39;область&#39;</span>, <span class="st">&#39;sum&#39;</span>, <span class="va">True</span>)</span>
<span id="cb236-3"><a href="#cb236-3" aria-hidden="true" tabindex="-1"></a>barplot(df_usd, df_count, <span class="dv">5</span>,</span>
<span id="cb236-4"><a href="#cb236-4" aria-hidden="true" tabindex="-1"></a>        <span class="st">&#39;ТОП-10 регионов по продаже некоммерческого транспорта&#39;</span>)</span></code></pre></div>
<div class="output display_data">
<p><img
src="vertopal_9b40e0aaef914c45a9852524805a792d/645ab3fe50107e9e0c5de53792999c7db14194aa.png" /></p>
</div>
</div>
<div class="cell markdown" id="C7jQGPM7ygOB">
<p>По продажам некоммерческого транспорта в тыс.$ и шт. в топ-5 входят:
г.Алматы, г.Нур-Султан, Костанайская обл., Южно-Казахстанская обл.,
Атырауская обл. Алматы и Нур-Султан лидируют с большим отрывом, так как
это большие города.</p>
<p>Худшие показатели в денежном значении у Магнистауской обл., в
количественном - у Павлодарской.</p>
</div>
<div class="cell markdown" id="cD-7m3Htzqq_">
<p>Теперь посмотрим сколько различных компаний в каждом регионе, а также
количество продающихся марок и моделей.</p>
</div>
<div class="cell code" data-execution_count="647" id="LOFgZM_o1Ihv">
<div class="sourceCode" id="cb237"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb237-1"><a href="#cb237-1" aria-hidden="true" tabindex="-1"></a><span class="co"># создадим функцию</span></span>
<span id="cb237-2"><a href="#cb237-2" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> graphs_quantity(df_auto, title):</span>
<span id="cb237-3"><a href="#cb237-3" aria-hidden="true" tabindex="-1"></a>  <span class="co">&#39;&#39;&#39;</span></span>
<span id="cb237-4"><a href="#cb237-4" aria-hidden="true" tabindex="-1"></a><span class="co">  На вход функция принимает датафрейм и название графика.</span></span>
<span id="cb237-5"><a href="#cb237-5" aria-hidden="true" tabindex="-1"></a><span class="co">  На выходе выводит 3 графика</span></span>
<span id="cb237-6"><a href="#cb237-6" aria-hidden="true" tabindex="-1"></a><span class="co">  &#39;&#39;&#39;</span></span>
<span id="cb237-7"><a href="#cb237-7" aria-hidden="true" tabindex="-1"></a>  <span class="co"># посчитаем количество компаний в каждой области</span></span>
<span id="cb237-8"><a href="#cb237-8" aria-hidden="true" tabindex="-1"></a>  region_company_count <span class="op">=</span> (</span>
<span id="cb237-9"><a href="#cb237-9" aria-hidden="true" tabindex="-1"></a>      df_auto.groupby(<span class="st">&#39;область&#39;</span>)[<span class="st">&#39;компания&#39;</span>].nunique()</span>
<span id="cb237-10"><a href="#cb237-10" aria-hidden="true" tabindex="-1"></a>      .sort_values(ascending<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb237-11"><a href="#cb237-11" aria-hidden="true" tabindex="-1"></a>      .reset_index()</span>
<span id="cb237-12"><a href="#cb237-12" aria-hidden="true" tabindex="-1"></a>      .rename(columns<span class="op">=</span>{<span class="st">&#39;компания&#39;</span>: <span class="st">&#39;количество_компаний&#39;</span>})</span>
<span id="cb237-13"><a href="#cb237-13" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb237-14"><a href="#cb237-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-15"><a href="#cb237-15" aria-hidden="true" tabindex="-1"></a>  <span class="co"># посчитаем количество брендов в каждой области</span></span>
<span id="cb237-16"><a href="#cb237-16" aria-hidden="true" tabindex="-1"></a>  region_brand_count <span class="op">=</span> (</span>
<span id="cb237-17"><a href="#cb237-17" aria-hidden="true" tabindex="-1"></a>      df_auto.groupby(<span class="st">&#39;область&#39;</span>)[<span class="st">&#39;бренд&#39;</span>].nunique()</span>
<span id="cb237-18"><a href="#cb237-18" aria-hidden="true" tabindex="-1"></a>      .sort_values(ascending<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb237-19"><a href="#cb237-19" aria-hidden="true" tabindex="-1"></a>      .reset_index()</span>
<span id="cb237-20"><a href="#cb237-20" aria-hidden="true" tabindex="-1"></a>      .rename(columns<span class="op">=</span>{<span class="st">&#39;бренд&#39;</span>: <span class="st">&#39;количество_марок&#39;</span>})</span>
<span id="cb237-21"><a href="#cb237-21" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb237-22"><a href="#cb237-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-23"><a href="#cb237-23" aria-hidden="true" tabindex="-1"></a>  <span class="co"># посчитаем количество моделей в каждой области</span></span>
<span id="cb237-24"><a href="#cb237-24" aria-hidden="true" tabindex="-1"></a>  region_model_count <span class="op">=</span> (</span>
<span id="cb237-25"><a href="#cb237-25" aria-hidden="true" tabindex="-1"></a>      df_auto.groupby(<span class="st">&#39;область&#39;</span>)[<span class="st">&#39;модель&#39;</span>].nunique()</span>
<span id="cb237-26"><a href="#cb237-26" aria-hidden="true" tabindex="-1"></a>      .sort_values(ascending<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb237-27"><a href="#cb237-27" aria-hidden="true" tabindex="-1"></a>      .reset_index()</span>
<span id="cb237-28"><a href="#cb237-28" aria-hidden="true" tabindex="-1"></a>      .rename(columns<span class="op">=</span>{<span class="st">&#39;модель&#39;</span>: <span class="st">&#39;количество_моделей&#39;</span>})</span>
<span id="cb237-29"><a href="#cb237-29" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb237-30"><a href="#cb237-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-31"><a href="#cb237-31" aria-hidden="true" tabindex="-1"></a>  <span class="co"># создадим сетку графиков</span></span>
<span id="cb237-32"><a href="#cb237-32" aria-hidden="true" tabindex="-1"></a>  fig, ax <span class="op">=</span> plt.subplots(<span class="dv">2</span>, <span class="dv">2</span>, figsize<span class="op">=</span>(<span class="dv">15</span>,<span class="dv">8</span>))</span>
<span id="cb237-33"><a href="#cb237-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-34"><a href="#cb237-34" aria-hidden="true" tabindex="-1"></a>  <span class="co"># приведем переменную ax к одномерному массиву для удобства</span></span>
<span id="cb237-35"><a href="#cb237-35" aria-hidden="true" tabindex="-1"></a>  ax<span class="op">=</span>ax.flatten()</span>
<span id="cb237-36"><a href="#cb237-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-37"><a href="#cb237-37" aria-hidden="true" tabindex="-1"></a>  <span class="co"># установим цвета для топ-5 областей</span></span>
<span id="cb237-38"><a href="#cb237-38" aria-hidden="true" tabindex="-1"></a>  colors <span class="op">=</span> [<span class="st">&#39;lightgray&#39;</span>] <span class="op">*</span> <span class="bu">len</span>(df_auto[<span class="st">&#39;область&#39;</span>].unique())</span>
<span id="cb237-39"><a href="#cb237-39" aria-hidden="true" tabindex="-1"></a>  colors[<span class="dv">0</span>], colors[<span class="dv">1</span>], colors[<span class="dv">2</span>], colors[<span class="dv">3</span>], colors[<span class="dv">4</span>] <span class="op">=</span> <span class="st">&#39;#051094&#39;</span>, <span class="st">&#39;#051094&#39;</span>, <span class="op">\</span></span>
<span id="cb237-40"><a href="#cb237-40" aria-hidden="true" tabindex="-1"></a>  <span class="st">&#39;#051094&#39;</span>, <span class="st">&#39;#051094&#39;</span>, <span class="st">&#39;#051094&#39;</span></span>
<span id="cb237-41"><a href="#cb237-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-42"><a href="#cb237-42" aria-hidden="true" tabindex="-1"></a>  <span class="co"># построим первый график</span></span>
<span id="cb237-43"><a href="#cb237-43" aria-hidden="true" tabindex="-1"></a>  sns.barplot(region_company_count,</span>
<span id="cb237-44"><a href="#cb237-44" aria-hidden="true" tabindex="-1"></a>              x<span class="op">=</span><span class="st">&#39;количество_компаний&#39;</span>,</span>
<span id="cb237-45"><a href="#cb237-45" aria-hidden="true" tabindex="-1"></a>              y<span class="op">=</span><span class="st">&#39;область&#39;</span>,</span>
<span id="cb237-46"><a href="#cb237-46" aria-hidden="true" tabindex="-1"></a>              ax<span class="op">=</span>ax[<span class="dv">0</span>],</span>
<span id="cb237-47"><a href="#cb237-47" aria-hidden="true" tabindex="-1"></a>              palette<span class="op">=</span>colors)</span>
<span id="cb237-48"><a href="#cb237-48" aria-hidden="true" tabindex="-1"></a>  ax[<span class="dv">0</span>].<span class="bu">set</span>(title<span class="op">=</span><span class="st">&#39;Количество компаний в областях&#39;</span>)</span>
<span id="cb237-49"><a href="#cb237-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-50"><a href="#cb237-50" aria-hidden="true" tabindex="-1"></a>  <span class="co"># построим второй график</span></span>
<span id="cb237-51"><a href="#cb237-51" aria-hidden="true" tabindex="-1"></a>  sns.barplot(region_brand_count,</span>
<span id="cb237-52"><a href="#cb237-52" aria-hidden="true" tabindex="-1"></a>              x<span class="op">=</span><span class="st">&#39;количество_марок&#39;</span>,</span>
<span id="cb237-53"><a href="#cb237-53" aria-hidden="true" tabindex="-1"></a>              y<span class="op">=</span><span class="st">&#39;область&#39;</span>,</span>
<span id="cb237-54"><a href="#cb237-54" aria-hidden="true" tabindex="-1"></a>              ax<span class="op">=</span>ax[<span class="dv">1</span>],</span>
<span id="cb237-55"><a href="#cb237-55" aria-hidden="true" tabindex="-1"></a>              palette<span class="op">=</span>colors)</span>
<span id="cb237-56"><a href="#cb237-56" aria-hidden="true" tabindex="-1"></a>  ax[<span class="dv">1</span>].<span class="bu">set</span>(title<span class="op">=</span><span class="st">&#39;Количество марок авто в областях&#39;</span>)</span>
<span id="cb237-57"><a href="#cb237-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-58"><a href="#cb237-58" aria-hidden="true" tabindex="-1"></a>  <span class="co"># построим третий график</span></span>
<span id="cb237-59"><a href="#cb237-59" aria-hidden="true" tabindex="-1"></a>  sns.barplot(region_model_count,</span>
<span id="cb237-60"><a href="#cb237-60" aria-hidden="true" tabindex="-1"></a>              x<span class="op">=</span><span class="st">&#39;количество_моделей&#39;</span>,</span>
<span id="cb237-61"><a href="#cb237-61" aria-hidden="true" tabindex="-1"></a>              y<span class="op">=</span><span class="st">&#39;область&#39;</span>,</span>
<span id="cb237-62"><a href="#cb237-62" aria-hidden="true" tabindex="-1"></a>              ax<span class="op">=</span>ax[<span class="dv">2</span>],</span>
<span id="cb237-63"><a href="#cb237-63" aria-hidden="true" tabindex="-1"></a>              palette<span class="op">=</span>colors)</span>
<span id="cb237-64"><a href="#cb237-64" aria-hidden="true" tabindex="-1"></a>  ax[<span class="dv">2</span>].<span class="bu">set</span>(title<span class="op">=</span><span class="st">&#39;Количество моделей авто в областях&#39;</span>)</span>
<span id="cb237-65"><a href="#cb237-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-66"><a href="#cb237-66" aria-hidden="true" tabindex="-1"></a>  <span class="co"># зададим общее название графиков</span></span>
<span id="cb237-67"><a href="#cb237-67" aria-hidden="true" tabindex="-1"></a>  plt.suptitle(title)</span>
<span id="cb237-68"><a href="#cb237-68" aria-hidden="true" tabindex="-1"></a>  plt.tight_layout()</span>
<span id="cb237-69"><a href="#cb237-69" aria-hidden="true" tabindex="-1"></a>  <span class="co"># удалим пустой график</span></span>
<span id="cb237-70"><a href="#cb237-70" aria-hidden="true" tabindex="-1"></a>  plt.delaxes(ax[<span class="dv">3</span>])</span>
<span id="cb237-71"><a href="#cb237-71" aria-hidden="true" tabindex="-1"></a>  plt.show()</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="648"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:805}"
id="ew5OoUie1DM4" data-outputId="0550169e-c2aa-4707-acd2-fdcf4c6ca102">
<div class="sourceCode" id="cb238"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb238-1"><a href="#cb238-1" aria-hidden="true" tabindex="-1"></a><span class="co"># коммерческий транспорт</span></span>
<span id="cb238-2"><a href="#cb238-2" aria-hidden="true" tabindex="-1"></a>graphs_quantity(com_df, <span class="st">&#39;Коммерческий транспорт&#39;</span>)</span></code></pre></div>
<div class="output display_data">
<p><img
src="vertopal_9b40e0aaef914c45a9852524805a792d/ecc800f1b4efc4fd1d8097810accf0e6dd7222d5.png" /></p>
</div>
</div>
<div class="cell markdown" id="pvhL4tFEt279">
<p>По коммерческому транспорту ТОП-5 областей по количеству дилеров:</p>
<ul>
<li>г. Алматы;</li>
<li>Атырауская обл.;</li>
<li>Костанайская обл.;</li>
<li>Актюбинская обл.;</li>
<li>г. Нур-Султан.</li>
</ul>
<p>По количеству марок авто:</p>
<ul>
<li>г. Алматы;</li>
<li>г. Нур-Султан;</li>
<li>Костанайская обл.;</li>
<li>Атырауская обл.;</li>
<li>Восточно-Казахстанская обл.</li>
</ul>
<p>По количеству моделей авто:</p>
<ul>
<li>г. Алматы;</li>
<li>г. Нур-Султан;</li>
<li>Актюбинская обл.;</li>
<li>Костанайская обл.;</li>
<li>Атырауская обл.</li>
</ul>
</div>
<div class="cell code" data-execution_count="649"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:805}"
id="Egc7SqDz3wMn" data-outputId="447df906-3750-4811-d07a-10b167a9352f">
<div class="sourceCode" id="cb239"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb239-1"><a href="#cb239-1" aria-hidden="true" tabindex="-1"></a><span class="co"># некоммерческий транспорт</span></span>
<span id="cb239-2"><a href="#cb239-2" aria-hidden="true" tabindex="-1"></a>graphs_quantity(uncom_df, <span class="st">&#39;Некоммерческий транспорт&#39;</span>)</span></code></pre></div>
<div class="output display_data">
<p><img
src="vertopal_9b40e0aaef914c45a9852524805a792d/647c12dc5cbc5bf3e39551b821d79a9fdf5da5b9.png" /></p>
</div>
</div>
<div class="cell markdown" id="gbIZpyCi33Eh">
<p>По некоммерческому транспорту ТОП-5 областей по количеству
дилеров:</p>
<ul>
<li>г. Алматы;</li>
<li>г. Нур-Султан;</li>
<li>Атырауская обл.;</li>
<li>Костанайская обл.;</li>
<li>Карагандинская обл.</li>
</ul>
<p>По количеству марок авто:</p>
<ul>
<li>г. Алматы;</li>
<li>г. Нур-Султан;</li>
<li>Костанайская обл.;</li>
<li>Карагандинская обл.</li>
<li>Атырауская обл.</li>
</ul>
<p>По количеству моделей авто:</p>
<ul>
<li>г. Алматы;</li>
<li>г. Нур-Султан;</li>
<li>Костанайская обл.;</li>
<li>Атырауская обл.;</li>
<li>Карагандинская обл.</li>
</ul>
</div>
<section
id="410-стоимость-автомобиля-зависит-от-уровня-развития-региона-средней-заработной-платы-по-региону"
class="cell markdown" id="rdVlgV89fxjw">
<h2>4.10 Стоимость автомобиля зависит от уровня развития региона
(средней заработной платы по региону)</h2>
</section>
<div class="cell markdown" id="wwB3beVWgLGs">
<p>Проверим гипотезу о том, что стоимость автомобиля зависит от уровня
развития региона (средней заработной платы по региону).</p>
</div>
<div class="cell code" data-execution_count="650" id="GGWW3hPFgHUT">
<div class="sourceCode" id="cb240"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb240-1"><a href="#cb240-1" aria-hidden="true" tabindex="-1"></a><span class="co"># найдем среднюю зп для регионов</span></span>
<span id="cb240-2"><a href="#cb240-2" aria-hidden="true" tabindex="-1"></a>salary_dict <span class="op">=</span> {</span>
<span id="cb240-3"><a href="#cb240-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;г.алматы&#39;</span>: <span class="dv">224158</span>,</span>
<span id="cb240-4"><a href="#cb240-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;г.нур-султан&#39;</span>: <span class="dv">226796</span>,</span>
<span id="cb240-5"><a href="#cb240-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;восточно-казахстанская область&#39;</span>: <span class="dv">162182</span>,</span>
<span id="cb240-6"><a href="#cb240-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;западно-казахстанская область&#39;</span>: <span class="dv">183914</span>,</span>
<span id="cb240-7"><a href="#cb240-7" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;костанайская область&#39;</span>: <span class="dv">145890</span>,</span>
<span id="cb240-8"><a href="#cb240-8" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;павлодарская область&#39;</span>: <span class="dv">160670</span>,</span>
<span id="cb240-9"><a href="#cb240-9" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;южно-казахстанская область&#39;</span>: <span class="dv">110254</span>,</span>
<span id="cb240-10"><a href="#cb240-10" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;мангистауская область&#39;</span>: <span class="dv">294099</span>,</span>
<span id="cb240-11"><a href="#cb240-11" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;атырауская область&#39;</span>: <span class="dv">351103</span>,</span>
<span id="cb240-12"><a href="#cb240-12" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;актюбинская область&#39;</span>: <span class="dv">156595</span>,</span>
<span id="cb240-13"><a href="#cb240-13" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;карагандинская область&#39;</span>: <span class="dv">172239</span>,</span>
<span id="cb240-14"><a href="#cb240-14" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;северо-казахстанская область&#39;</span>: <span class="dv">130233</span>,</span>
<span id="cb240-15"><a href="#cb240-15" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;акмолинская область&#39;</span>: <span class="dv">140272</span>,</span>
<span id="cb240-16"><a href="#cb240-16" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;кызылординская область&#39;</span>: <span class="dv">152085</span>,</span>
<span id="cb240-17"><a href="#cb240-17" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;жамбылская область&#39;</span>: <span class="dv">127043</span>,</span>
<span id="cb240-18"><a href="#cb240-18" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;туркестанская область&#39;</span>: <span class="dv">123853</span>,</span>
<span id="cb240-19"><a href="#cb240-19" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;алматинская область&#39;</span>: <span class="dv">136212</span></span>
<span id="cb240-20"><a href="#cb240-20" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="651"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:582}"
id="x6X3JbqGhS-E" data-outputId="5be48d2c-ab3e-4c7d-f600-eb27c44f3760">
<div class="sourceCode" id="cb241"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb241-1"><a href="#cb241-1" aria-hidden="true" tabindex="-1"></a><span class="co"># построим таблицу областей и средней цены авто</span></span>
<span id="cb241-2"><a href="#cb241-2" aria-hidden="true" tabindex="-1"></a>region_mean <span class="op">=</span> (</span>
<span id="cb241-3"><a href="#cb241-3" aria-hidden="true" tabindex="-1"></a>    df[df[<span class="st">&#39;область&#39;</span>] <span class="op">!=</span> <span class="st">&#39;экспорт область&#39;</span>]</span>
<span id="cb241-4"><a href="#cb241-4" aria-hidden="true" tabindex="-1"></a>    .groupby(<span class="st">&#39;область&#39;</span>)[<span class="st">&#39;цена_usd&#39;</span>]</span>
<span id="cb241-5"><a href="#cb241-5" aria-hidden="true" tabindex="-1"></a>    .mean()</span>
<span id="cb241-6"><a href="#cb241-6" aria-hidden="true" tabindex="-1"></a>    .reset_index()</span>
<span id="cb241-7"><a href="#cb241-7" aria-hidden="true" tabindex="-1"></a>    .rename(columns<span class="op">=</span>{<span class="st">&#39;цена_usd&#39;</span>: <span class="st">&#39;средняя_цена_авто, $&#39;</span>})</span>
<span id="cb241-8"><a href="#cb241-8" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb241-9"><a href="#cb241-9" aria-hidden="true" tabindex="-1"></a>region_mean</span></code></pre></div>
<div class="output execute_result" data-execution_count="651">

  <div id="df-347e3d17-e9b2-4d82-b4e8-e8f2d83f64bd" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>область</th>
      <th>средняя_цена_авто, $</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>акмолинская область</td>
      <td>17299.79</td>
    </tr>
    <tr>
      <th>1</th>
      <td>актюбинская область</td>
      <td>28889.65</td>
    </tr>
    <tr>
      <th>2</th>
      <td>алматинская область</td>
      <td>17831.90</td>
    </tr>
    <tr>
      <th>3</th>
      <td>атырауская область</td>
      <td>27058.52</td>
    </tr>
    <tr>
      <th>4</th>
      <td>восточно-казахстанская область</td>
      <td>22692.36</td>
    </tr>
    <tr>
      <th>5</th>
      <td>г.алматы</td>
      <td>32564.12</td>
    </tr>
    <tr>
      <th>6</th>
      <td>г.нур-султан</td>
      <td>30964.51</td>
    </tr>
    <tr>
      <th>7</th>
      <td>жамбылская область</td>
      <td>16991.64</td>
    </tr>
    <tr>
      <th>8</th>
      <td>западно-казахстанская область</td>
      <td>25198.36</td>
    </tr>
    <tr>
      <th>9</th>
      <td>карагандинская область</td>
      <td>23193.73</td>
    </tr>
    <tr>
      <th>10</th>
      <td>костанайская область</td>
      <td>31496.76</td>
    </tr>
    <tr>
      <th>11</th>
      <td>кызылординская область</td>
      <td>16457.97</td>
    </tr>
    <tr>
      <th>12</th>
      <td>мангистауская область</td>
      <td>27245.25</td>
    </tr>
    <tr>
      <th>13</th>
      <td>павлодарская область</td>
      <td>22972.77</td>
    </tr>
    <tr>
      <th>14</th>
      <td>северо-казахстанская область</td>
      <td>19021.46</td>
    </tr>
    <tr>
      <th>15</th>
      <td>туркестанская область</td>
      <td>44879.53</td>
    </tr>
    <tr>
      <th>16</th>
      <td>южно-казахстанская область</td>
      <td>25031.68</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-347e3d17-e9b2-4d82-b4e8-e8f2d83f64bd')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-347e3d17-e9b2-4d82-b4e8-e8f2d83f64bd button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-347e3d17-e9b2-4d82-b4e8-e8f2d83f64bd');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-cf6e3ec0-9aba-46d4-a60d-7a6d05751759">
  <button class="colab-df-quickchart" onclick="quickchart('df-cf6e3ec0-9aba-46d4-a60d-7a6d05751759')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-cf6e3ec0-9aba-46d4-a60d-7a6d05751759 button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>
    </div>
  </div>

</div>
</div>
<div class="cell code" data-execution_count="652" id="fXuyJsexhsHa">
<div class="sourceCode" id="cb242"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb242-1"><a href="#cb242-1" aria-hidden="true" tabindex="-1"></a><span class="co"># создадим столбец средней зп</span></span>
<span id="cb242-2"><a href="#cb242-2" aria-hidden="true" tabindex="-1"></a>region_mean[<span class="st">&#39;средняя_зп, Т&#39;</span>] <span class="op">=</span> region_mean[<span class="st">&#39;область&#39;</span>].<span class="bu">map</span>(salary_dict)</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="653"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:607}"
id="C4ljjGUPjFTg" data-outputId="01027a0c-2508-49ba-c501-41bc0d330856">
<div class="sourceCode" id="cb243"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb243-1"><a href="#cb243-1" aria-hidden="true" tabindex="-1"></a><span class="co"># построим график</span></span>
<span id="cb243-2"><a href="#cb243-2" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">15</span>, <span class="dv">6</span>))</span>
<span id="cb243-3"><a href="#cb243-3" aria-hidden="true" tabindex="-1"></a>sns.scatterplot(region_mean, x<span class="op">=</span><span class="st">&#39;средняя_цена_авто, $&#39;</span>, y<span class="op">=</span><span class="st">&#39;средняя_зп, Т&#39;</span>)</span>
<span id="cb243-4"><a href="#cb243-4" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">&#39;Зависимость стоимости авто от средней зп по региону&#39;</span>)</span>
<span id="cb243-5"><a href="#cb243-5" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()<span class="op">;</span></span></code></pre></div>
<div class="output display_data">
<p><img
src="vertopal_9b40e0aaef914c45a9852524805a792d/3ced90a8e91aaf6844211ad067b832e9f971bb94.png" /></p>
</div>
</div>
<div class="cell code" data-execution_count="654"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="8YX6a2OGo4i-" data-outputId="2cfb9715-bcf0-4263-da2b-ab0bc6cf6055">
<div class="sourceCode" id="cb244"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb244-1"><a href="#cb244-1" aria-hidden="true" tabindex="-1"></a><span class="co">#,  посчитаем коэффициент корреляции</span></span>
<span id="cb244-2"><a href="#cb244-2" aria-hidden="true" tabindex="-1"></a>np.corrcoef(region_mean[<span class="st">&#39;средняя_цена_авто, $&#39;</span>], region_mean[<span class="st">&#39;средняя_зп, Т&#39;</span>])[<span class="dv">0</span>, <span class="dv">1</span>]</span></code></pre></div>
<div class="output execute_result" data-execution_count="654">
<pre><code>0.19767867236257947</code></pre>
</div>
</div>
<div class="cell markdown" id="yu3PqdGVp4yn">
<p>Зависимости между стоимостью автомобиля и средней зп по региону
нет.</p>
</div>
<section id="411-продажи-автоцентров" class="cell markdown"
id="F1RUMaRWgRxT">
<h2>4.11 Продажи автоцентров</h2>
</section>
<div class="cell markdown" id="zOuRGU7-dZQd">
<p>Рассмотрим продажи автоцентров как в денежном, так и в рыночном
значении.</p>
</div>
<div class="cell code" data-execution_count="655"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:609}"
id="urvfHDWRdlh3" data-outputId="91e8b04b-b2ed-4fea-f144-eadb656ba5b2">
<div class="sourceCode" id="cb246"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb246-1"><a href="#cb246-1" aria-hidden="true" tabindex="-1"></a><span class="co"># коммерческое авто</span></span>
<span id="cb246-2"><a href="#cb246-2" aria-hidden="true" tabindex="-1"></a>df_usd, df_count <span class="op">=</span> compare_usd_quantity(com_df, <span class="st">&#39;компания&#39;</span>, <span class="st">&#39;sum&#39;</span>, <span class="va">False</span>)</span>
<span id="cb246-3"><a href="#cb246-3" aria-hidden="true" tabindex="-1"></a>barplot(df_usd, df_count, <span class="dv">5</span>, <span class="st">&#39;Продажи коммерческого авто по компаниям&#39;</span>)</span></code></pre></div>
<div class="output display_data">
<p><img
src="vertopal_9b40e0aaef914c45a9852524805a792d/56fcd98fdbb299ada3434c82503413b43be42ac3.png" /></p>
</div>
</div>
<div class="cell markdown" id="50lMmJgcdwCt">
<p>Лидерами по денежному объему продажи коммерческого транспорта
являются:</p>
<ul>
<li>ТК Камаз;</li>
<li>allur auto;</li>
<li>вираж;</li>
<li>семаз;</li>
<li>daewoo bus kazakhstan.</li>
</ul>
<p>Лидерами по количественному объему являются:</p>
<ul>
<li>вираж;</li>
<li>ТК Камаз;</li>
<li>allur auto;</li>
<li>бипэк авто;</li>
<li>семаз.</li>
</ul>
</div>
<div class="cell code" data-execution_count="656"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:609}"
id="Qt4Q3A7e5Cu-" data-outputId="7b746a40-0195-4674-d199-db3e9e666b61">
<div class="sourceCode" id="cb247"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb247-1"><a href="#cb247-1" aria-hidden="true" tabindex="-1"></a><span class="co"># некоммерческое авто</span></span>
<span id="cb247-2"><a href="#cb247-2" aria-hidden="true" tabindex="-1"></a>df_usd, df_count <span class="op">=</span> compare_usd_quantity(uncom_df, <span class="st">&#39;компания&#39;</span>, <span class="st">&#39;sum&#39;</span>, <span class="va">False</span>)</span>
<span id="cb247-3"><a href="#cb247-3" aria-hidden="true" tabindex="-1"></a>barplot(df_usd, df_count, <span class="dv">5</span>, <span class="st">&#39;Продажи некоммерческого авто по компаниям&#39;</span>)</span></code></pre></div>
<div class="output display_data">
<p><img
src="vertopal_9b40e0aaef914c45a9852524805a792d/f462d96abe5d3b74c0e2ffe030816157b4de36e0.png" /></p>
</div>
</div>
<div class="cell markdown" id="3-EKDE4T4-kw">
<p>Лидерами по денежному объему продажи некоммерческого транспорта
являются:</p>
<ul>
<li>toyota motor kazakhstan;</li>
<li>astana motors;</li>
<li>бипэк авто;</li>
<li>nissan manufacturing rus;</li>
<li>автоцентр-бавария.</li>
</ul>
<p>Лидерами по количественному объему являются:</p>
<ul>
<li>бипэк авто;</li>
<li>toyota motor kazakhstan;</li>
<li>astana motors;</li>
<li>allur auto;</li>
<li>Renault Россия.</li>
</ul>
</div>
<section id="412-модели-лидеры-на-рынке" class="cell markdown"
id="65sYOa1LgVAU">
<h2>4.12 Модели-лидеры на рынке</h2>
</section>
<div class="cell markdown" id="BJMK4e4WgwO-">
<p>Выделим ТОП-10 моделей-лидеров на рынке автомобилей.</p>
</div>
<div class="cell code" data-execution_count="657"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:609}"
id="FLIL8OCQfOna" data-outputId="760f5c1c-ff41-4f1d-925e-793c53913af1">
<div class="sourceCode" id="cb248"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb248-1"><a href="#cb248-1" aria-hidden="true" tabindex="-1"></a><span class="co"># коммерческие авто</span></span>
<span id="cb248-2"><a href="#cb248-2" aria-hidden="true" tabindex="-1"></a>df_usd, df_count <span class="op">=</span> compare_usd_quantity(com_df, <span class="st">&#39;авто&#39;</span>, <span class="st">&#39;sum&#39;</span>, <span class="va">True</span>)</span>
<span id="cb248-3"><a href="#cb248-3" aria-hidden="true" tabindex="-1"></a>barplot(df_usd, df_count, <span class="dv">3</span>,</span>
<span id="cb248-4"><a href="#cb248-4" aria-hidden="true" tabindex="-1"></a>        <span class="st">&#39;ТОП-10 моделей лидеров на рынке коммерческого авто&#39;</span>)</span></code></pre></div>
<div class="output display_data">
<p><img
src="vertopal_9b40e0aaef914c45a9852524805a792d/7a654aa7c8a83e1341f5f8b552fa0e45685e162e.png" /></p>
</div>
</div>
<div class="cell markdown" id="ClFOmI3BnI0o">
<p>Среди коммерческих авто лидерами в денежном отношении являются ankai
hff6850g, gaz 3302, kamaz 65115. В количественном отношении - gaz 3302,
gaz next, uaz3909.</p>
</div>
<div class="cell code" data-execution_count="658"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:609}"
id="UVnRGGC38tot" data-outputId="6d16f57a-b488-4def-d627-6549d90aa8fe">
<div class="sourceCode" id="cb249"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb249-1"><a href="#cb249-1" aria-hidden="true" tabindex="-1"></a><span class="co"># некоммерческие авто</span></span>
<span id="cb249-2"><a href="#cb249-2" aria-hidden="true" tabindex="-1"></a>df_usd, df_count <span class="op">=</span> compare_usd_quantity(uncom_df, <span class="st">&#39;авто&#39;</span>, <span class="st">&#39;sum&#39;</span>, <span class="va">True</span>)</span>
<span id="cb249-3"><a href="#cb249-3" aria-hidden="true" tabindex="-1"></a>barplot(df_usd, df_count, <span class="dv">3</span>,</span>
<span id="cb249-4"><a href="#cb249-4" aria-hidden="true" tabindex="-1"></a>        <span class="st">&#39;ТОП-10 моделей лидеров на рынке некоммерческого авто&#39;</span>)</span></code></pre></div>
<div class="output display_data">
<p><img
src="vertopal_9b40e0aaef914c45a9852524805a792d/53645b70e0753783596f49aa9dd89b151364d12b.png" /></p>
</div>
</div>
<div class="cell markdown" id="NWWq3FZ1822O">
<p>Среди некоммерческих авто лидером в денежном и количественном
отношении на рынке является toyota camry. По продажам в деньгах дальше
идет hyundai tuscon и toyota lc prado. По количеству проданных авто на
втором месте lada granta и дальше hyundai tuscon.</p>
</div>
<section id="413-продажи-по-характеристикам" class="cell markdown"
id="YbXsnRq9M0HZ">
<h2>4.13 Продажи по характеристикам</h2>
</section>
<div class="cell markdown" id="z5JlRkGkUZS3">
<p>Найдем продажи в денежном и количественном значении для каждой
характеристики коммерческого и некоммерческого транспорта.</p>
</div>
<div class="cell code" data-execution_count="659" id="zs8Tulb_V-6l">
<div class="sourceCode" id="cb250"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb250-1"><a href="#cb250-1" aria-hidden="true" tabindex="-1"></a><span class="co"># создадим список характеристик авто</span></span>
<span id="cb250-2"><a href="#cb250-2" aria-hidden="true" tabindex="-1"></a>car_char <span class="op">=</span> [<span class="st">&#39;вид_топлива&#39;</span>, <span class="st">&#39;объем_двиг_кат&#39;</span>, <span class="st">&#39;коробка_передач&#39;</span>, <span class="st">&#39;тип_привода&#39;</span>]</span></code></pre></div>
</div>
<section id="4131-коммерческий-транспорт" class="cell markdown"
id="gwpG3tl6Um_f">
<h3>4.13.1 Коммерческий транспорт</h3>
</section>
<div class="cell markdown" id="tr8qPVpNUvZz">
<p>Посчитаем объем продаж в тыс.$</p>
</div>
<div class="cell code" data-execution_count="660"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:806}"
id="kFK8OT-zUznv" data-outputId="3a6a4deb-d984-4b7b-bc6a-4147267c667d">
<div class="sourceCode" id="cb251"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb251-1"><a href="#cb251-1" aria-hidden="true" tabindex="-1"></a><span class="co"># построим сетку графиков</span></span>
<span id="cb251-2"><a href="#cb251-2" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(<span class="dv">2</span>, <span class="dv">2</span>, figsize<span class="op">=</span>(<span class="dv">15</span>, <span class="dv">8</span>), sharey<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb251-3"><a href="#cb251-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb251-4"><a href="#cb251-4" aria-hidden="true" tabindex="-1"></a><span class="co"># зададим общий заголово</span></span>
<span id="cb251-5"><a href="#cb251-5" aria-hidden="true" tabindex="-1"></a>plt.suptitle(<span class="st">&#39;Объем продаж коммерческого транспорта по категориям&#39;</span>)</span>
<span id="cb251-6"><a href="#cb251-6" aria-hidden="true" tabindex="-1"></a>ax <span class="op">=</span> ax.flatten()</span>
<span id="cb251-7"><a href="#cb251-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb251-8"><a href="#cb251-8" aria-hidden="true" tabindex="-1"></a><span class="co"># построим график для каждого столбца</span></span>
<span id="cb251-9"><a href="#cb251-9" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i, col <span class="kw">in</span> <span class="bu">enumerate</span>(car_char):</span>
<span id="cb251-10"><a href="#cb251-10" aria-hidden="true" tabindex="-1"></a>  <span class="co"># построим сводную таблицу</span></span>
<span id="cb251-11"><a href="#cb251-11" aria-hidden="true" tabindex="-1"></a>  group_df <span class="op">=</span> (</span>
<span id="cb251-12"><a href="#cb251-12" aria-hidden="true" tabindex="-1"></a>      com_df.groupby(col, as_index<span class="op">=</span><span class="va">False</span>)[<span class="st">&#39;продажа_usd&#39;</span>].<span class="bu">sum</span>()</span>
<span id="cb251-13"><a href="#cb251-13" aria-hidden="true" tabindex="-1"></a>      .sort_values(by<span class="op">=</span><span class="st">&#39;продажа_usd&#39;</span>, ascending<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb251-14"><a href="#cb251-14" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb251-15"><a href="#cb251-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb251-16"><a href="#cb251-16" aria-hidden="true" tabindex="-1"></a>  <span class="co"># продажи переведем в тыс.$</span></span>
<span id="cb251-17"><a href="#cb251-17" aria-hidden="true" tabindex="-1"></a>  group_df[<span class="st">&#39;продажа_usd&#39;</span>] <span class="op">=</span> <span class="bu">round</span>(group_df[<span class="st">&#39;продажа_usd&#39;</span>] <span class="op">/</span> <span class="dv">1000</span>, <span class="dv">2</span>)</span>
<span id="cb251-18"><a href="#cb251-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb251-19"><a href="#cb251-19" aria-hidden="true" tabindex="-1"></a>  <span class="co"># построим график</span></span>
<span id="cb251-20"><a href="#cb251-20" aria-hidden="true" tabindex="-1"></a>  sns.barplot(group_df, x<span class="op">=</span>col, y<span class="op">=</span><span class="st">&#39;продажа_usd&#39;</span>, ax<span class="op">=</span>ax[i], palette<span class="op">=</span><span class="st">&#39;Greens_r&#39;</span>)</span>
<span id="cb251-21"><a href="#cb251-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb251-22"><a href="#cb251-22" aria-hidden="true" tabindex="-1"></a>  <span class="co"># зададим название для каждого графика</span></span>
<span id="cb251-23"><a href="#cb251-23" aria-hidden="true" tabindex="-1"></a>  ax[i].<span class="bu">set</span>(title<span class="op">=</span><span class="ss">f&#39;</span><span class="sc">{</span>col<span class="sc">}</span><span class="ss">&#39;</span>,</span>
<span id="cb251-24"><a href="#cb251-24" aria-hidden="true" tabindex="-1"></a>            ylabel<span class="op">=</span><span class="st">&#39;Объем продаж, тыс.$&#39;</span>)</span>
<span id="cb251-25"><a href="#cb251-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb251-26"><a href="#cb251-26" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span></code></pre></div>
<div class="output display_data">
<p><img
src="vertopal_9b40e0aaef914c45a9852524805a792d/260fe0e87d42e32b0c1c2900a871e8c65c573e2c.png" /></p>
</div>
</div>
<div class="cell markdown" id="S_GXm3sLVpw0">
<p>Самые высокие объемы продаж в тыс.$ коммерческого транспорта у
моделей:</p>
<ol>
<li>Дизельного топлива</li>
<li>Высоколитражного двигателя</li>
<li>Механической коробки передач</li>
<li>С приводом 2WD.</li>
</ol>
</div>
<div class="cell markdown" id="MR95g65cXVCI">
<p>Посчитаем объем продаж в шт.</p>
</div>
<div class="cell code" data-execution_count="661"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:806}"
id="P8pt_wHSXVCQ" data-outputId="be557752-0859-4063-f481-e87c6a044ec8">
<div class="sourceCode" id="cb252"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb252-1"><a href="#cb252-1" aria-hidden="true" tabindex="-1"></a><span class="co"># построим сетку графиков</span></span>
<span id="cb252-2"><a href="#cb252-2" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(<span class="dv">2</span>, <span class="dv">2</span>, figsize<span class="op">=</span>(<span class="dv">15</span>, <span class="dv">8</span>), sharey<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb252-3"><a href="#cb252-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb252-4"><a href="#cb252-4" aria-hidden="true" tabindex="-1"></a><span class="co"># зададим общий заголово</span></span>
<span id="cb252-5"><a href="#cb252-5" aria-hidden="true" tabindex="-1"></a>plt.suptitle(<span class="st">&#39;Объем продаж коммерческого транспорта по категориям&#39;</span>)</span>
<span id="cb252-6"><a href="#cb252-6" aria-hidden="true" tabindex="-1"></a>ax <span class="op">=</span> ax.flatten()</span>
<span id="cb252-7"><a href="#cb252-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb252-8"><a href="#cb252-8" aria-hidden="true" tabindex="-1"></a><span class="co"># построим график для каждого столбца</span></span>
<span id="cb252-9"><a href="#cb252-9" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i, col <span class="kw">in</span> <span class="bu">enumerate</span>(car_char):</span>
<span id="cb252-10"><a href="#cb252-10" aria-hidden="true" tabindex="-1"></a>  <span class="co"># построим сводную таблицу</span></span>
<span id="cb252-11"><a href="#cb252-11" aria-hidden="true" tabindex="-1"></a>  group_df <span class="op">=</span> (</span>
<span id="cb252-12"><a href="#cb252-12" aria-hidden="true" tabindex="-1"></a>      com_df.groupby(col, as_index<span class="op">=</span><span class="va">False</span>)[<span class="st">&#39;продажа_usd&#39;</span>].count()</span>
<span id="cb252-13"><a href="#cb252-13" aria-hidden="true" tabindex="-1"></a>      .sort_values(by<span class="op">=</span><span class="st">&#39;продажа_usd&#39;</span>, ascending<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb252-14"><a href="#cb252-14" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb252-15"><a href="#cb252-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb252-16"><a href="#cb252-16" aria-hidden="true" tabindex="-1"></a>  <span class="co"># построим график</span></span>
<span id="cb252-17"><a href="#cb252-17" aria-hidden="true" tabindex="-1"></a>  sns.barplot(group_df, x<span class="op">=</span>col, y<span class="op">=</span><span class="st">&#39;продажа_usd&#39;</span>, ax<span class="op">=</span>ax[i], palette<span class="op">=</span><span class="st">&#39;Greens_r&#39;</span>)</span>
<span id="cb252-18"><a href="#cb252-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb252-19"><a href="#cb252-19" aria-hidden="true" tabindex="-1"></a>  <span class="co"># зададим название для каждого графика</span></span>
<span id="cb252-20"><a href="#cb252-20" aria-hidden="true" tabindex="-1"></a>  ax[i].<span class="bu">set</span>(title<span class="op">=</span><span class="ss">f&#39;</span><span class="sc">{</span>col<span class="sc">}</span><span class="ss">&#39;</span>,</span>
<span id="cb252-21"><a href="#cb252-21" aria-hidden="true" tabindex="-1"></a>            ylabel<span class="op">=</span><span class="st">&#39;Объем продаж, шт.&#39;</span>)</span>
<span id="cb252-22"><a href="#cb252-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb252-23"><a href="#cb252-23" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span></code></pre></div>
<div class="output display_data">
<p><img
src="vertopal_9b40e0aaef914c45a9852524805a792d/2efaf8824162d3fe2c8e989f9baa9df44df1db74.png" /></p>
</div>
</div>
<div class="cell markdown" id="vDvv8NLdXVCQ">
<p>Самые высокие объемы продаж в шт. коммерческого транспорта у
моделей:</p>
<ol>
<li>Бензинового топлива</li>
<li>Среднелитражного двигателя</li>
<li>Механической коробки передач</li>
<li>С приводом 2WD.</li>
</ol>
</div>
<div class="cell markdown" id="IOIAEGTvVee-">
<p>Найдем самые прибыльные категории коммерческого транспорта.</p>
</div>
<div class="cell code" data-execution_count="662"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:175}"
id="aQGgEw4tV6Wk" data-outputId="61de1bd1-582e-41f0-b2e5-d44022fced68">
<div class="sourceCode" id="cb253"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb253-1"><a href="#cb253-1" aria-hidden="true" tabindex="-1"></a>top_revenue_com_auto <span class="op">=</span> (</span>
<span id="cb253-2"><a href="#cb253-2" aria-hidden="true" tabindex="-1"></a>    com_df.groupby(car_char)[<span class="st">&#39;продажа_usd&#39;</span>].<span class="bu">sum</span>()</span>
<span id="cb253-3"><a href="#cb253-3" aria-hidden="true" tabindex="-1"></a>    .groupby([<span class="st">&#39;вид_топлива&#39;</span>])</span>
<span id="cb253-4"><a href="#cb253-4" aria-hidden="true" tabindex="-1"></a>    .idxmax().to_frame()</span>
<span id="cb253-5"><a href="#cb253-5" aria-hidden="true" tabindex="-1"></a>    .rename(columns<span class="op">=</span>{<span class="st">&#39;продажа_usd&#39;</span>: <span class="st">&#39;прибыльная_категория&#39;</span>})</span>
<span id="cb253-6"><a href="#cb253-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb253-7"><a href="#cb253-7" aria-hidden="true" tabindex="-1"></a>top_revenue_com_auto</span></code></pre></div>
<div class="output execute_result" data-execution_count="662">

  <div id="df-8632a2a5-b39f-4121-b4a5-62a6d24599a5" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>прибыльная_категория</th>
    </tr>
    <tr>
      <th>вид_топлива</th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>бензин</th>
      <td>(бензин, среднелитражный, MT, RWD)</td>
    </tr>
    <tr>
      <th>дизель</th>
      <td>(дизель, высоколитражный, MT, 2WD)</td>
    </tr>
    <tr>
      <th>электричество</th>
      <td>(электричество, микролитражный, MT, 2WD)</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-8632a2a5-b39f-4121-b4a5-62a6d24599a5')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-8632a2a5-b39f-4121-b4a5-62a6d24599a5 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-8632a2a5-b39f-4121-b4a5-62a6d24599a5');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-bea65f37-893b-461c-b33d-129aaa92050e">
  <button class="colab-df-quickchart" onclick="quickchart('df-bea65f37-893b-461c-b33d-129aaa92050e')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-bea65f37-893b-461c-b33d-129aaa92050e button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>
    </div>
  </div>

</div>
</div>
<div class="cell markdown" id="GNvKyJAzW4k1">
<p>Самые прибыльные категории коммерческого транспорта:</p>
<ol>
<li>бензин, среднелитражный, MT, RWD</li>
<li>дизель, высоколитражный, MT, 2WD</li>
<li>электричество, микролитражный, MT, 2WD</li>
</ol>
<p>Для электрических авто объем двигателя не учитывать.</p>
</div>
<div class="cell markdown" id="9mtNeolHXVCQ">
<p>Найдем самые продаваемые категории коммерческого транспорта.</p>
</div>
<div class="cell code" data-execution_count="663"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:175}"
id="PIRoz7l3XVCQ" data-outputId="8cf221d4-97cc-48b0-c3ae-16e50e1c5046">
<div class="sourceCode" id="cb254"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb254-1"><a href="#cb254-1" aria-hidden="true" tabindex="-1"></a>top_quantity_com_auto <span class="op">=</span> (</span>
<span id="cb254-2"><a href="#cb254-2" aria-hidden="true" tabindex="-1"></a>    com_df.groupby(car_char)[<span class="st">&#39;продажа_usd&#39;</span>].count()</span>
<span id="cb254-3"><a href="#cb254-3" aria-hidden="true" tabindex="-1"></a>    .groupby([<span class="st">&#39;вид_топлива&#39;</span>])</span>
<span id="cb254-4"><a href="#cb254-4" aria-hidden="true" tabindex="-1"></a>    .idxmax().to_frame()</span>
<span id="cb254-5"><a href="#cb254-5" aria-hidden="true" tabindex="-1"></a>    .rename(columns<span class="op">=</span>{<span class="st">&#39;продажа_usd&#39;</span>: <span class="st">&#39;прибыльная_категория&#39;</span>})</span>
<span id="cb254-6"><a href="#cb254-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb254-7"><a href="#cb254-7" aria-hidden="true" tabindex="-1"></a>top_quantity_com_auto</span></code></pre></div>
<div class="output execute_result" data-execution_count="663">

  <div id="df-db8f960f-f6ad-4041-9e5d-b90434d554dc" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>прибыльная_категория</th>
    </tr>
    <tr>
      <th>вид_топлива</th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>бензин</th>
      <td>(бензин, среднелитражный, MT, RWD)</td>
    </tr>
    <tr>
      <th>дизель</th>
      <td>(дизель, высоколитражный, MT, 2WD)</td>
    </tr>
    <tr>
      <th>электричество</th>
      <td>(электричество, микролитражный, MT, 2WD)</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-db8f960f-f6ad-4041-9e5d-b90434d554dc')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-db8f960f-f6ad-4041-9e5d-b90434d554dc button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-db8f960f-f6ad-4041-9e5d-b90434d554dc');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-84188a82-86f2-4305-b7a8-71b1ce28e774">
  <button class="colab-df-quickchart" onclick="quickchart('df-84188a82-86f2-4305-b7a8-71b1ce28e774')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-84188a82-86f2-4305-b7a8-71b1ce28e774 button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>
    </div>
  </div>

</div>
</div>
<div class="cell markdown" id="jg1PCNbTXVCR">
<p>Категории совпадают с самыми прибыльными.</p>
</div>
<section id="4132-некоммерческий-транспорт" class="cell markdown"
id="_BSNBtI7YYEq">
<h3>4.13.2 Некоммерческий транспорт</h3>
</section>
<div class="cell markdown" id="6Ll-BubuYYEq">
<p>Посчитаем объем продаж в тыс.$</p>
</div>
<div class="cell code" data-execution_count="664"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:805}"
id="StGGxuJUYYEr" data-outputId="5e3c9733-f1a7-4101-a0ab-0bf0fa51159f">
<div class="sourceCode" id="cb255"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb255-1"><a href="#cb255-1" aria-hidden="true" tabindex="-1"></a><span class="co"># построим сетку графиков</span></span>
<span id="cb255-2"><a href="#cb255-2" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(<span class="dv">2</span>, <span class="dv">2</span>, figsize<span class="op">=</span>(<span class="dv">15</span>, <span class="dv">8</span>), sharey<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb255-3"><a href="#cb255-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb255-4"><a href="#cb255-4" aria-hidden="true" tabindex="-1"></a><span class="co"># зададим общий заголово</span></span>
<span id="cb255-5"><a href="#cb255-5" aria-hidden="true" tabindex="-1"></a>plt.suptitle(<span class="st">&#39;Объем продаж некоммерческого транспорта по категориям&#39;</span>)</span>
<span id="cb255-6"><a href="#cb255-6" aria-hidden="true" tabindex="-1"></a>ax <span class="op">=</span> ax.flatten()</span>
<span id="cb255-7"><a href="#cb255-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb255-8"><a href="#cb255-8" aria-hidden="true" tabindex="-1"></a><span class="co"># построим график для каждого столбца</span></span>
<span id="cb255-9"><a href="#cb255-9" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i, col <span class="kw">in</span> <span class="bu">enumerate</span>(car_char):</span>
<span id="cb255-10"><a href="#cb255-10" aria-hidden="true" tabindex="-1"></a>  <span class="co"># построим сводную таблицу</span></span>
<span id="cb255-11"><a href="#cb255-11" aria-hidden="true" tabindex="-1"></a>  group_df <span class="op">=</span> (</span>
<span id="cb255-12"><a href="#cb255-12" aria-hidden="true" tabindex="-1"></a>      uncom_df.groupby(col, as_index<span class="op">=</span><span class="va">False</span>)[<span class="st">&#39;продажа_usd&#39;</span>].<span class="bu">sum</span>()</span>
<span id="cb255-13"><a href="#cb255-13" aria-hidden="true" tabindex="-1"></a>      .sort_values(by<span class="op">=</span><span class="st">&#39;продажа_usd&#39;</span>, ascending<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb255-14"><a href="#cb255-14" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb255-15"><a href="#cb255-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb255-16"><a href="#cb255-16" aria-hidden="true" tabindex="-1"></a>  <span class="co"># продажи переведем в тыс.$</span></span>
<span id="cb255-17"><a href="#cb255-17" aria-hidden="true" tabindex="-1"></a>  group_df[<span class="st">&#39;продажа_usd&#39;</span>] <span class="op">=</span> <span class="bu">round</span>(group_df[<span class="st">&#39;продажа_usd&#39;</span>] <span class="op">/</span> <span class="dv">1000</span>, <span class="dv">2</span>)</span>
<span id="cb255-18"><a href="#cb255-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb255-19"><a href="#cb255-19" aria-hidden="true" tabindex="-1"></a>  <span class="co"># построим график</span></span>
<span id="cb255-20"><a href="#cb255-20" aria-hidden="true" tabindex="-1"></a>  sns.barplot(group_df, x<span class="op">=</span>col, y<span class="op">=</span><span class="st">&#39;продажа_usd&#39;</span>, ax<span class="op">=</span>ax[i], palette<span class="op">=</span><span class="st">&#39;Greens_r&#39;</span>)</span>
<span id="cb255-21"><a href="#cb255-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb255-22"><a href="#cb255-22" aria-hidden="true" tabindex="-1"></a>  <span class="co"># зададим название для каждого графика</span></span>
<span id="cb255-23"><a href="#cb255-23" aria-hidden="true" tabindex="-1"></a>  ax[i].<span class="bu">set</span>(title<span class="op">=</span><span class="ss">f&#39;</span><span class="sc">{</span>col<span class="sc">}</span><span class="ss">&#39;</span>,</span>
<span id="cb255-24"><a href="#cb255-24" aria-hidden="true" tabindex="-1"></a>            ylabel<span class="op">=</span><span class="st">&#39;Объем продаж, тыс.$&#39;</span>)</span>
<span id="cb255-25"><a href="#cb255-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb255-26"><a href="#cb255-26" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span></code></pre></div>
<div class="output display_data">
<p><img
src="vertopal_9b40e0aaef914c45a9852524805a792d/3abc0c4ab35bb64f56d784a9efa026eef6052ce8.png" /></p>
</div>
</div>
<div class="cell markdown" id="rmg2LNAvYYEs">
<p>Самые высокие объемы продаж в тыс.$ некоммерческого транспорта у
моделей:</p>
<ol>
<li>Бензинового топлива</li>
<li>Среднелитражного двигателя</li>
<li>Автоматической коробки передач</li>
<li>С приводом 4WD.</li>
</ol>
</div>
<div class="cell markdown" id="zU5X3tp4YYEs">
<p>Посчитаем объем продаж в шт.</p>
</div>
<div class="cell code" data-execution_count="665"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:805}"
id="Vc7HfzjfYYEs" data-outputId="bb2a35ea-63ac-4501-eb72-f1c2ab8f31de">
<div class="sourceCode" id="cb256"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb256-1"><a href="#cb256-1" aria-hidden="true" tabindex="-1"></a><span class="co"># построим сетку графиков</span></span>
<span id="cb256-2"><a href="#cb256-2" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(<span class="dv">2</span>, <span class="dv">2</span>, figsize<span class="op">=</span>(<span class="dv">15</span>, <span class="dv">8</span>), sharey<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb256-3"><a href="#cb256-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb256-4"><a href="#cb256-4" aria-hidden="true" tabindex="-1"></a><span class="co"># зададим общий заголово</span></span>
<span id="cb256-5"><a href="#cb256-5" aria-hidden="true" tabindex="-1"></a>plt.suptitle(<span class="st">&#39;Объем продаж некоммерческого транспорта по категориям&#39;</span>)</span>
<span id="cb256-6"><a href="#cb256-6" aria-hidden="true" tabindex="-1"></a>ax <span class="op">=</span> ax.flatten()</span>
<span id="cb256-7"><a href="#cb256-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb256-8"><a href="#cb256-8" aria-hidden="true" tabindex="-1"></a><span class="co"># построим график для каждого столбца</span></span>
<span id="cb256-9"><a href="#cb256-9" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i, col <span class="kw">in</span> <span class="bu">enumerate</span>(car_char):</span>
<span id="cb256-10"><a href="#cb256-10" aria-hidden="true" tabindex="-1"></a>  <span class="co"># построим сводную таблицу</span></span>
<span id="cb256-11"><a href="#cb256-11" aria-hidden="true" tabindex="-1"></a>  group_df <span class="op">=</span> (</span>
<span id="cb256-12"><a href="#cb256-12" aria-hidden="true" tabindex="-1"></a>      uncom_df.groupby(col, as_index<span class="op">=</span><span class="va">False</span>)[<span class="st">&#39;продажа_usd&#39;</span>].count()</span>
<span id="cb256-13"><a href="#cb256-13" aria-hidden="true" tabindex="-1"></a>      .sort_values(by<span class="op">=</span><span class="st">&#39;продажа_usd&#39;</span>, ascending<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb256-14"><a href="#cb256-14" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb256-15"><a href="#cb256-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb256-16"><a href="#cb256-16" aria-hidden="true" tabindex="-1"></a>  <span class="co"># построим график</span></span>
<span id="cb256-17"><a href="#cb256-17" aria-hidden="true" tabindex="-1"></a>  sns.barplot(group_df, x<span class="op">=</span>col, y<span class="op">=</span><span class="st">&#39;продажа_usd&#39;</span>, ax<span class="op">=</span>ax[i], palette<span class="op">=</span><span class="st">&#39;Greens_r&#39;</span>)</span>
<span id="cb256-18"><a href="#cb256-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb256-19"><a href="#cb256-19" aria-hidden="true" tabindex="-1"></a>  <span class="co"># зададим название для каждого графика</span></span>
<span id="cb256-20"><a href="#cb256-20" aria-hidden="true" tabindex="-1"></a>  ax[i].<span class="bu">set</span>(title<span class="op">=</span><span class="ss">f&#39;</span><span class="sc">{</span>col<span class="sc">}</span><span class="ss">&#39;</span>,</span>
<span id="cb256-21"><a href="#cb256-21" aria-hidden="true" tabindex="-1"></a>            ylabel<span class="op">=</span><span class="st">&#39;Объем продаж, шт.&#39;</span>)</span>
<span id="cb256-22"><a href="#cb256-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb256-23"><a href="#cb256-23" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span></code></pre></div>
<div class="output display_data">
<p><img
src="vertopal_9b40e0aaef914c45a9852524805a792d/9da28c7cf1afd878214e1883cb9ef529895fa16d.png" /></p>
</div>
</div>
<div class="cell markdown" id="VCT3Y60YYYEt">
<p>Самые высокие объемы продаж в шт. некоммерческого транспорта по
характеристикам совпадают с объемм продаж в деньгах.</p>
</div>
<div class="cell markdown" id="gTJsqaWdYYEt">
<p>Найдем самые прибыльные категории некоммерческого транспорта.</p>
</div>
<div class="cell code" data-execution_count="666"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:206}"
id="3SMAuS-eYYEu" data-outputId="64d4c177-0fde-4d32-da46-1289489c1545">
<div class="sourceCode" id="cb257"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb257-1"><a href="#cb257-1" aria-hidden="true" tabindex="-1"></a>top_revenue_com_auto <span class="op">=</span> (</span>
<span id="cb257-2"><a href="#cb257-2" aria-hidden="true" tabindex="-1"></a>    uncom_df.groupby(car_char)[<span class="st">&#39;продажа_usd&#39;</span>].<span class="bu">sum</span>()</span>
<span id="cb257-3"><a href="#cb257-3" aria-hidden="true" tabindex="-1"></a>    .groupby([<span class="st">&#39;вид_топлива&#39;</span>])</span>
<span id="cb257-4"><a href="#cb257-4" aria-hidden="true" tabindex="-1"></a>    .idxmax().to_frame()</span>
<span id="cb257-5"><a href="#cb257-5" aria-hidden="true" tabindex="-1"></a>    .rename(columns<span class="op">=</span>{<span class="st">&#39;продажа_usd&#39;</span>: <span class="st">&#39;прибыльная_категория&#39;</span>})</span>
<span id="cb257-6"><a href="#cb257-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb257-7"><a href="#cb257-7" aria-hidden="true" tabindex="-1"></a>top_revenue_com_auto</span></code></pre></div>
<div class="output execute_result" data-execution_count="666">

  <div id="df-941d1641-b24b-48a9-8328-6ef91cd3e594" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>прибыльная_категория</th>
    </tr>
    <tr>
      <th>вид_топлива</th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>бензин</th>
      <td>(бензин, среднелитражный, AT, 4WD)</td>
    </tr>
    <tr>
      <th>гибрид</th>
      <td>(гибрид, среднелитражный, AT, 4WD)</td>
    </tr>
    <tr>
      <th>дизель</th>
      <td>(дизель, среднелитражный, MT, 4WD)</td>
    </tr>
    <tr>
      <th>электричество</th>
      <td>(электричество, микролитражный, AT, 4WD)</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-941d1641-b24b-48a9-8328-6ef91cd3e594')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-941d1641-b24b-48a9-8328-6ef91cd3e594 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-941d1641-b24b-48a9-8328-6ef91cd3e594');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-1219273f-b83b-4f8a-afc2-26437a35b4a4">
  <button class="colab-df-quickchart" onclick="quickchart('df-1219273f-b83b-4f8a-afc2-26437a35b4a4')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-1219273f-b83b-4f8a-afc2-26437a35b4a4 button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>
    </div>
  </div>

</div>
</div>
<div class="cell markdown" id="4sb5QUaoYYEu">
<p>Самые прибыльные категории некоммерческого транспорта:</p>
<ol>
<li>бензин, среднелитражный, AT, 4WD</li>
<li>гибрид, среднелитражный, AT, 4WD</li>
<li>дизель, среднелитражный, MT, 4WD</li>
<li>электричество, микролитражный, AT, 4WD</li>
</ol>
<p>Для электрических авто объем двигателя не учитывать.</p>
</div>
<div class="cell markdown" id="dVYTkTWpYYEu">
<p>Найдем самые продаваемые категории некоммерческого транспорта.</p>
</div>
<div class="cell code" data-execution_count="667"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:206}"
id="KVl__cneYYEv" data-outputId="86600503-031e-44b3-8646-b78cd3ccfbf1">
<div class="sourceCode" id="cb258"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb258-1"><a href="#cb258-1" aria-hidden="true" tabindex="-1"></a>top_quantity_com_auto <span class="op">=</span> (</span>
<span id="cb258-2"><a href="#cb258-2" aria-hidden="true" tabindex="-1"></a>    uncom_df.groupby(car_char)[<span class="st">&#39;продажа_usd&#39;</span>].count()</span>
<span id="cb258-3"><a href="#cb258-3" aria-hidden="true" tabindex="-1"></a>    .groupby([<span class="st">&#39;вид_топлива&#39;</span>])</span>
<span id="cb258-4"><a href="#cb258-4" aria-hidden="true" tabindex="-1"></a>    .idxmax().to_frame()</span>
<span id="cb258-5"><a href="#cb258-5" aria-hidden="true" tabindex="-1"></a>    .rename(columns<span class="op">=</span>{<span class="st">&#39;продажа_usd&#39;</span>: <span class="st">&#39;прибыльная_категория&#39;</span>})</span>
<span id="cb258-6"><a href="#cb258-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb258-7"><a href="#cb258-7" aria-hidden="true" tabindex="-1"></a>top_quantity_com_auto</span></code></pre></div>
<div class="output execute_result" data-execution_count="667">

  <div id="df-090c5a9a-4b3e-463a-ab73-e90294f1537e" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>прибыльная_категория</th>
    </tr>
    <tr>
      <th>вид_топлива</th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>бензин</th>
      <td>(бензин, среднелитражный, AT, 4WD)</td>
    </tr>
    <tr>
      <th>гибрид</th>
      <td>(гибрид, среднелитражный, AT, 4WD)</td>
    </tr>
    <tr>
      <th>дизель</th>
      <td>(дизель, среднелитражный, MT, 4WD)</td>
    </tr>
    <tr>
      <th>электричество</th>
      <td>(электричество, микролитражный, AT, 4WD)</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-090c5a9a-4b3e-463a-ab73-e90294f1537e')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-090c5a9a-4b3e-463a-ab73-e90294f1537e button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-090c5a9a-4b3e-463a-ab73-e90294f1537e');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-fd2ac235-686a-44e9-92d7-9cb329ff0ec5">
  <button class="colab-df-quickchart" onclick="quickchart('df-fd2ac235-686a-44e9-92d7-9cb329ff0ec5')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-fd2ac235-686a-44e9-92d7-9cb329ff0ec5 button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>
    </div>
  </div>

</div>
</div>
<div class="cell markdown" id="E2bJJJtYYYEv">
<p>Категории совпадают с самыми прибыльными.</p>
</div>
<section id="414-анализ-положения-меркур-авто" class="cell markdown"
id="RZR-dCL0gZaE">
<h2>4.14 Анализ положения Меркур Авто:</h2>
</section>
<section id="4141-выручка" class="cell markdown" id="vtZk0PakgeRe">
<h3>4.14.1 Выручка</h3>
</section>
<div class="cell code" data-execution_count="668" id="bMWCMO-7qGDb">
<div class="sourceCode" id="cb259"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb259-1"><a href="#cb259-1" aria-hidden="true" tabindex="-1"></a><span class="co"># создадим отдельный датафрейм с данными только по Меркур Авто</span></span>
<span id="cb259-2"><a href="#cb259-2" aria-hidden="true" tabindex="-1"></a>mercur <span class="op">=</span> df.query(<span class="st">&#39;компания == &quot;mercur auto&quot;&#39;</span>)</span></code></pre></div>
</div>
<section id="общая" class="cell markdown" id="YiFGzCXhqYiS">
<h4>Общая</h4>
</section>
<div class="cell code" data-execution_count="669"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:36}"
id="9yhLRND3rQ0F" data-outputId="50d15ba7-2024-452a-db1a-c4e8f18c4b77">
<div class="sourceCode" id="cb260"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb260-1"><a href="#cb260-1" aria-hidden="true" tabindex="-1"></a><span class="ss">f&#39;Общая выручка: </span><span class="sc">{</span><span class="bu">round</span>(mercur[<span class="st">&quot;продажа_usd&quot;</span>].<span class="bu">sum</span>() <span class="op">/</span> <span class="dv">1000</span>, <span class="dv">2</span>)<span class="sc">}</span><span class="ss"> тыс.$&#39;</span></span></code></pre></div>
<div class="output execute_result" data-execution_count="669">
<div class="sourceCode" id="cb261"><pre
class="sourceCode json"><code class="sourceCode json"><span id="cb261-1"><a href="#cb261-1" aria-hidden="true" tabindex="-1"></a><span class="fu">{</span><span class="dt">&quot;type&quot;</span><span class="fu">:</span><span class="st">&quot;string&quot;</span><span class="fu">}</span></span></code></pre></div>
</div>
</div>
<section id="общая-по-маркам" class="cell markdown" id="cqTes3F8qb1Z">
<h4>Общая по маркам</h4>
</section>
<div class="cell code" data-execution_count="670" id="9_Xx9f1org-5">
<div class="sourceCode" id="cb262"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb262-1"><a href="#cb262-1" aria-hidden="true" tabindex="-1"></a><span class="co"># построим сводную таблицу выручки по маркам авто</span></span>
<span id="cb262-2"><a href="#cb262-2" aria-hidden="true" tabindex="-1"></a>mercur_brand_revenue <span class="op">=</span> (</span>
<span id="cb262-3"><a href="#cb262-3" aria-hidden="true" tabindex="-1"></a>    mercur.groupby(<span class="st">&#39;бренд&#39;</span>, as_index<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb262-4"><a href="#cb262-4" aria-hidden="true" tabindex="-1"></a>    .agg({<span class="st">&#39;продажа_usd&#39;</span>: <span class="st">&#39;sum&#39;</span>})</span>
<span id="cb262-5"><a href="#cb262-5" aria-hidden="true" tabindex="-1"></a>    .sort_values(by<span class="op">=</span><span class="st">&#39;продажа_usd&#39;</span>, ascending<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb262-6"><a href="#cb262-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb262-7"><a href="#cb262-7" aria-hidden="true" tabindex="-1"></a>mercur_brand_revenue[<span class="st">&#39;продажа_usd&#39;</span>] <span class="op">=</span> (</span>
<span id="cb262-8"><a href="#cb262-8" aria-hidden="true" tabindex="-1"></a>    <span class="bu">round</span>(mercur_brand_revenue[<span class="st">&#39;продажа_usd&#39;</span>] <span class="op">/</span> <span class="dv">1000</span>, <span class="dv">2</span>)</span>
<span id="cb262-9"><a href="#cb262-9" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="671"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:563}"
id="DB3c4mRlsFlF" data-outputId="e5f23aae-0690-40b3-d269-7c1ca3056f19">
<div class="sourceCode" id="cb263"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb263-1"><a href="#cb263-1" aria-hidden="true" tabindex="-1"></a><span class="co"># построим столбчатую диаграмму</span></span>
<span id="cb263-2"><a href="#cb263-2" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">15</span>, <span class="dv">6</span>))</span>
<span id="cb263-3"><a href="#cb263-3" aria-hidden="true" tabindex="-1"></a>sns.barplot(mercur_brand_revenue, x<span class="op">=</span><span class="st">&#39;бренд&#39;</span>, y<span class="op">=</span><span class="st">&#39;продажа_usd&#39;</span>)</span>
<span id="cb263-4"><a href="#cb263-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb263-5"><a href="#cb263-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> x, y, tex <span class="kw">in</span> <span class="bu">zip</span>(mercur_brand_revenue[<span class="st">&#39;бренд&#39;</span>],</span>
<span id="cb263-6"><a href="#cb263-6" aria-hidden="true" tabindex="-1"></a>                     mercur_brand_revenue[<span class="st">&#39;продажа_usd&#39;</span>],</span>
<span id="cb263-7"><a href="#cb263-7" aria-hidden="true" tabindex="-1"></a>                     mercur_brand_revenue[<span class="st">&#39;продажа_usd&#39;</span>]):</span>
<span id="cb263-8"><a href="#cb263-8" aria-hidden="true" tabindex="-1"></a>    t <span class="op">=</span> plt.text(x, y, <span class="bu">int</span>(tex),</span>
<span id="cb263-9"><a href="#cb263-9" aria-hidden="true" tabindex="-1"></a>                 horizontalalignment<span class="op">=</span><span class="st">&#39;center&#39;</span>,</span>
<span id="cb263-10"><a href="#cb263-10" aria-hidden="true" tabindex="-1"></a>                 verticalalignment<span class="op">=</span><span class="st">&#39;bottom&#39;</span>,</span>
<span id="cb263-11"><a href="#cb263-11" aria-hidden="true" tabindex="-1"></a>                 fontdict<span class="op">=</span>{<span class="st">&#39;color&#39;</span>:<span class="st">&#39;black&#39;</span>, <span class="st">&#39;weight&#39;</span>:<span class="st">&#39;bold&#39;</span>})</span>
<span id="cb263-12"><a href="#cb263-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb263-13"><a href="#cb263-13" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">&#39;Общая выручка по маркам компании Меркур Авто, тыс.$&#39;</span>)</span>
<span id="cb263-14"><a href="#cb263-14" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">&#39;Марка&#39;</span>)</span>
<span id="cb263-15"><a href="#cb263-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb263-16"><a href="#cb263-16" aria-hidden="true" tabindex="-1"></a>plt.gca().get_yaxis().set_visible(<span class="va">False</span>)</span></code></pre></div>
<div class="output display_data">
<p><img
src="vertopal_9b40e0aaef914c45a9852524805a792d/37f95ffc40ebd73102b3442b40302f5f1b0b0fd0.png" /></p>
</div>
</div>
<div class="cell markdown" id="HBjsuxAQu-EV">
<p>Volkswagen занимает первое место по выручке компании Меркур Авто.
Выручка данной марки равна 10 182 тыс.$. На втором месте идет Porsche (5
113 тыс.$), на третьем - Audi (4 059 тыс.$).</p>
</div>
<section id="ежемесячная" class="cell markdown" id="-oA9-qKKqcwD">
<h4>Ежемесячная</h4>
</section>
<div class="cell code" data-execution_count="672"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:607}"
id="Res_0SmdxpJc" data-outputId="275429d4-9799-414b-e75f-1071076b3437">
<div class="sourceCode" id="cb264"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb264-1"><a href="#cb264-1" aria-hidden="true" tabindex="-1"></a><span class="co"># рассчитаем выручку по месяцам</span></span>
<span id="cb264-2"><a href="#cb264-2" aria-hidden="true" tabindex="-1"></a>month_revenue <span class="op">=</span> (</span>
<span id="cb264-3"><a href="#cb264-3" aria-hidden="true" tabindex="-1"></a>    mercur.groupby(<span class="st">&#39;дата&#39;</span>, as_index<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb264-4"><a href="#cb264-4" aria-hidden="true" tabindex="-1"></a>    .agg({<span class="st">&#39;продажа_usd&#39;</span>: <span class="st">&#39;sum&#39;</span>})</span>
<span id="cb264-5"><a href="#cb264-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb264-6"><a href="#cb264-6" aria-hidden="true" tabindex="-1"></a><span class="co"># переведм сумму продаж в тыс. $</span></span>
<span id="cb264-7"><a href="#cb264-7" aria-hidden="true" tabindex="-1"></a>month_revenue[<span class="st">&#39;продажа_usd&#39;</span>] <span class="op">=</span> <span class="bu">round</span>(month_revenue[<span class="st">&#39;продажа_usd&#39;</span>] <span class="op">/</span> <span class="dv">1000</span>, <span class="dv">2</span>)</span>
<span id="cb264-8"><a href="#cb264-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-9"><a href="#cb264-9" aria-hidden="true" tabindex="-1"></a><span class="co"># построим график</span></span>
<span id="cb264-10"><a href="#cb264-10" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">15</span>, <span class="dv">6</span>))</span>
<span id="cb264-11"><a href="#cb264-11" aria-hidden="true" tabindex="-1"></a>sns.lineplot(month_revenue,</span>
<span id="cb264-12"><a href="#cb264-12" aria-hidden="true" tabindex="-1"></a>             x<span class="op">=</span><span class="st">&#39;дата&#39;</span>,</span>
<span id="cb264-13"><a href="#cb264-13" aria-hidden="true" tabindex="-1"></a>             y<span class="op">=</span><span class="st">&#39;продажа_usd&#39;</span>,</span>
<span id="cb264-14"><a href="#cb264-14" aria-hidden="true" tabindex="-1"></a>             marker<span class="op">=</span><span class="st">&#39;s&#39;</span>,</span>
<span id="cb264-15"><a href="#cb264-15" aria-hidden="true" tabindex="-1"></a>             linewidth<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb264-16"><a href="#cb264-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-17"><a href="#cb264-17" aria-hidden="true" tabindex="-1"></a><span class="co"># добавим подпись выручки на линию</span></span>
<span id="cb264-18"><a href="#cb264-18" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> x, y, tex <span class="kw">in</span> <span class="bu">zip</span>(month_revenue[<span class="st">&#39;дата&#39;</span>],</span>
<span id="cb264-19"><a href="#cb264-19" aria-hidden="true" tabindex="-1"></a>                     month_revenue[<span class="st">&#39;продажа_usd&#39;</span>],</span>
<span id="cb264-20"><a href="#cb264-20" aria-hidden="true" tabindex="-1"></a>                     month_revenue[<span class="st">&#39;продажа_usd&#39;</span>]):</span>
<span id="cb264-21"><a href="#cb264-21" aria-hidden="true" tabindex="-1"></a>    t <span class="op">=</span> plt.text(x, y, <span class="bu">int</span>(tex),</span>
<span id="cb264-22"><a href="#cb264-22" aria-hidden="true" tabindex="-1"></a>                 horizontalalignment<span class="op">=</span><span class="st">&#39;right&#39;</span>,</span>
<span id="cb264-23"><a href="#cb264-23" aria-hidden="true" tabindex="-1"></a>                 verticalalignment<span class="op">=</span><span class="st">&#39;bottom&#39;</span>,</span>
<span id="cb264-24"><a href="#cb264-24" aria-hidden="true" tabindex="-1"></a>                 fontdict<span class="op">=</span>{<span class="st">&#39;color&#39;</span>:<span class="st">&#39;black&#39;</span>, <span class="st">&#39;weight&#39;</span>:<span class="st">&#39;bold&#39;</span>})</span>
<span id="cb264-25"><a href="#cb264-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-26"><a href="#cb264-26" aria-hidden="true" tabindex="-1"></a><span class="co"># удалим ось y, тк данные теперь отображаются на линии</span></span>
<span id="cb264-27"><a href="#cb264-27" aria-hidden="true" tabindex="-1"></a>plt.gca().get_yaxis().set_visible(<span class="va">False</span>)</span>
<span id="cb264-28"><a href="#cb264-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-29"><a href="#cb264-29" aria-hidden="true" tabindex="-1"></a><span class="co"># зададим название графика и оси x</span></span>
<span id="cb264-30"><a href="#cb264-30" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">&#39;Выручка компании Меркур Авто по месяцам, тыс.$&#39;</span>)</span>
<span id="cb264-31"><a href="#cb264-31" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">&#39;Месяц&#39;</span>)</span>
<span id="cb264-32"><a href="#cb264-32" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()<span class="op">;</span></span></code></pre></div>
<div class="output display_data">
<p><img
src="vertopal_9b40e0aaef914c45a9852524805a792d/34c0d89ea39bd8165607f2870e3b4c3dc8026e40.png" /></p>
</div>
</div>
<div class="cell markdown" id="XPqQHmlUzyZG">
<p>С января по апрель наблюдается небольшой спад в выручке. Затем в мае
скачок и резкий спад в июне (самая низкая выручка за все месяцы). После
чего небольшой подъем в июле и плавный спад.</p>
<p>Такой скачок в мае можно объяснить например покупкой авто перед летом
для путешествий и активного отдыха. В июне многие могли уехать в отпуск,
поэтому наблюдается такой спад в выручке.</p>
<p>Для полного понимания причин спада в июне рассмотрим ежемесячную
выручку по маркам.</p>
</div>
<section id="средняя" class="cell markdown" id="7Hc_BxijqcgR">
<h4>Средняя</h4>
</section>
<div class="cell code" data-execution_count="673"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:36}"
id="h9bRR3w71v7P" data-outputId="4d160fc5-439b-44d7-8b25-57c5d5a72def">
<div class="sourceCode" id="cb265"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb265-1"><a href="#cb265-1" aria-hidden="true" tabindex="-1"></a><span class="ss">f&#39;Средняя выручка: </span><span class="sc">{</span><span class="bu">round</span>(month_revenue[<span class="st">&quot;продажа_usd&quot;</span>].mean(), <span class="dv">2</span>)<span class="sc">}</span><span class="ss"> тыс.$&#39;</span></span></code></pre></div>
<div class="output execute_result" data-execution_count="673">
<div class="sourceCode" id="cb266"><pre
class="sourceCode json"><code class="sourceCode json"><span id="cb266-1"><a href="#cb266-1" aria-hidden="true" tabindex="-1"></a><span class="fu">{</span><span class="dt">&quot;type&quot;</span><span class="fu">:</span><span class="st">&quot;string&quot;</span><span class="fu">}</span></span></code></pre></div>
</div>
</div>
<section id="ежемесячная-по-маркам" class="cell markdown"
id="T2ND3fcmqc5F">
<h4>Ежемесячная по маркам</h4>
</section>
<div class="cell code" data-execution_count="674"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:331}"
id="f5L9fL6T0uub" data-outputId="f7754f9d-c6e8-4dee-a88b-09f828b8c34c">
<div class="sourceCode" id="cb267"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb267-1"><a href="#cb267-1" aria-hidden="true" tabindex="-1"></a><span class="co"># посчитаем ежемесячную выручку по маркам</span></span>
<span id="cb267-2"><a href="#cb267-2" aria-hidden="true" tabindex="-1"></a>brand_monthly_revenue <span class="op">=</span> mercur.pivot_table(index<span class="op">=</span><span class="st">&#39;дата&#39;</span>,</span>
<span id="cb267-3"><a href="#cb267-3" aria-hidden="true" tabindex="-1"></a>                                           columns<span class="op">=</span><span class="st">&#39;бренд&#39;</span>,</span>
<span id="cb267-4"><a href="#cb267-4" aria-hidden="true" tabindex="-1"></a>                                           values<span class="op">=</span><span class="st">&#39;продажа_usd&#39;</span>,</span>
<span id="cb267-5"><a href="#cb267-5" aria-hidden="true" tabindex="-1"></a>                                           aggfunc<span class="op">=</span><span class="st">&#39;sum&#39;</span>).reset_index()</span>
<span id="cb267-6"><a href="#cb267-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb267-7"><a href="#cb267-7" aria-hidden="true" tabindex="-1"></a><span class="co"># переведем продажи в тыс. $</span></span>
<span id="cb267-8"><a href="#cb267-8" aria-hidden="true" tabindex="-1"></a>brand_monthly_revenue[[<span class="st">&#39;audi&#39;</span>, <span class="st">&#39;porsche&#39;</span>, <span class="st">&#39;volkswagen&#39;</span>]] <span class="op">=</span> (</span>
<span id="cb267-9"><a href="#cb267-9" aria-hidden="true" tabindex="-1"></a>    <span class="bu">round</span>(brand_monthly_revenue[[<span class="st">&#39;audi&#39;</span>, <span class="st">&#39;porsche&#39;</span>, <span class="st">&#39;volkswagen&#39;</span>]] <span class="op">/</span> <span class="dv">1000</span>, <span class="dv">2</span>)</span>
<span id="cb267-10"><a href="#cb267-10" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb267-11"><a href="#cb267-11" aria-hidden="true" tabindex="-1"></a>brand_monthly_revenue</span></code></pre></div>
<div class="output execute_result" data-execution_count="674">

  <div id="df-a531d8a2-e1f1-4b94-b7d0-0b9bb0d71037" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>бренд</th>
      <th>дата</th>
      <th>audi</th>
      <th>porsche</th>
      <th>volkswagen</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2019-01-01</td>
      <td>177.77</td>
      <td>89.00</td>
      <td>2712.64</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2019-02-01</td>
      <td>91.90</td>
      <td>554.26</td>
      <td>2303.21</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2019-03-01</td>
      <td>717.76</td>
      <td>652.16</td>
      <td>1337.71</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2019-04-01</td>
      <td>427.50</td>
      <td>767.03</td>
      <td>1472.75</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2019-05-01</td>
      <td>497.50</td>
      <td>834.32</td>
      <td>2355.96</td>
    </tr>
    <tr>
      <th>5</th>
      <td>2019-06-01</td>
      <td>308.81</td>
      <td>526.94</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>6</th>
      <td>2019-07-01</td>
      <td>768.87</td>
      <td>617.96</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>7</th>
      <td>2019-08-01</td>
      <td>498.59</td>
      <td>611.79</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>8</th>
      <td>2019-09-01</td>
      <td>570.80</td>
      <td>460.05</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-a531d8a2-e1f1-4b94-b7d0-0b9bb0d71037')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-a531d8a2-e1f1-4b94-b7d0-0b9bb0d71037 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-a531d8a2-e1f1-4b94-b7d0-0b9bb0d71037');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-be7c2ee0-5194-41d0-b500-0b197da6823e">
  <button class="colab-df-quickchart" onclick="quickchart('df-be7c2ee0-5194-41d0-b500-0b197da6823e')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-be7c2ee0-5194-41d0-b500-0b197da6823e button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>
    </div>
  </div>

</div>
</div>
<div class="cell code" data-execution_count="675"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:607}"
id="rcPGJB9aqR8Z" data-outputId="8806dde6-2928-463b-f98a-cfa3564c95bc">
<div class="sourceCode" id="cb268"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb268-1"><a href="#cb268-1" aria-hidden="true" tabindex="-1"></a><span class="co"># построим график</span></span>
<span id="cb268-2"><a href="#cb268-2" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">15</span>, <span class="dv">6</span>))</span>
<span id="cb268-3"><a href="#cb268-3" aria-hidden="true" tabindex="-1"></a>sns.lineplot(brand_monthly_revenue.melt(<span class="st">&#39;дата&#39;</span>,</span>
<span id="cb268-4"><a href="#cb268-4" aria-hidden="true" tabindex="-1"></a>                                        var_name<span class="op">=</span><span class="st">&#39;марка&#39;</span>,</span>
<span id="cb268-5"><a href="#cb268-5" aria-hidden="true" tabindex="-1"></a>                                        value_name<span class="op">=</span><span class="st">&#39;продажи&#39;</span>),</span>
<span id="cb268-6"><a href="#cb268-6" aria-hidden="true" tabindex="-1"></a>             x<span class="op">=</span><span class="st">&#39;дата&#39;</span>,</span>
<span id="cb268-7"><a href="#cb268-7" aria-hidden="true" tabindex="-1"></a>             y<span class="op">=</span><span class="st">&#39;продажи&#39;</span>,</span>
<span id="cb268-8"><a href="#cb268-8" aria-hidden="true" tabindex="-1"></a>             hue<span class="op">=</span><span class="st">&#39;марка&#39;</span>,</span>
<span id="cb268-9"><a href="#cb268-9" aria-hidden="true" tabindex="-1"></a>             marker<span class="op">=</span><span class="st">&#39;s&#39;</span>,</span>
<span id="cb268-10"><a href="#cb268-10" aria-hidden="true" tabindex="-1"></a>             linewidth<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb268-11"><a href="#cb268-11" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">&#39;Дата&#39;</span>)</span>
<span id="cb268-12"><a href="#cb268-12" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">&#39;Выручка, тыс.$&#39;</span>)</span>
<span id="cb268-13"><a href="#cb268-13" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">&#39;Ежемесячная выручка по маркам компании Меркур Авто, тыс.$&#39;</span>)</span>
<span id="cb268-14"><a href="#cb268-14" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()<span class="op">;</span></span></code></pre></div>
<div class="output display_data">
<p><img
src="vertopal_9b40e0aaef914c45a9852524805a792d/0ab6789db619b106e5a2cf5b21d2a9c5da3201e1.png" /></p>
</div>
</div>
<div class="cell markdown" id="bhYlZ-UQcmbd">
<p>Из графика видно, что с мая компания Меркур Авто не продает авто
марки Volkswagen. Именно поэтому на ежемесячной выручке компании
наблюдается резкий спад в июне. Выручка с продажи марок Audi и Porsche
на протяжении 9 месяцев не стабильна, есть рост и падение. Возможно это
связано с акциями, скидками и тд. Самая высокая выручка за Porsche в
мае, за Audi - в июле.</p>
</div>
<section id="415-продажи-по-регионам" class="cell markdown"
id="yHc6CeeSggO-">
<h2>4.15 Продажи по регионам</h2>
</section>
<section id="4151-общие" class="cell markdown" id="3uWPvzYa6KC-">
<h3>4.15.1 Общие</h3>
</section>
<div class="cell code" data-execution_count="676"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:609}"
id="FnW74RHF1WCe" data-outputId="a9f70e9c-625a-4c77-99ba-f2aad75477b7">
<div class="sourceCode" id="cb269"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb269-1"><a href="#cb269-1" aria-hidden="true" tabindex="-1"></a><span class="co"># найдем продажи по регионам компании Меркур Авто</span></span>
<span id="cb269-2"><a href="#cb269-2" aria-hidden="true" tabindex="-1"></a><span class="co"># применим функции</span></span>
<span id="cb269-3"><a href="#cb269-3" aria-hidden="true" tabindex="-1"></a>df_usd, df_count <span class="op">=</span> compare_usd_quantity(mercur, <span class="st">&#39;область&#39;</span>, <span class="st">&#39;sum&#39;</span>, <span class="va">True</span>)</span>
<span id="cb269-4"><a href="#cb269-4" aria-hidden="true" tabindex="-1"></a>barplot(df_usd, df_count, <span class="dv">3</span>, <span class="st">&#39;Продажи по регионам компании Меркур Авто&#39;</span>)</span></code></pre></div>
<div class="output display_data">
<p><img
src="vertopal_9b40e0aaef914c45a9852524805a792d/f95765d5441f647042e43b71e5ed76fd7518ca72.png" /></p>
</div>
</div>
<div class="cell markdown" id="8e4WrUz1f4ur">
<p>Самые высоки продажи в деньгах и количестве с большим отрывом у г.
Алматы. Далее идет г. Нур-Султан. 3 место по деньгам занимает
Костанайская обл., по количеству - Атырауская обл.</p>
<p>Меньше всего продаж по обоим значеням в Западно-Казахстанской
области.</p>
</div>
<section id="4152-по-маркам" class="cell markdown" id="Bs_BclAs6Ohq">
<h3>4.15.2 По маркам</h3>
</section>
<div class="cell markdown" id="4i67Uktg6RZp">
<p>Проанализируем продажи по регионам по маркам в разрезе коммерческого
и некоммерческого авто. Для этого создадим столбец тип_авто, где будет
указано коммерческий автомобиль или нет.</p>
</div>
<div class="cell code" data-execution_count="677" id="UXdk2xIslIXn">
<div class="sourceCode" id="cb270"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb270-1"><a href="#cb270-1" aria-hidden="true" tabindex="-1"></a><span class="co"># создадим условия</span></span>
<span id="cb270-2"><a href="#cb270-2" aria-hidden="true" tabindex="-1"></a>condlist <span class="op">=</span> [mercur[<span class="st">&#39;сегментация_2013&#39;</span>] <span class="op">==</span> <span class="st">&#39;коммерческие автомобили&#39;</span>,</span>
<span id="cb270-3"><a href="#cb270-3" aria-hidden="true" tabindex="-1"></a>            mercur[<span class="st">&#39;сегментация_2013&#39;</span>] <span class="op">!=</span> <span class="st">&#39;коммерческие автомобили&#39;</span>]</span>
<span id="cb270-4"><a href="#cb270-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-5"><a href="#cb270-5" aria-hidden="true" tabindex="-1"></a><span class="co"># создадим значения в соответствии с условием</span></span>
<span id="cb270-6"><a href="#cb270-6" aria-hidden="true" tabindex="-1"></a>choicelist <span class="op">=</span> [<span class="st">&#39;коммерческий&#39;</span>, <span class="st">&#39;некоммерческий&#39;</span>]</span>
<span id="cb270-7"><a href="#cb270-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-8"><a href="#cb270-8" aria-hidden="true" tabindex="-1"></a><span class="co"># создадим новый столбец</span></span>
<span id="cb270-9"><a href="#cb270-9" aria-hidden="true" tabindex="-1"></a>mercur[<span class="st">&#39;тип_авто&#39;</span>] <span class="op">=</span> np.select(condlist, choicelist)</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="678" id="5VGR-nDcuDrs">
<div class="sourceCode" id="cb271"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb271-1"><a href="#cb271-1" aria-hidden="true" tabindex="-1"></a>mercur_com <span class="op">=</span> mercur.query(<span class="st">&#39;тип_авто == &quot;коммерческий&quot;&#39;</span>).pivot_table(</span>
<span id="cb271-2"><a href="#cb271-2" aria-hidden="true" tabindex="-1"></a>    index<span class="op">=</span><span class="st">&#39;область&#39;</span>,</span>
<span id="cb271-3"><a href="#cb271-3" aria-hidden="true" tabindex="-1"></a>    columns<span class="op">=</span><span class="st">&#39;бренд&#39;</span>,</span>
<span id="cb271-4"><a href="#cb271-4" aria-hidden="true" tabindex="-1"></a>    values<span class="op">=</span><span class="st">&#39;продажа_usd&#39;</span>,</span>
<span id="cb271-5"><a href="#cb271-5" aria-hidden="true" tabindex="-1"></a>    aggfunc<span class="op">=</span><span class="st">&#39;sum&#39;</span></span>
<span id="cb271-6"><a href="#cb271-6" aria-hidden="true" tabindex="-1"></a>    ) <span class="op">/</span> <span class="dv">1000</span></span>
<span id="cb271-7"><a href="#cb271-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb271-8"><a href="#cb271-8" aria-hidden="true" tabindex="-1"></a>mercur_uncom <span class="op">=</span> mercur.query(<span class="st">&#39;тип_авто == &quot;некоммерческий&quot;&#39;</span>).pivot_table(</span>
<span id="cb271-9"><a href="#cb271-9" aria-hidden="true" tabindex="-1"></a>    index<span class="op">=</span><span class="st">&#39;область&#39;</span>,</span>
<span id="cb271-10"><a href="#cb271-10" aria-hidden="true" tabindex="-1"></a>    columns<span class="op">=</span><span class="st">&#39;бренд&#39;</span>,</span>
<span id="cb271-11"><a href="#cb271-11" aria-hidden="true" tabindex="-1"></a>    values<span class="op">=</span><span class="st">&#39;продажа_usd&#39;</span>,</span>
<span id="cb271-12"><a href="#cb271-12" aria-hidden="true" tabindex="-1"></a>    aggfunc<span class="op">=</span><span class="st">&#39;sum&#39;</span></span>
<span id="cb271-13"><a href="#cb271-13" aria-hidden="true" tabindex="-1"></a>    ) <span class="op">/</span> <span class="dv">1000</span></span></code></pre></div>
</div>
<div class="cell code" data-execution_count="679"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:609}"
id="Lge3dhK4t-4H" data-outputId="833426fc-4b96-49cf-bd4d-86a9d1f2f1b9">
<div class="sourceCode" id="cb272"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb272-1"><a href="#cb272-1" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(<span class="dv">1</span>, <span class="dv">2</span>, figsize<span class="op">=</span>(<span class="dv">15</span>, <span class="dv">6</span>))</span>
<span id="cb272-2"><a href="#cb272-2" aria-hidden="true" tabindex="-1"></a>plt.suptitle(<span class="st">&#39;Продажи по регионам по маркам, тыс.$&#39;</span>)</span>
<span id="cb272-3"><a href="#cb272-3" aria-hidden="true" tabindex="-1"></a>ax <span class="op">=</span> ax.flatten()</span>
<span id="cb272-4"><a href="#cb272-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb272-5"><a href="#cb272-5" aria-hidden="true" tabindex="-1"></a>sns.heatmap(mercur_com,</span>
<span id="cb272-6"><a href="#cb272-6" aria-hidden="true" tabindex="-1"></a>            annot<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb272-7"><a href="#cb272-7" aria-hidden="true" tabindex="-1"></a>            fmt<span class="op">=</span><span class="st">&#39;.1f&#39;</span>,</span>
<span id="cb272-8"><a href="#cb272-8" aria-hidden="true" tabindex="-1"></a>            cbar<span class="op">=</span><span class="va">False</span>,</span>
<span id="cb272-9"><a href="#cb272-9" aria-hidden="true" tabindex="-1"></a>            linewidth<span class="op">=</span><span class="dv">2</span>,</span>
<span id="cb272-10"><a href="#cb272-10" aria-hidden="true" tabindex="-1"></a>            cmap<span class="op">=</span><span class="st">&#39;Blues&#39;</span>,</span>
<span id="cb272-11"><a href="#cb272-11" aria-hidden="true" tabindex="-1"></a>            ax<span class="op">=</span>ax[<span class="dv">0</span>])</span>
<span id="cb272-12"><a href="#cb272-12" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">0</span>].set_title(<span class="st">&#39;Коммерческий транспорт&#39;</span>)</span>
<span id="cb272-13"><a href="#cb272-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb272-14"><a href="#cb272-14" aria-hidden="true" tabindex="-1"></a>sns.heatmap(mercur_uncom,</span>
<span id="cb272-15"><a href="#cb272-15" aria-hidden="true" tabindex="-1"></a>            annot<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb272-16"><a href="#cb272-16" aria-hidden="true" tabindex="-1"></a>            fmt<span class="op">=</span><span class="st">&#39;.1f&#39;</span>,</span>
<span id="cb272-17"><a href="#cb272-17" aria-hidden="true" tabindex="-1"></a>            cbar<span class="op">=</span><span class="va">False</span>,</span>
<span id="cb272-18"><a href="#cb272-18" aria-hidden="true" tabindex="-1"></a>            linewidth<span class="op">=</span><span class="dv">2</span>,</span>
<span id="cb272-19"><a href="#cb272-19" aria-hidden="true" tabindex="-1"></a>            cmap<span class="op">=</span><span class="st">&#39;Blues&#39;</span>,</span>
<span id="cb272-20"><a href="#cb272-20" aria-hidden="true" tabindex="-1"></a>            ax<span class="op">=</span>ax[<span class="dv">1</span>])</span>
<span id="cb272-21"><a href="#cb272-21" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">1</span>].set_title(<span class="st">&#39;Некоммерческий транспорт&#39;</span>)</span>
<span id="cb272-22"><a href="#cb272-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb272-23"><a href="#cb272-23" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb272-24"><a href="#cb272-24" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<div class="output display_data">
<p><img
src="vertopal_9b40e0aaef914c45a9852524805a792d/85c2dd8e7c29839cd18dd8b22e49d40153d126cd.png" /></p>
</div>
</div>
<div class="cell markdown" id="Arz2zuSkngFG">
<p>Рассмотрим продажи по регионам по маркам в разрезе типа авто:</p>
<ol>
<li>Атарыуская область:</li>
</ol>
<ul>
<li>Коммерческие авто - нет;</li>
<li>Некоммерческие авто - Volkswagen (790 тыс. $).</li>
</ul>
<ol>
<li>Г. Алматы:</li>
</ol>
<ul>
<li>Коммерческие авто - Volkswagen (215 тыс. $);</li>
<li>Некоммерческие авто - Volkswagen (6692 тыс. $), Porsche (5040 тыс.
$), Audi (3441 тыс. $).</li>
</ul>
<ol>
<li>Г. Нур-Султан:</li>
</ol>
<ul>
<li>Коммерческие авто - нет;</li>
<li>Некоммерческие авто - Volkswagen (1101 тыс. $), Audi (465 тыс. $),
Porsche (73 тыс. $).</li>
</ul>
<ol>
<li>Западно-Казахстанская область:</li>
</ol>
<ul>
<li>Коммерческие авто - нет;</li>
<li>Некоммерческие авто - Volkswagen (304 тыс. $).</li>
</ul>
<ol>
<li>Карагандинская область:</li>
</ol>
<ul>
<li>Коммерческие авто - нет;</li>
<li>Некоммерческие авто - Volkswagen (429 тыс. $).<br />
</li>
</ul>
<ol>
<li>Костанайская область:</li>
</ol>
<ul>
<li>Коммерческие авто - Volkswagen (36 тыс. $);</li>
<li>Некоммерческие авто - Volkswagen (614 тыс. $), Audi (153 тыс.
$).</li>
</ul>
</div>
<section id="416-конкурентный-анализ" class="cell markdown"
id="EydZuNbEgkb2">
<h2>4.16 Конкурентный анализ</h2>
</section>
<section id="4161-выручка" class="cell markdown" id="xlr9hXRv_PSC">
<h3>4.16.1 Выручка</h3>
</section>
<div class="cell markdown" id="aY4-vWuJTGdY">
<p>Сравним показатели выручки Меркур Авто с конкурентами.</p>
</div>
<div class="cell code" data-execution_count="680" id="8hLROTrSTkXG">
<div class="sourceCode" id="cb273"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb273-1"><a href="#cb273-1" aria-hidden="true" tabindex="-1"></a><span class="co"># у нас есть таблица с Меркур Авто</span></span>
<span id="cb273-2"><a href="#cb273-2" aria-hidden="true" tabindex="-1"></a><span class="co"># теперь создадим таблицу с конкурентами</span></span>
<span id="cb273-3"><a href="#cb273-3" aria-hidden="true" tabindex="-1"></a>competitors <span class="op">=</span> df.query(<span class="st">&#39;компания != &quot;mercur auto&quot;&#39;</span>)</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="681"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:394}"
id="Ogn35Ewwg9M7" data-outputId="12b5ff38-9e1c-49bc-8ac3-87e68ea78397">
<div class="sourceCode" id="cb274"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb274-1"><a href="#cb274-1" aria-hidden="true" tabindex="-1"></a><span class="co"># выведем ТОП-10 компаний по выручке</span></span>
<span id="cb274-2"><a href="#cb274-2" aria-hidden="true" tabindex="-1"></a>top_ten_comp_revenu <span class="op">=</span> (</span>
<span id="cb274-3"><a href="#cb274-3" aria-hidden="true" tabindex="-1"></a>    competitors.groupby(<span class="st">&#39;компания&#39;</span>, as_index<span class="op">=</span><span class="va">False</span>)[<span class="st">&#39;продажа_usd&#39;</span>].<span class="bu">sum</span>()</span>
<span id="cb274-4"><a href="#cb274-4" aria-hidden="true" tabindex="-1"></a>    .nlargest(<span class="dv">10</span>, <span class="st">&#39;продажа_usd&#39;</span>)</span>
<span id="cb274-5"><a href="#cb274-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb274-6"><a href="#cb274-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb274-7"><a href="#cb274-7" aria-hidden="true" tabindex="-1"></a><span class="co"># добавим туда показатель Меркур Авто</span></span>
<span id="cb274-8"><a href="#cb274-8" aria-hidden="true" tabindex="-1"></a>top_revenue <span class="op">=</span> pd.concat([top_ten_comp_revenu,</span>
<span id="cb274-9"><a href="#cb274-9" aria-hidden="true" tabindex="-1"></a>                         mercur.groupby(<span class="st">&#39;компания&#39;</span>, as_index<span class="op">=</span><span class="va">False</span>)<span class="op">\</span></span>
<span id="cb274-10"><a href="#cb274-10" aria-hidden="true" tabindex="-1"></a>                          [<span class="st">&#39;продажа_usd&#39;</span>].<span class="bu">sum</span>()],</span>
<span id="cb274-11"><a href="#cb274-11" aria-hidden="true" tabindex="-1"></a>                        axis<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb274-12"><a href="#cb274-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb274-13"><a href="#cb274-13" aria-hidden="true" tabindex="-1"></a><span class="co"># приведем к тыс.$</span></span>
<span id="cb274-14"><a href="#cb274-14" aria-hidden="true" tabindex="-1"></a>top_revenue[<span class="st">&#39;продажа_usd&#39;</span>] <span class="op">=</span> <span class="bu">round</span>(top_revenue[<span class="st">&#39;продажа_usd&#39;</span>] <span class="op">/</span> <span class="dv">1000</span>, <span class="dv">2</span>)</span>
<span id="cb274-15"><a href="#cb274-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb274-16"><a href="#cb274-16" aria-hidden="true" tabindex="-1"></a><span class="co"># сортируем по убыванию выручки</span></span>
<span id="cb274-17"><a href="#cb274-17" aria-hidden="true" tabindex="-1"></a>top_revenue <span class="op">=</span> (</span>
<span id="cb274-18"><a href="#cb274-18" aria-hidden="true" tabindex="-1"></a>    top_revenue.sort_values(by<span class="op">=</span><span class="st">&#39;продажа_usd&#39;</span>, ascending<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb274-19"><a href="#cb274-19" aria-hidden="true" tabindex="-1"></a>    .reset_index(drop<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb274-20"><a href="#cb274-20" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb274-21"><a href="#cb274-21" aria-hidden="true" tabindex="-1"></a>top_revenue</span></code></pre></div>
<div class="output execute_result" data-execution_count="681">

  <div id="df-34bcac2e-01b8-4909-991d-ef6d02f7e60e" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>компания</th>
      <th>продажа_usd</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>toyota motor kazakhstan</td>
      <td>479876.44</td>
    </tr>
    <tr>
      <th>1</th>
      <td>astana motors</td>
      <td>229338.60</td>
    </tr>
    <tr>
      <th>2</th>
      <td>бипэк авто</td>
      <td>186017.77</td>
    </tr>
    <tr>
      <th>3</th>
      <td>allur auto</td>
      <td>66512.28</td>
    </tr>
    <tr>
      <th>4</th>
      <td>nissan manufacturing rus</td>
      <td>46289.50</td>
    </tr>
    <tr>
      <th>5</th>
      <td>тк камаз</td>
      <td>46215.93</td>
    </tr>
    <tr>
      <th>6</th>
      <td>вираж</td>
      <td>46124.76</td>
    </tr>
    <tr>
      <th>7</th>
      <td>автоцентр-бавария</td>
      <td>29219.72</td>
    </tr>
    <tr>
      <th>8</th>
      <td>renault россия</td>
      <td>24184.91</td>
    </tr>
    <tr>
      <th>9</th>
      <td>mercur auto</td>
      <td>19355.28</td>
    </tr>
    <tr>
      <th>10</th>
      <td>subaru kazakhstan</td>
      <td>16158.33</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-34bcac2e-01b8-4909-991d-ef6d02f7e60e')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-34bcac2e-01b8-4909-991d-ef6d02f7e60e button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-34bcac2e-01b8-4909-991d-ef6d02f7e60e');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-d125af0c-7b35-4e57-86d8-9c2da5faa2e0">
  <button class="colab-df-quickchart" onclick="quickchart('df-d125af0c-7b35-4e57-86d8-9c2da5faa2e0')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-d125af0c-7b35-4e57-86d8-9c2da5faa2e0 button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>
    </div>
  </div>

</div>
</div>
<div class="cell code" data-execution_count="682" id="MeNIurQIVgWC">
<div class="sourceCode" id="cb275"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb275-1"><a href="#cb275-1" aria-hidden="true" tabindex="-1"></a>colors <span class="op">=</span> [<span class="st">&#39;lightgray&#39;</span>] <span class="op">*</span> <span class="dv">9</span> <span class="op">+</span> [<span class="st">&#39;#051094&#39;</span>] <span class="op">+</span> [<span class="st">&#39;lightgray&#39;</span>]</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="683"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:668}"
id="aiVFAF5dTQR0" data-outputId="6abab670-881e-4f5a-8bc4-5b4d72578aa4">
<div class="sourceCode" id="cb276"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb276-1"><a href="#cb276-1" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">15</span>, <span class="dv">6</span>))</span>
<span id="cb276-2"><a href="#cb276-2" aria-hidden="true" tabindex="-1"></a>sns.barplot(top_revenue,</span>
<span id="cb276-3"><a href="#cb276-3" aria-hidden="true" tabindex="-1"></a>            x<span class="op">=</span><span class="st">&#39;компания&#39;</span>,</span>
<span id="cb276-4"><a href="#cb276-4" aria-hidden="true" tabindex="-1"></a>            y<span class="op">=</span><span class="st">&#39;продажа_usd&#39;</span>,</span>
<span id="cb276-5"><a href="#cb276-5" aria-hidden="true" tabindex="-1"></a>            palette<span class="op">=</span>colors)</span>
<span id="cb276-6"><a href="#cb276-6" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">&#39;Компания&#39;</span>)</span>
<span id="cb276-7"><a href="#cb276-7" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">&#39;Выручка, тыс.$&#39;</span>)</span>
<span id="cb276-8"><a href="#cb276-8" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">&#39;Сравнение выручки Меркур Авто с конкурентами из ТОП-10&#39;</span>)</span>
<span id="cb276-9"><a href="#cb276-9" aria-hidden="true" tabindex="-1"></a>plt.xticks(rotation<span class="op">=</span><span class="dv">45</span>)<span class="op">;</span></span></code></pre></div>
<div class="output display_data">
<p><img
src="vertopal_9b40e0aaef914c45a9852524805a792d/36f09a2fc41a988d87f51c4fb36a2d4c7022f288.png" /></p>
</div>
</div>
<div class="cell markdown" id="heVMVlGpWOVB">
<p>Меркур Авто входит в ТОП-10 компаний по выручке в Казахстане
(занимает 10 место).</p>
</div>
<section id="4162-количество-регионов" class="cell markdown"
id="_HxLpLtF_TJx">
<h3>4.16.2 Количество регионов</h3>
</section>
<div class="cell markdown" id="igOhsZXc_ZWi">
<p>Сравним количество регионов, где есть Меркур Авто, с
конкурентами.</p>
</div>
<div class="cell code" data-execution_count="684"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:1000}"
id="P7wn_32A_iA2" data-outputId="91dcbc60-5449-486f-d424-c2d5339138a0">
<div class="sourceCode" id="cb277"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb277-1"><a href="#cb277-1" aria-hidden="true" tabindex="-1"></a><span class="co"># посчитаем количество регионов у каждой компании</span></span>
<span id="cb277-2"><a href="#cb277-2" aria-hidden="true" tabindex="-1"></a>region_count <span class="op">=</span> (</span>
<span id="cb277-3"><a href="#cb277-3" aria-hidden="true" tabindex="-1"></a>    df.groupby(<span class="st">&#39;компания&#39;</span>, as_index<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb277-4"><a href="#cb277-4" aria-hidden="true" tabindex="-1"></a>    .agg({<span class="st">&#39;область&#39;</span>: <span class="st">&#39;nunique&#39;</span>})</span>
<span id="cb277-5"><a href="#cb277-5" aria-hidden="true" tabindex="-1"></a>    .sort_values(by<span class="op">=</span><span class="st">&#39;область&#39;</span>, ascending<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb277-6"><a href="#cb277-6" aria-hidden="true" tabindex="-1"></a>    .reset_index(drop<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb277-7"><a href="#cb277-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb277-8"><a href="#cb277-8" aria-hidden="true" tabindex="-1"></a>region_count</span></code></pre></div>
<div class="output execute_result" data-execution_count="684">

  <div id="df-06f9084d-0f5c-44a2-b70d-afa327d20b9b" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>компания</th>
      <th>область</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>ravon motors kazakstan</td>
      <td>17</td>
    </tr>
    <tr>
      <th>1</th>
      <td>astana motors</td>
      <td>17</td>
    </tr>
    <tr>
      <th>2</th>
      <td>вираж</td>
      <td>16</td>
    </tr>
    <tr>
      <th>3</th>
      <td>бипэк авто</td>
      <td>16</td>
    </tr>
    <tr>
      <th>4</th>
      <td>toyota motor kazakhstan</td>
      <td>16</td>
    </tr>
    <tr>
      <th>5</th>
      <td>allur auto</td>
      <td>15</td>
    </tr>
    <tr>
      <th>6</th>
      <td>subaru kazakhstan</td>
      <td>15</td>
    </tr>
    <tr>
      <th>7</th>
      <td>семаз</td>
      <td>14</td>
    </tr>
    <tr>
      <th>8</th>
      <td>renault россия</td>
      <td>14</td>
    </tr>
    <tr>
      <th>9</th>
      <td>узавто-казахстан</td>
      <td>13</td>
    </tr>
    <tr>
      <th>10</th>
      <td>nissan manufacturing rus</td>
      <td>12</td>
    </tr>
    <tr>
      <th>11</th>
      <td>тк камаз</td>
      <td>11</td>
    </tr>
    <tr>
      <th>12</th>
      <td>лифан моторс рус</td>
      <td>10</td>
    </tr>
    <tr>
      <th>13</th>
      <td>ммс рус</td>
      <td>8</td>
    </tr>
    <tr>
      <th>14</th>
      <td>volkswagen group rus</td>
      <td>6</td>
    </tr>
    <tr>
      <th>15</th>
      <td>mercur auto</td>
      <td>6</td>
    </tr>
    <tr>
      <th>16</th>
      <td>автоцентр-бавария</td>
      <td>5</td>
    </tr>
    <tr>
      <th>17</th>
      <td>autokapital</td>
      <td>4</td>
    </tr>
    <tr>
      <th>18</th>
      <td>daewoo bus kazakhstan</td>
      <td>4</td>
    </tr>
    <tr>
      <th>19</th>
      <td>автокапитал</td>
      <td>3</td>
    </tr>
    <tr>
      <th>20</th>
      <td>свс-транс</td>
      <td>2</td>
    </tr>
    <tr>
      <th>21</th>
      <td>eurasia motor premium</td>
      <td>2</td>
    </tr>
    <tr>
      <th>22</th>
      <td>автомир-центр</td>
      <td>2</td>
    </tr>
    <tr>
      <th>23</th>
      <td>автодом motors kst</td>
      <td>1</td>
    </tr>
    <tr>
      <th>24</th>
      <td>hino motors</td>
      <td>1</td>
    </tr>
    <tr>
      <th>25</th>
      <td>каспиан моторс</td>
      <td>1</td>
    </tr>
    <tr>
      <th>26</th>
      <td>almaty motors premium</td>
      <td>1</td>
    </tr>
    <tr>
      <th>27</th>
      <td>hyundai com trans kazakhstan</td>
      <td>1</td>
    </tr>
    <tr>
      <th>28</th>
      <td>scania central asia</td>
      <td>1</td>
    </tr>
    <tr>
      <th>29</th>
      <td>scandinavian motors</td>
      <td>1</td>
    </tr>
    <tr>
      <th>30</th>
      <td>man truck &amp; bus kazakhstan</td>
      <td>1</td>
    </tr>
    <tr>
      <th>31</th>
      <td>terra motors</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-06f9084d-0f5c-44a2-b70d-afa327d20b9b')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-06f9084d-0f5c-44a2-b70d-afa327d20b9b button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-06f9084d-0f5c-44a2-b70d-afa327d20b9b');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-b4bee68d-32ed-4314-b209-d6f7cf4194f4">
  <button class="colab-df-quickchart" onclick="quickchart('df-b4bee68d-32ed-4314-b209-d6f7cf4194f4')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-b4bee68d-32ed-4314-b209-d6f7cf4194f4 button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>
    </div>
  </div>

</div>
</div>
<div class="cell code" data-execution_count="685"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:551}"
id="90MVPhxyA5iw" data-outputId="3fc9062e-2990-4f4a-cfa1-13276428245f">
<div class="sourceCode" id="cb278"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb278-1"><a href="#cb278-1" aria-hidden="true" tabindex="-1"></a><span class="co"># рассмотрим области, которые превосходят Меркур Авто</span></span>
<span id="cb278-2"><a href="#cb278-2" aria-hidden="true" tabindex="-1"></a>region_count <span class="op">=</span> (</span>
<span id="cb278-3"><a href="#cb278-3" aria-hidden="true" tabindex="-1"></a>    region_count.iloc[:region_count[region_count[<span class="st">&#39;компания&#39;</span>] <span class="op">==</span> <span class="st">&#39;mercur auto&#39;</span>]</span>
<span id="cb278-4"><a href="#cb278-4" aria-hidden="true" tabindex="-1"></a>                      .index.values[<span class="dv">0</span>] <span class="op">+</span> <span class="dv">1</span>]</span>
<span id="cb278-5"><a href="#cb278-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb278-6"><a href="#cb278-6" aria-hidden="true" tabindex="-1"></a>region_count</span></code></pre></div>
<div class="output execute_result" data-execution_count="685">

  <div id="df-ca710913-1f0a-4c44-87d7-6bb98db1e574" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>компания</th>
      <th>область</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>ravon motors kazakstan</td>
      <td>17</td>
    </tr>
    <tr>
      <th>1</th>
      <td>astana motors</td>
      <td>17</td>
    </tr>
    <tr>
      <th>2</th>
      <td>вираж</td>
      <td>16</td>
    </tr>
    <tr>
      <th>3</th>
      <td>бипэк авто</td>
      <td>16</td>
    </tr>
    <tr>
      <th>4</th>
      <td>toyota motor kazakhstan</td>
      <td>16</td>
    </tr>
    <tr>
      <th>5</th>
      <td>allur auto</td>
      <td>15</td>
    </tr>
    <tr>
      <th>6</th>
      <td>subaru kazakhstan</td>
      <td>15</td>
    </tr>
    <tr>
      <th>7</th>
      <td>семаз</td>
      <td>14</td>
    </tr>
    <tr>
      <th>8</th>
      <td>renault россия</td>
      <td>14</td>
    </tr>
    <tr>
      <th>9</th>
      <td>узавто-казахстан</td>
      <td>13</td>
    </tr>
    <tr>
      <th>10</th>
      <td>nissan manufacturing rus</td>
      <td>12</td>
    </tr>
    <tr>
      <th>11</th>
      <td>тк камаз</td>
      <td>11</td>
    </tr>
    <tr>
      <th>12</th>
      <td>лифан моторс рус</td>
      <td>10</td>
    </tr>
    <tr>
      <th>13</th>
      <td>ммс рус</td>
      <td>8</td>
    </tr>
    <tr>
      <th>14</th>
      <td>volkswagen group rus</td>
      <td>6</td>
    </tr>
    <tr>
      <th>15</th>
      <td>mercur auto</td>
      <td>6</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-ca710913-1f0a-4c44-87d7-6bb98db1e574')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-ca710913-1f0a-4c44-87d7-6bb98db1e574 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-ca710913-1f0a-4c44-87d7-6bb98db1e574');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-5b8209c5-01e5-4c51-9715-6b1108515d35">
  <button class="colab-df-quickchart" onclick="quickchart('df-5b8209c5-01e5-4c51-9715-6b1108515d35')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-5b8209c5-01e5-4c51-9715-6b1108515d35 button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>
    </div>
  </div>

</div>
</div>
<div class="cell code" data-execution_count="686"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:607}"
id="fVcbWCzXCVmq" data-outputId="414cbec0-bb83-46b7-eb11-041d04a50078">
<div class="sourceCode" id="cb279"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb279-1"><a href="#cb279-1" aria-hidden="true" tabindex="-1"></a>colors <span class="op">=</span> [<span class="st">&#39;lightgray&#39;</span>] <span class="op">*</span> <span class="dv">15</span> <span class="op">+</span> [<span class="st">&#39;#051094&#39;</span>]</span>
<span id="cb279-2"><a href="#cb279-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb279-3"><a href="#cb279-3" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">15</span>, <span class="dv">6</span>))</span>
<span id="cb279-4"><a href="#cb279-4" aria-hidden="true" tabindex="-1"></a><span class="co"># построим график</span></span>
<span id="cb279-5"><a href="#cb279-5" aria-hidden="true" tabindex="-1"></a>sns.barplot(region_count, x<span class="op">=</span><span class="st">&#39;компания&#39;</span>, y<span class="op">=</span><span class="st">&#39;область&#39;</span>, palette<span class="op">=</span>colors)</span>
<span id="cb279-6"><a href="#cb279-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb279-7"><a href="#cb279-7" aria-hidden="true" tabindex="-1"></a>plt.xticks(rotation<span class="op">=</span><span class="dv">90</span>)</span>
<span id="cb279-8"><a href="#cb279-8" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">&#39;Название компании&#39;</span>)</span>
<span id="cb279-9"><a href="#cb279-9" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">&#39;Количество областей&#39;</span>)</span>
<span id="cb279-10"><a href="#cb279-10" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">&#39;Количество областей у дилеров&#39;</span>)</span>
<span id="cb279-11"><a href="#cb279-11" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()<span class="op">;</span></span></code></pre></div>
<div class="output display_data">
<p><img
src="vertopal_9b40e0aaef914c45a9852524805a792d/221c8cd4e090f7ca8f669f67c95a924778a1f68d.png" /></p>
</div>
</div>
<div class="cell markdown" id="GL0MI-m7CgrL">
<p>Из 32 компаний Меркур Авто занимает 16 место по количеству областей,
где есть этот дилер.</p>
</div>
<section id="417-bcg-анализ" class="cell markdown" id="luT0fKJSgn8X">
<h2>4.17 BCG анализ</h2>
</section>
<div class="cell markdown" id="WUPVq4w6grCY">
<p>Проведем BCG анализ по моделям авто Меркур Авто.</p>
<p>Для нахождения доли рынка будем использовать показатель объема продаж
по модели по рынку вцелом.</p>
<p>Так как известно, что Volkswagen с июня не продает свои модели в
Меркур Авто, то для данной марки возьмем период с января по май. Для
остальных моделей с января по сентябрь.</p>
<p>Для нахождения темпа роста нужно знать объемы продаж за текущий и
предыдущий период. У нас данные с января по сентябрь. Темп роста будем
искать по среднему значению ежемесячного роста. Поэтому нам нужны авто,
которые продавались хотя бы 2 месяца.</p>
</div>
<div class="cell code" data-execution_count="687"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:519}"
id="k-ZyDu1KIqc7" data-outputId="8a1dcc4c-05cd-4982-a44c-fd21682f1e51">
<div class="sourceCode" id="cb280"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb280-1"><a href="#cb280-1" aria-hidden="true" tabindex="-1"></a><span class="co"># найдем объем продаж для каждой модели авто Меркур Авто</span></span>
<span id="cb280-2"><a href="#cb280-2" aria-hidden="true" tabindex="-1"></a>mercur_model_revenue <span class="op">=</span> (</span>
<span id="cb280-3"><a href="#cb280-3" aria-hidden="true" tabindex="-1"></a>    mercur.groupby(<span class="st">&#39;авто&#39;</span>, as_index<span class="op">=</span><span class="va">False</span>).agg({<span class="st">&#39;продажа_usd&#39;</span>: <span class="st">&#39;sum&#39;</span>,</span>
<span id="cb280-4"><a href="#cb280-4" aria-hidden="true" tabindex="-1"></a>                                                <span class="st">&#39;дата&#39;</span>: <span class="st">&#39;nunique&#39;</span>})</span>
<span id="cb280-5"><a href="#cb280-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb280-6"><a href="#cb280-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb280-7"><a href="#cb280-7" aria-hidden="true" tabindex="-1"></a><span class="co"># удалим модели, которые продаваллись меньше 2 месяцев</span></span>
<span id="cb280-8"><a href="#cb280-8" aria-hidden="true" tabindex="-1"></a>mercur_model_revenue <span class="op">=</span> mercur_model_revenue[mercur_model_revenue[<span class="st">&#39;дата&#39;</span>] <span class="op">&gt;</span> <span class="dv">1</span>]</span>
<span id="cb280-9"><a href="#cb280-9" aria-hidden="true" tabindex="-1"></a>mercur_model_revenue</span></code></pre></div>
<div class="output execute_result" data-execution_count="687">

  <div id="df-32f7cb68-d9b5-40b2-9063-3bb1b88eee2b" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>авто</th>
      <th>продажа_usd</th>
      <th>дата</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>audi a3</td>
      <td>60361.99</td>
      <td>2</td>
    </tr>
    <tr>
      <th>1</th>
      <td>audi a4</td>
      <td>95858.00</td>
      <td>2</td>
    </tr>
    <tr>
      <th>2</th>
      <td>audi a6</td>
      <td>607692.51</td>
      <td>5</td>
    </tr>
    <tr>
      <th>4</th>
      <td>audi a8</td>
      <td>557799.21</td>
      <td>3</td>
    </tr>
    <tr>
      <th>5</th>
      <td>audi q5</td>
      <td>433237.39</td>
      <td>4</td>
    </tr>
    <tr>
      <th>6</th>
      <td>audi q7</td>
      <td>233073.00</td>
      <td>2</td>
    </tr>
    <tr>
      <th>7</th>
      <td>audi q8</td>
      <td>1793118.33</td>
      <td>7</td>
    </tr>
    <tr>
      <th>10</th>
      <td>porsche cayenne</td>
      <td>2856255.46</td>
      <td>9</td>
    </tr>
    <tr>
      <th>11</th>
      <td>porsche macan</td>
      <td>1015619.57</td>
      <td>6</td>
    </tr>
    <tr>
      <th>12</th>
      <td>porsche panamera</td>
      <td>1079061.59</td>
      <td>4</td>
    </tr>
    <tr>
      <th>15</th>
      <td>volkswagen multivan</td>
      <td>211161.32</td>
      <td>3</td>
    </tr>
    <tr>
      <th>16</th>
      <td>volkswagen polo</td>
      <td>6418764.24</td>
      <td>5</td>
    </tr>
    <tr>
      <th>17</th>
      <td>volkswagen teramont</td>
      <td>216315.33</td>
      <td>3</td>
    </tr>
    <tr>
      <th>18</th>
      <td>volkswagen tiguan</td>
      <td>2642563.72</td>
      <td>5</td>
    </tr>
    <tr>
      <th>20</th>
      <td>volkswagen transporter</td>
      <td>73029.08</td>
      <td>2</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-32f7cb68-d9b5-40b2-9063-3bb1b88eee2b')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-32f7cb68-d9b5-40b2-9063-3bb1b88eee2b button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-32f7cb68-d9b5-40b2-9063-3bb1b88eee2b');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-503d048d-b89b-4fd6-b7a6-ae3c07f41c74">
  <button class="colab-df-quickchart" onclick="quickchart('df-503d048d-b89b-4fd6-b7a6-ae3c07f41c74')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-503d048d-b89b-4fd6-b7a6-ae3c07f41c74 button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>
    </div>
  </div>

</div>
</div>
<div class="cell markdown" id="nRdqR_BKkZPz">
<p>Для нахождения темпов роста каждой модели возьмем средний темп роста
по месяцам.</p>
</div>
<div class="cell code" data-execution_count="688"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:423}"
id="q9zIehKHn811" data-outputId="87d7d7fd-c461-4cf7-dcee-559fc77eb6d7">
<div class="sourceCode" id="cb281"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb281-1"><a href="#cb281-1" aria-hidden="true" tabindex="-1"></a><span class="co"># построим таблицу продаж модели авто Меркур Авто по месяцам</span></span>
<span id="cb281-2"><a href="#cb281-2" aria-hidden="true" tabindex="-1"></a>new_mercur_df <span class="op">=</span> (</span>
<span id="cb281-3"><a href="#cb281-3" aria-hidden="true" tabindex="-1"></a>    mercur[mercur[<span class="st">&#39;авто&#39;</span>].isin(mercur_model_revenue[<span class="st">&#39;авто&#39;</span>])]</span>
<span id="cb281-4"><a href="#cb281-4" aria-hidden="true" tabindex="-1"></a>    .groupby([<span class="st">&#39;авто&#39;</span>, <span class="st">&#39;дата&#39;</span>])[<span class="st">&#39;продажа_usd&#39;</span>]</span>
<span id="cb281-5"><a href="#cb281-5" aria-hidden="true" tabindex="-1"></a>    .agg({<span class="st">&#39;sum&#39;</span>})</span>
<span id="cb281-6"><a href="#cb281-6" aria-hidden="true" tabindex="-1"></a>    .reset_index()</span>
<span id="cb281-7"><a href="#cb281-7" aria-hidden="true" tabindex="-1"></a>    .sort_values(by<span class="op">=</span>[<span class="st">&#39;авто&#39;</span>, <span class="st">&#39;дата&#39;</span>])</span>
<span id="cb281-8"><a href="#cb281-8" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb281-9"><a href="#cb281-9" aria-hidden="true" tabindex="-1"></a>new_mercur_df</span></code></pre></div>
<div class="output execute_result" data-execution_count="688">

  <div id="df-00aeb9a2-c8f2-4ac2-ba99-9b30d7cc34db" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>авто</th>
      <th>дата</th>
      <th>sum</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>audi a3</td>
      <td>2019-05-01</td>
      <td>28115.00</td>
    </tr>
    <tr>
      <th>1</th>
      <td>audi a3</td>
      <td>2019-08-01</td>
      <td>32246.99</td>
    </tr>
    <tr>
      <th>2</th>
      <td>audi a4</td>
      <td>2019-04-01</td>
      <td>32000.00</td>
    </tr>
    <tr>
      <th>3</th>
      <td>audi a4</td>
      <td>2019-07-01</td>
      <td>63858.00</td>
    </tr>
    <tr>
      <th>4</th>
      <td>audi a6</td>
      <td>2019-02-01</td>
      <td>42608.25</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>57</th>
      <td>volkswagen tiguan</td>
      <td>2019-03-01</td>
      <td>497606.75</td>
    </tr>
    <tr>
      <th>58</th>
      <td>volkswagen tiguan</td>
      <td>2019-04-01</td>
      <td>384748.13</td>
    </tr>
    <tr>
      <th>59</th>
      <td>volkswagen tiguan</td>
      <td>2019-05-01</td>
      <td>586137.63</td>
    </tr>
    <tr>
      <th>60</th>
      <td>volkswagen transporter</td>
      <td>2019-02-01</td>
      <td>36520.77</td>
    </tr>
    <tr>
      <th>61</th>
      <td>volkswagen transporter</td>
      <td>2019-03-01</td>
      <td>36508.31</td>
    </tr>
  </tbody>
</table>
<p>62 rows × 3 columns</p>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-00aeb9a2-c8f2-4ac2-ba99-9b30d7cc34db')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-00aeb9a2-c8f2-4ac2-ba99-9b30d7cc34db button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-00aeb9a2-c8f2-4ac2-ba99-9b30d7cc34db');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-d5e46f90-8f0b-4e87-9b78-b24c72e26f5f">
  <button class="colab-df-quickchart" onclick="quickchart('df-d5e46f90-8f0b-4e87-9b78-b24c72e26f5f')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-d5e46f90-8f0b-4e87-9b78-b24c72e26f5f button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>
    </div>
  </div>

</div>
</div>
<div class="cell code" data-execution_count="689"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:423}"
id="e1JMTnCNqQg5" data-outputId="e6368f10-25ec-4153-bf59-2365f5477f7f">
<div class="sourceCode" id="cb282"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb282-1"><a href="#cb282-1" aria-hidden="true" tabindex="-1"></a><span class="co"># найдем отношение последнего периода продажи к первому в процентах</span></span>
<span id="cb282-2"><a href="#cb282-2" aria-hidden="true" tabindex="-1"></a>new_mercur_df[<span class="st">&#39;ratio&#39;</span>] <span class="op">=</span> (</span>
<span id="cb282-3"><a href="#cb282-3" aria-hidden="true" tabindex="-1"></a>    new_mercur_df.groupby(<span class="st">&#39;авто&#39;</span>)[<span class="st">&#39;sum&#39;</span>].transform(<span class="st">&#39;last&#39;</span>) <span class="op">/</span></span>
<span id="cb282-4"><a href="#cb282-4" aria-hidden="true" tabindex="-1"></a>    new_mercur_df.sort_values(by<span class="op">=</span><span class="st">&#39;дата&#39;</span>)</span>
<span id="cb282-5"><a href="#cb282-5" aria-hidden="true" tabindex="-1"></a>    .groupby(<span class="st">&#39;авто&#39;</span>)[<span class="st">&#39;sum&#39;</span>].transform(<span class="st">&#39;first&#39;</span>) <span class="op">*</span> <span class="dv">100</span></span>
<span id="cb282-6"><a href="#cb282-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb282-7"><a href="#cb282-7" aria-hidden="true" tabindex="-1"></a>new_mercur_df</span></code></pre></div>
<div class="output execute_result" data-execution_count="689">

  <div id="df-18463cd2-b794-475b-9d71-ca147b76ab54" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>авто</th>
      <th>дата</th>
      <th>sum</th>
      <th>ratio</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>audi a3</td>
      <td>2019-05-01</td>
      <td>28115.00</td>
      <td>114.70</td>
    </tr>
    <tr>
      <th>1</th>
      <td>audi a3</td>
      <td>2019-08-01</td>
      <td>32246.99</td>
      <td>114.70</td>
    </tr>
    <tr>
      <th>2</th>
      <td>audi a4</td>
      <td>2019-04-01</td>
      <td>32000.00</td>
      <td>199.56</td>
    </tr>
    <tr>
      <th>3</th>
      <td>audi a4</td>
      <td>2019-07-01</td>
      <td>63858.00</td>
      <td>199.56</td>
    </tr>
    <tr>
      <th>4</th>
      <td>audi a6</td>
      <td>2019-02-01</td>
      <td>42608.25</td>
      <td>413.20</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>57</th>
      <td>volkswagen tiguan</td>
      <td>2019-03-01</td>
      <td>497606.75</td>
      <td>162.87</td>
    </tr>
    <tr>
      <th>58</th>
      <td>volkswagen tiguan</td>
      <td>2019-04-01</td>
      <td>384748.13</td>
      <td>162.87</td>
    </tr>
    <tr>
      <th>59</th>
      <td>volkswagen tiguan</td>
      <td>2019-05-01</td>
      <td>586137.63</td>
      <td>162.87</td>
    </tr>
    <tr>
      <th>60</th>
      <td>volkswagen transporter</td>
      <td>2019-02-01</td>
      <td>36520.77</td>
      <td>99.97</td>
    </tr>
    <tr>
      <th>61</th>
      <td>volkswagen transporter</td>
      <td>2019-03-01</td>
      <td>36508.31</td>
      <td>99.97</td>
    </tr>
  </tbody>
</table>
<p>62 rows × 4 columns</p>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-18463cd2-b794-475b-9d71-ca147b76ab54')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-18463cd2-b794-475b-9d71-ca147b76ab54 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-18463cd2-b794-475b-9d71-ca147b76ab54');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-a001ab7a-fae6-4cc4-9462-826ef867ba71">
  <button class="colab-df-quickchart" onclick="quickchart('df-a001ab7a-fae6-4cc4-9462-826ef867ba71')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-a001ab7a-fae6-4cc4-9462-826ef867ba71 button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>
    </div>
  </div>

</div>
</div>
<div class="cell code" data-execution_count="690"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:519}"
id="e1FmbsCfqRgA" data-outputId="0e4687b3-cdfc-454d-9967-90ff25d6bf86">
<div class="sourceCode" id="cb283"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb283-1"><a href="#cb283-1" aria-hidden="true" tabindex="-1"></a><span class="co"># посчитаем среднее значение для каждого авто</span></span>
<span id="cb283-2"><a href="#cb283-2" aria-hidden="true" tabindex="-1"></a>model_avg_growth <span class="op">=</span> (</span>
<span id="cb283-3"><a href="#cb283-3" aria-hidden="true" tabindex="-1"></a>    new_mercur_df</span>
<span id="cb283-4"><a href="#cb283-4" aria-hidden="true" tabindex="-1"></a>    .groupby(<span class="st">&#39;авто&#39;</span>, as_index<span class="op">=</span><span class="va">False</span>)[<span class="st">&#39;ratio&#39;</span>].agg(<span class="st">&#39;mean&#39;</span>)</span>
<span id="cb283-5"><a href="#cb283-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb283-6"><a href="#cb283-6" aria-hidden="true" tabindex="-1"></a>model_avg_growth</span></code></pre></div>
<div class="output execute_result" data-execution_count="690">

  <div id="df-2476c951-b252-42ec-b3f1-1eaf10bccd92" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>авто</th>
      <th>ratio</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>audi a3</td>
      <td>114.70</td>
    </tr>
    <tr>
      <th>1</th>
      <td>audi a4</td>
      <td>199.56</td>
    </tr>
    <tr>
      <th>2</th>
      <td>audi a6</td>
      <td>413.20</td>
    </tr>
    <tr>
      <th>3</th>
      <td>audi a8</td>
      <td>189.02</td>
    </tr>
    <tr>
      <th>4</th>
      <td>audi q5</td>
      <td>122.76</td>
    </tr>
    <tr>
      <th>5</th>
      <td>audi q7</td>
      <td>162.62</td>
    </tr>
    <tr>
      <th>6</th>
      <td>audi q8</td>
      <td>63.06</td>
    </tr>
    <tr>
      <th>7</th>
      <td>porsche cayenne</td>
      <td>375.29</td>
    </tr>
    <tr>
      <th>8</th>
      <td>porsche macan</td>
      <td>148.84</td>
    </tr>
    <tr>
      <th>9</th>
      <td>porsche panamera</td>
      <td>82.68</td>
    </tr>
    <tr>
      <th>10</th>
      <td>volkswagen multivan</td>
      <td>99.97</td>
    </tr>
    <tr>
      <th>11</th>
      <td>volkswagen polo</td>
      <td>86.86</td>
    </tr>
    <tr>
      <th>12</th>
      <td>volkswagen teramont</td>
      <td>93.79</td>
    </tr>
    <tr>
      <th>13</th>
      <td>volkswagen tiguan</td>
      <td>162.87</td>
    </tr>
    <tr>
      <th>14</th>
      <td>volkswagen transporter</td>
      <td>99.97</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-2476c951-b252-42ec-b3f1-1eaf10bccd92')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-2476c951-b252-42ec-b3f1-1eaf10bccd92 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-2476c951-b252-42ec-b3f1-1eaf10bccd92');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-039aba91-8e31-433c-98ff-026c72e4bcdb">
  <button class="colab-df-quickchart" onclick="quickchart('df-039aba91-8e31-433c-98ff-026c72e4bcdb')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-039aba91-8e31-433c-98ff-026c72e4bcdb button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>
    </div>
  </div>

</div>
</div>
<div class="cell markdown" id="9vkVkNdhqo2Z">
<p>Мы нашли темп роста для моделей авто Меркур Авто. Теперь необходимо
сравнить объем продаж каждой модели Меркур Авто с объемом продаж моедли
по всему рынку.</p>
</div>
<div class="cell code" data-execution_count="691" id="ERdR-I5Qvg1k">
<div class="sourceCode" id="cb284"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb284-1"><a href="#cb284-1" aria-hidden="true" tabindex="-1"></a><span class="co"># удалим столбец дата из таблицы продаж моделей Меркур Авто</span></span>
<span id="cb284-2"><a href="#cb284-2" aria-hidden="true" tabindex="-1"></a>mercur_model_revenue <span class="op">=</span> mercur_model_revenue.drop(columns<span class="op">=</span><span class="st">&#39;дата&#39;</span>)</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="692"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:519}"
id="K4HFmrs4wj3G" data-outputId="7b11aaba-f754-4041-cde8-bec7336a42b6">
<div class="sourceCode" id="cb285"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb285-1"><a href="#cb285-1" aria-hidden="true" tabindex="-1"></a><span class="co"># найдем объемы продаж моделей на рынке</span></span>
<span id="cb285-2"><a href="#cb285-2" aria-hidden="true" tabindex="-1"></a>df_model_revenue <span class="op">=</span> (</span>
<span id="cb285-3"><a href="#cb285-3" aria-hidden="true" tabindex="-1"></a>    df[(df[<span class="st">&#39;авто&#39;</span>].isin(mercur_model_revenue[<span class="st">&#39;авто&#39;</span>])) <span class="op">&amp;</span></span>
<span id="cb285-4"><a href="#cb285-4" aria-hidden="true" tabindex="-1"></a>     (df[<span class="st">&#39;бренд&#39;</span>] <span class="op">!=</span> <span class="st">&#39;volkswagen&#39;</span>)]</span>
<span id="cb285-5"><a href="#cb285-5" aria-hidden="true" tabindex="-1"></a>    .groupby(<span class="st">&#39;авто&#39;</span>)[<span class="st">&#39;продажа_usd&#39;</span>]</span>
<span id="cb285-6"><a href="#cb285-6" aria-hidden="true" tabindex="-1"></a>    .agg({<span class="st">&#39;sum&#39;</span>})</span>
<span id="cb285-7"><a href="#cb285-7" aria-hidden="true" tabindex="-1"></a>    .reset_index()</span>
<span id="cb285-8"><a href="#cb285-8" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb285-9"><a href="#cb285-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb285-10"><a href="#cb285-10" aria-hidden="true" tabindex="-1"></a><span class="co"># отдельно посчитаем для volkswagen</span></span>
<span id="cb285-11"><a href="#cb285-11" aria-hidden="true" tabindex="-1"></a><span class="co"># укажем, что продажи должны быть до июня</span></span>
<span id="cb285-12"><a href="#cb285-12" aria-hidden="true" tabindex="-1"></a>df_model_revenue_vw <span class="op">=</span> (</span>
<span id="cb285-13"><a href="#cb285-13" aria-hidden="true" tabindex="-1"></a>    df[(df[<span class="st">&#39;авто&#39;</span>].isin(mercur_model_revenue[<span class="st">&#39;авто&#39;</span>])) <span class="op">&amp;</span></span>
<span id="cb285-14"><a href="#cb285-14" aria-hidden="true" tabindex="-1"></a>     (df[<span class="st">&#39;бренд&#39;</span>] <span class="op">==</span> <span class="st">&#39;volkswagen&#39;</span>) <span class="op">&amp;</span> (df[<span class="st">&#39;дата&#39;</span>] <span class="op">&lt;</span> <span class="st">&#39;2019-06-01&#39;</span>)]</span>
<span id="cb285-15"><a href="#cb285-15" aria-hidden="true" tabindex="-1"></a>    .groupby(<span class="st">&#39;авто&#39;</span>)[<span class="st">&#39;продажа_usd&#39;</span>]</span>
<span id="cb285-16"><a href="#cb285-16" aria-hidden="true" tabindex="-1"></a>    .agg({<span class="st">&#39;sum&#39;</span>})</span>
<span id="cb285-17"><a href="#cb285-17" aria-hidden="true" tabindex="-1"></a>    .reset_index()</span>
<span id="cb285-18"><a href="#cb285-18" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb285-19"><a href="#cb285-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb285-20"><a href="#cb285-20" aria-hidden="true" tabindex="-1"></a><span class="co"># объединим таблицы</span></span>
<span id="cb285-21"><a href="#cb285-21" aria-hidden="true" tabindex="-1"></a>df_model_revenue <span class="op">=</span> pd.concat([df_model_revenue, df_model_revenue_vw], axis<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb285-22"><a href="#cb285-22" aria-hidden="true" tabindex="-1"></a>df_model_revenue</span></code></pre></div>
<div class="output execute_result" data-execution_count="692">

  <div id="df-483bdbf0-bd77-4cb0-8650-d0d8d786e940" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>авто</th>
      <th>sum</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>audi a3</td>
      <td>60361.99</td>
    </tr>
    <tr>
      <th>1</th>
      <td>audi a4</td>
      <td>95858.00</td>
    </tr>
    <tr>
      <th>2</th>
      <td>audi a6</td>
      <td>607692.51</td>
    </tr>
    <tr>
      <th>3</th>
      <td>audi a8</td>
      <td>557799.21</td>
    </tr>
    <tr>
      <th>4</th>
      <td>audi q5</td>
      <td>433237.39</td>
    </tr>
    <tr>
      <th>5</th>
      <td>audi q7</td>
      <td>233073.00</td>
    </tr>
    <tr>
      <th>6</th>
      <td>audi q8</td>
      <td>1793118.33</td>
    </tr>
    <tr>
      <th>7</th>
      <td>porsche cayenne</td>
      <td>2856255.46</td>
    </tr>
    <tr>
      <th>8</th>
      <td>porsche macan</td>
      <td>1015619.57</td>
    </tr>
    <tr>
      <th>9</th>
      <td>porsche panamera</td>
      <td>1079061.59</td>
    </tr>
    <tr>
      <th>0</th>
      <td>volkswagen multivan</td>
      <td>287304.72</td>
    </tr>
    <tr>
      <th>1</th>
      <td>volkswagen polo</td>
      <td>8111494.44</td>
    </tr>
    <tr>
      <th>2</th>
      <td>volkswagen teramont</td>
      <td>319321.48</td>
    </tr>
    <tr>
      <th>3</th>
      <td>volkswagen tiguan</td>
      <td>3865205.74</td>
    </tr>
    <tr>
      <th>4</th>
      <td>volkswagen transporter</td>
      <td>109343.55</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-483bdbf0-bd77-4cb0-8650-d0d8d786e940')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-483bdbf0-bd77-4cb0-8650-d0d8d786e940 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-483bdbf0-bd77-4cb0-8650-d0d8d786e940');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-6e736ec2-56f3-4f1b-9d77-02b0285ee04d">
  <button class="colab-df-quickchart" onclick="quickchart('df-6e736ec2-56f3-4f1b-9d77-02b0285ee04d')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-6e736ec2-56f3-4f1b-9d77-02b0285ee04d button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>
    </div>
  </div>

</div>
</div>
<div class="cell code" data-execution_count="693" id="wtjF82-Jw7Op">
<div class="sourceCode" id="cb286"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb286-1"><a href="#cb286-1" aria-hidden="true" tabindex="-1"></a><span class="co"># объединим таблицы в одну</span></span>
<span id="cb286-2"><a href="#cb286-2" aria-hidden="true" tabindex="-1"></a>bcg <span class="op">=</span> (</span>
<span id="cb286-3"><a href="#cb286-3" aria-hidden="true" tabindex="-1"></a>    mercur_model_revenue.merge(df_model_revenue, on<span class="op">=</span><span class="st">&#39;авто&#39;</span>)</span>
<span id="cb286-4"><a href="#cb286-4" aria-hidden="true" tabindex="-1"></a>    .merge(model_avg_growth, on<span class="op">=</span><span class="st">&#39;авто&#39;</span>)</span>
<span id="cb286-5"><a href="#cb286-5" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="694"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:519}"
id="Em5jTWBoxHJ2" data-outputId="8c46c522-ad26-4a73-f7d8-f3e241451e6e">
<div class="sourceCode" id="cb287"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb287-1"><a href="#cb287-1" aria-hidden="true" tabindex="-1"></a><span class="co"># найдем долю рынка</span></span>
<span id="cb287-2"><a href="#cb287-2" aria-hidden="true" tabindex="-1"></a><span class="co"># поделим продажи Меркур Авто на продажи по рынку и переведем в проценты</span></span>
<span id="cb287-3"><a href="#cb287-3" aria-hidden="true" tabindex="-1"></a>bcg[<span class="st">&#39;market_share&#39;</span>] <span class="op">=</span> bcg[<span class="st">&#39;продажа_usd&#39;</span>] <span class="op">/</span> bcg[<span class="st">&#39;sum&#39;</span>] <span class="op">*</span> <span class="dv">100</span></span>
<span id="cb287-4"><a href="#cb287-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb287-5"><a href="#cb287-5" aria-hidden="true" tabindex="-1"></a><span class="co"># выведем бренды для использования на графике</span></span>
<span id="cb287-6"><a href="#cb287-6" aria-hidden="true" tabindex="-1"></a>bcg[<span class="st">&#39;бренд&#39;</span>] <span class="op">=</span> bcg[<span class="st">&#39;авто&#39;</span>].<span class="bu">str</span>.split().<span class="bu">str</span>[<span class="dv">1</span>]</span>
<span id="cb287-7"><a href="#cb287-7" aria-hidden="true" tabindex="-1"></a>bcg</span></code></pre></div>
<div class="output execute_result" data-execution_count="694">

  <div id="df-c89db8ab-b3d0-46fc-bb19-4e9e59e841bb" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>авто</th>
      <th>продажа_usd</th>
      <th>sum</th>
      <th>ratio</th>
      <th>market_share</th>
      <th>бренд</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>audi a3</td>
      <td>60361.99</td>
      <td>60361.99</td>
      <td>114.70</td>
      <td>100.00</td>
      <td>a3</td>
    </tr>
    <tr>
      <th>1</th>
      <td>audi a4</td>
      <td>95858.00</td>
      <td>95858.00</td>
      <td>199.56</td>
      <td>100.00</td>
      <td>a4</td>
    </tr>
    <tr>
      <th>2</th>
      <td>audi a6</td>
      <td>607692.51</td>
      <td>607692.51</td>
      <td>413.20</td>
      <td>100.00</td>
      <td>a6</td>
    </tr>
    <tr>
      <th>3</th>
      <td>audi a8</td>
      <td>557799.21</td>
      <td>557799.21</td>
      <td>189.02</td>
      <td>100.00</td>
      <td>a8</td>
    </tr>
    <tr>
      <th>4</th>
      <td>audi q5</td>
      <td>433237.39</td>
      <td>433237.39</td>
      <td>122.76</td>
      <td>100.00</td>
      <td>q5</td>
    </tr>
    <tr>
      <th>5</th>
      <td>audi q7</td>
      <td>233073.00</td>
      <td>233073.00</td>
      <td>162.62</td>
      <td>100.00</td>
      <td>q7</td>
    </tr>
    <tr>
      <th>6</th>
      <td>audi q8</td>
      <td>1793118.33</td>
      <td>1793118.33</td>
      <td>63.06</td>
      <td>100.00</td>
      <td>q8</td>
    </tr>
    <tr>
      <th>7</th>
      <td>porsche cayenne</td>
      <td>2856255.46</td>
      <td>2856255.46</td>
      <td>375.29</td>
      <td>100.00</td>
      <td>cayenne</td>
    </tr>
    <tr>
      <th>8</th>
      <td>porsche macan</td>
      <td>1015619.57</td>
      <td>1015619.57</td>
      <td>148.84</td>
      <td>100.00</td>
      <td>macan</td>
    </tr>
    <tr>
      <th>9</th>
      <td>porsche panamera</td>
      <td>1079061.59</td>
      <td>1079061.59</td>
      <td>82.68</td>
      <td>100.00</td>
      <td>panamera</td>
    </tr>
    <tr>
      <th>10</th>
      <td>volkswagen multivan</td>
      <td>211161.32</td>
      <td>287304.72</td>
      <td>99.97</td>
      <td>73.50</td>
      <td>multivan</td>
    </tr>
    <tr>
      <th>11</th>
      <td>volkswagen polo</td>
      <td>6418764.24</td>
      <td>8111494.44</td>
      <td>86.86</td>
      <td>79.13</td>
      <td>polo</td>
    </tr>
    <tr>
      <th>12</th>
      <td>volkswagen teramont</td>
      <td>216315.33</td>
      <td>319321.48</td>
      <td>93.79</td>
      <td>67.74</td>
      <td>teramont</td>
    </tr>
    <tr>
      <th>13</th>
      <td>volkswagen tiguan</td>
      <td>2642563.72</td>
      <td>3865205.74</td>
      <td>162.87</td>
      <td>68.37</td>
      <td>tiguan</td>
    </tr>
    <tr>
      <th>14</th>
      <td>volkswagen transporter</td>
      <td>73029.08</td>
      <td>109343.55</td>
      <td>99.97</td>
      <td>66.79</td>
      <td>transporter</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-c89db8ab-b3d0-46fc-bb19-4e9e59e841bb')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-c89db8ab-b3d0-46fc-bb19-4e9e59e841bb button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-c89db8ab-b3d0-46fc-bb19-4e9e59e841bb');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-a4517100-cf70-422c-9838-6f0c836bec34">
  <button class="colab-df-quickchart" onclick="quickchart('df-a4517100-cf70-422c-9838-6f0c836bec34')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-a4517100-cf70-422c-9838-6f0c836bec34 button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>
    </div>
  </div>

</div>
</div>
<div class="cell markdown" id="rbEUv3TW6-Nz">
<p>При BCG анализе существует 4 категории, к которым можно отнести
товар:</p>
<ul>
<li>«Трудные дети» — продукты или направления бизнеса, которые только
вышли на рынок. Быстро растут, но еще не приносят ощутимой прибыли.</li>
<li>«Звезды» — популярные продукты, которые пользуются спросом и
приносят компании прибыль.</li>
<li>«Дойные коровы» занимают большую долю рынка, чем аналогичные
продукты конкурентов, но стагнируют или начинают терять спрос. Они
приносят стабильно высокий доход.</li>
<li>«Собаки» — невыгодные для развития товары и направления. Плохо
продаются из-за низкого спроса на них и приносят мало прибыли.</li>
</ul>
<p>Создадим категории товаров. Для этого нужно определить границы доли
рынка и темпа роста. Так как мы сравнивали Меркур Авто со всем рынком,
то доля рынка может варьироваться от 0 до 1, следовательно граница равна
0.5. Темп роста возьмем средний относительно минимума и максимума.</p>
</div>
<div class="cell code" data-execution_count="695" id="x6Uuht_HE0BX">
<div class="sourceCode" id="cb288"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb288-1"><a href="#cb288-1" aria-hidden="true" tabindex="-1"></a><span class="co"># граница доли рынка</span></span>
<span id="cb288-2"><a href="#cb288-2" aria-hidden="true" tabindex="-1"></a>market_border <span class="op">=</span> bcg[<span class="st">&#39;market_share&#39;</span>].<span class="bu">max</span>() <span class="op">/</span> <span class="dv">2</span></span>
<span id="cb288-3"><a href="#cb288-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb288-4"><a href="#cb288-4" aria-hidden="true" tabindex="-1"></a><span class="co"># граница темпа роста</span></span>
<span id="cb288-5"><a href="#cb288-5" aria-hidden="true" tabindex="-1"></a>ratio_border <span class="op">=</span> bcg[<span class="st">&#39;ratio&#39;</span>].<span class="bu">max</span>() <span class="op">/</span>  <span class="dv">2</span></span></code></pre></div>
</div>
<div class="cell code" data-execution_count="696" id="h-tkcXHnyj01">
<div class="sourceCode" id="cb289"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb289-1"><a href="#cb289-1" aria-hidden="true" tabindex="-1"></a><span class="co"># создадим условия</span></span>
<span id="cb289-2"><a href="#cb289-2" aria-hidden="true" tabindex="-1"></a>conditions <span class="op">=</span> [</span>
<span id="cb289-3"><a href="#cb289-3" aria-hidden="true" tabindex="-1"></a>    ((bcg[<span class="st">&#39;ratio&#39;</span>] <span class="op">&lt;</span> ratio_border) <span class="op">&amp;</span> (bcg[<span class="st">&#39;market_share&#39;</span>] <span class="op">&lt;</span> market_border)),</span>
<span id="cb289-4"><a href="#cb289-4" aria-hidden="true" tabindex="-1"></a>    ((bcg[<span class="st">&#39;ratio&#39;</span>] <span class="op">&lt;</span> ratio_border) <span class="op">&amp;</span> (bcg[<span class="st">&#39;market_share&#39;</span>] <span class="op">&gt;</span> market_border)),</span>
<span id="cb289-5"><a href="#cb289-5" aria-hidden="true" tabindex="-1"></a>    ((bcg[<span class="st">&#39;ratio&#39;</span>] <span class="op">&gt;</span> ratio_border) <span class="op">&amp;</span> (bcg[<span class="st">&#39;market_share&#39;</span>] <span class="op">&lt;</span> market_border)),</span>
<span id="cb289-6"><a href="#cb289-6" aria-hidden="true" tabindex="-1"></a>    ((bcg[<span class="st">&#39;ratio&#39;</span>] <span class="op">&gt;</span> ratio_border) <span class="op">&amp;</span> (bcg[<span class="st">&#39;market_share&#39;</span>] <span class="op">&gt;</span> market_border))</span>
<span id="cb289-7"><a href="#cb289-7" aria-hidden="true" tabindex="-1"></a>]</span>
<span id="cb289-8"><a href="#cb289-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb289-9"><a href="#cb289-9" aria-hidden="true" tabindex="-1"></a><span class="co"># создадим список категорий</span></span>
<span id="cb289-10"><a href="#cb289-10" aria-hidden="true" tabindex="-1"></a>choice_list <span class="op">=</span> [<span class="st">&#39;Собаки&#39;</span>, <span class="st">&#39;Дойные коровы&#39;</span>, <span class="st">&#39;Трудные дети&#39;</span>, <span class="st">&#39;Звезды&#39;</span>]</span>
<span id="cb289-11"><a href="#cb289-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb289-12"><a href="#cb289-12" aria-hidden="true" tabindex="-1"></a><span class="co"># заполним категории</span></span>
<span id="cb289-13"><a href="#cb289-13" aria-hidden="true" tabindex="-1"></a>bcg[<span class="st">&#39;category&#39;</span>] <span class="op">=</span> np.select(conditions, choice_list)</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="697"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:519}"
id="QXVnlwL1R1rI" data-outputId="5e88a9e5-41df-47ab-d5a2-09e9d432b04d">
<div class="sourceCode" id="cb290"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb290-1"><a href="#cb290-1" aria-hidden="true" tabindex="-1"></a><span class="co"># для корректности отображения отдельно запишем названия моделей</span></span>
<span id="cb290-2"><a href="#cb290-2" aria-hidden="true" tabindex="-1"></a>bcg</span></code></pre></div>
<div class="output execute_result" data-execution_count="697">

  <div id="df-27afd21c-b1c1-47b9-8f92-767ba30b9467" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>авто</th>
      <th>продажа_usd</th>
      <th>sum</th>
      <th>ratio</th>
      <th>market_share</th>
      <th>бренд</th>
      <th>category</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>audi a3</td>
      <td>60361.99</td>
      <td>60361.99</td>
      <td>114.70</td>
      <td>100.00</td>
      <td>a3</td>
      <td>Дойные коровы</td>
    </tr>
    <tr>
      <th>1</th>
      <td>audi a4</td>
      <td>95858.00</td>
      <td>95858.00</td>
      <td>199.56</td>
      <td>100.00</td>
      <td>a4</td>
      <td>Дойные коровы</td>
    </tr>
    <tr>
      <th>2</th>
      <td>audi a6</td>
      <td>607692.51</td>
      <td>607692.51</td>
      <td>413.20</td>
      <td>100.00</td>
      <td>a6</td>
      <td>Звезды</td>
    </tr>
    <tr>
      <th>3</th>
      <td>audi a8</td>
      <td>557799.21</td>
      <td>557799.21</td>
      <td>189.02</td>
      <td>100.00</td>
      <td>a8</td>
      <td>Дойные коровы</td>
    </tr>
    <tr>
      <th>4</th>
      <td>audi q5</td>
      <td>433237.39</td>
      <td>433237.39</td>
      <td>122.76</td>
      <td>100.00</td>
      <td>q5</td>
      <td>Дойные коровы</td>
    </tr>
    <tr>
      <th>5</th>
      <td>audi q7</td>
      <td>233073.00</td>
      <td>233073.00</td>
      <td>162.62</td>
      <td>100.00</td>
      <td>q7</td>
      <td>Дойные коровы</td>
    </tr>
    <tr>
      <th>6</th>
      <td>audi q8</td>
      <td>1793118.33</td>
      <td>1793118.33</td>
      <td>63.06</td>
      <td>100.00</td>
      <td>q8</td>
      <td>Дойные коровы</td>
    </tr>
    <tr>
      <th>7</th>
      <td>porsche cayenne</td>
      <td>2856255.46</td>
      <td>2856255.46</td>
      <td>375.29</td>
      <td>100.00</td>
      <td>cayenne</td>
      <td>Звезды</td>
    </tr>
    <tr>
      <th>8</th>
      <td>porsche macan</td>
      <td>1015619.57</td>
      <td>1015619.57</td>
      <td>148.84</td>
      <td>100.00</td>
      <td>macan</td>
      <td>Дойные коровы</td>
    </tr>
    <tr>
      <th>9</th>
      <td>porsche panamera</td>
      <td>1079061.59</td>
      <td>1079061.59</td>
      <td>82.68</td>
      <td>100.00</td>
      <td>panamera</td>
      <td>Дойные коровы</td>
    </tr>
    <tr>
      <th>10</th>
      <td>volkswagen multivan</td>
      <td>211161.32</td>
      <td>287304.72</td>
      <td>99.97</td>
      <td>73.50</td>
      <td>multivan</td>
      <td>Дойные коровы</td>
    </tr>
    <tr>
      <th>11</th>
      <td>volkswagen polo</td>
      <td>6418764.24</td>
      <td>8111494.44</td>
      <td>86.86</td>
      <td>79.13</td>
      <td>polo</td>
      <td>Дойные коровы</td>
    </tr>
    <tr>
      <th>12</th>
      <td>volkswagen teramont</td>
      <td>216315.33</td>
      <td>319321.48</td>
      <td>93.79</td>
      <td>67.74</td>
      <td>teramont</td>
      <td>Дойные коровы</td>
    </tr>
    <tr>
      <th>13</th>
      <td>volkswagen tiguan</td>
      <td>2642563.72</td>
      <td>3865205.74</td>
      <td>162.87</td>
      <td>68.37</td>
      <td>tiguan</td>
      <td>Дойные коровы</td>
    </tr>
    <tr>
      <th>14</th>
      <td>volkswagen transporter</td>
      <td>73029.08</td>
      <td>109343.55</td>
      <td>99.97</td>
      <td>66.79</td>
      <td>transporter</td>
      <td>Дойные коровы</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-27afd21c-b1c1-47b9-8f92-767ba30b9467')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-27afd21c-b1c1-47b9-8f92-767ba30b9467 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-27afd21c-b1c1-47b9-8f92-767ba30b9467');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-93d7c38a-7814-4349-8893-83d8aa20423b">
  <button class="colab-df-quickchart" onclick="quickchart('df-93d7c38a-7814-4349-8893-83d8aa20423b')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-93d7c38a-7814-4349-8893-83d8aa20423b button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>
    </div>
  </div>

</div>
</div>
<div class="cell code" data-execution_count="698"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:607}"
id="2gUhjcPy1t3D" data-outputId="82456321-36e2-4110-8f25-1181d340ea41">
<div class="sourceCode" id="cb291"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb291-1"><a href="#cb291-1" aria-hidden="true" tabindex="-1"></a><span class="co"># построим график</span></span>
<span id="cb291-2"><a href="#cb291-2" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">15</span>, <span class="dv">6</span>))</span>
<span id="cb291-3"><a href="#cb291-3" aria-hidden="true" tabindex="-1"></a>sns.scatterplot(bcg, y<span class="op">=</span><span class="st">&#39;ratio&#39;</span>,</span>
<span id="cb291-4"><a href="#cb291-4" aria-hidden="true" tabindex="-1"></a>                x<span class="op">=</span><span class="st">&#39;market_share&#39;</span>,</span>
<span id="cb291-5"><a href="#cb291-5" aria-hidden="true" tabindex="-1"></a>                hue<span class="op">=</span><span class="st">&#39;category&#39;</span>,</span>
<span id="cb291-6"><a href="#cb291-6" aria-hidden="true" tabindex="-1"></a>                size<span class="op">=</span><span class="st">&#39;продажа_usd&#39;</span>,</span>
<span id="cb291-7"><a href="#cb291-7" aria-hidden="true" tabindex="-1"></a>                sizes<span class="op">=</span>(<span class="dv">1000</span>, <span class="dv">10000</span>),</span>
<span id="cb291-8"><a href="#cb291-8" aria-hidden="true" tabindex="-1"></a>                legend<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb291-9"><a href="#cb291-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb291-10"><a href="#cb291-10" aria-hidden="true" tabindex="-1"></a><span class="co"># добавим границы категорий</span></span>
<span id="cb291-11"><a href="#cb291-11" aria-hidden="true" tabindex="-1"></a>plt.axhline(ratio_border, color<span class="op">=</span><span class="st">&#39;red&#39;</span>, ls<span class="op">=</span><span class="st">&#39;--&#39;</span>)</span>
<span id="cb291-12"><a href="#cb291-12" aria-hidden="true" tabindex="-1"></a>plt.axvline(market_border, color<span class="op">=</span><span class="st">&#39;red&#39;</span>, ls<span class="op">=</span><span class="st">&#39;--&#39;</span>)</span>
<span id="cb291-13"><a href="#cb291-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb291-14"><a href="#cb291-14" aria-hidden="true" tabindex="-1"></a><span class="co"># добавим названия моделей</span></span>
<span id="cb291-15"><a href="#cb291-15" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> x, y, tex <span class="kw">in</span> <span class="bu">zip</span>(bcg[<span class="st">&#39;market_share&#39;</span>], bcg[<span class="st">&#39;ratio&#39;</span>], bcg[<span class="st">&#39;бренд&#39;</span>]):</span>
<span id="cb291-16"><a href="#cb291-16" aria-hidden="true" tabindex="-1"></a>    t <span class="op">=</span> plt.text(x, y, tex,</span>
<span id="cb291-17"><a href="#cb291-17" aria-hidden="true" tabindex="-1"></a>                 horizontalalignment<span class="op">=</span><span class="st">&#39;center&#39;</span>,</span>
<span id="cb291-18"><a href="#cb291-18" aria-hidden="true" tabindex="-1"></a>                 verticalalignment<span class="op">=</span><span class="st">&#39;bottom&#39;</span>,</span>
<span id="cb291-19"><a href="#cb291-19" aria-hidden="true" tabindex="-1"></a>                 fontdict<span class="op">=</span>{<span class="st">&#39;color&#39;</span>:<span class="st">&#39;black&#39;</span>, <span class="st">&#39;weight&#39;</span>:<span class="st">&#39;bold&#39;</span>})</span>
<span id="cb291-20"><a href="#cb291-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb291-21"><a href="#cb291-21" aria-hidden="true" tabindex="-1"></a><span class="co"># добавим названия категорий</span></span>
<span id="cb291-22"><a href="#cb291-22" aria-hidden="true" tabindex="-1"></a>plt.text(<span class="dv">0</span>, <span class="dv">190</span>, <span class="st">&#39;Собаки&#39;</span>, fontdict<span class="op">=</span>{<span class="st">&#39;color&#39;</span>:<span class="st">&#39;black&#39;</span>, <span class="st">&#39;weight&#39;</span>:<span class="st">&#39;bold&#39;</span>})</span>
<span id="cb291-23"><a href="#cb291-23" aria-hidden="true" tabindex="-1"></a>plt.text(<span class="dv">0</span>, <span class="dv">420</span>, <span class="st">&#39;Трудные дети&#39;</span>, fontdict<span class="op">=</span>{<span class="st">&#39;color&#39;</span>:<span class="st">&#39;black&#39;</span>, <span class="st">&#39;weight&#39;</span>:<span class="st">&#39;bold&#39;</span>})</span>
<span id="cb291-24"><a href="#cb291-24" aria-hidden="true" tabindex="-1"></a>plt.text(<span class="dv">52</span>, <span class="dv">420</span>, <span class="st">&#39;Звезды&#39;</span>, fontdict<span class="op">=</span>{<span class="st">&#39;color&#39;</span>:<span class="st">&#39;black&#39;</span>, <span class="st">&#39;weight&#39;</span>:<span class="st">&#39;bold&#39;</span>})</span>
<span id="cb291-25"><a href="#cb291-25" aria-hidden="true" tabindex="-1"></a>plt.text(<span class="dv">52</span>, <span class="dv">190</span>, <span class="st">&#39;Дойные коровы&#39;</span>, fontdict<span class="op">=</span>{<span class="st">&#39;color&#39;</span>:<span class="st">&#39;black&#39;</span>, <span class="st">&#39;weight&#39;</span>:<span class="st">&#39;bold&#39;</span>})</span>
<span id="cb291-26"><a href="#cb291-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb291-27"><a href="#cb291-27" aria-hidden="true" tabindex="-1"></a><span class="co"># добавим границы осей</span></span>
<span id="cb291-28"><a href="#cb291-28" aria-hidden="true" tabindex="-1"></a>plt.xlim(<span class="dv">0</span>, bcg[<span class="st">&#39;market_share&#39;</span>].<span class="bu">max</span>() <span class="op">*</span> <span class="fl">1.1</span>)</span>
<span id="cb291-29"><a href="#cb291-29" aria-hidden="true" tabindex="-1"></a>plt.ylim(<span class="dv">0</span>, bcg[<span class="st">&#39;ratio&#39;</span>].<span class="bu">max</span>() <span class="op">*</span> <span class="fl">1.1</span>)</span>
<span id="cb291-30"><a href="#cb291-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb291-31"><a href="#cb291-31" aria-hidden="true" tabindex="-1"></a><span class="co"># укажем название осей</span></span>
<span id="cb291-32"><a href="#cb291-32" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">&#39;Доля рынка&#39;</span>)</span>
<span id="cb291-33"><a href="#cb291-33" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">&#39;Темп роста&#39;</span>)</span>
<span id="cb291-34"><a href="#cb291-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb291-35"><a href="#cb291-35" aria-hidden="true" tabindex="-1"></a><span class="co"># укажем название</span></span>
<span id="cb291-36"><a href="#cb291-36" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">&#39;BCG анализ моделей Меркур Авто&#39;</span>)</span>
<span id="cb291-37"><a href="#cb291-37" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()<span class="op">;</span></span></code></pre></div>
<div class="output display_data">
<p><img
src="vertopal_9b40e0aaef914c45a9852524805a792d/b033930034ca3346242895768ac29d0c875e4953.png" /></p>
</div>
</div>
<div class="cell markdown" id="PRUCIBOGXvUT">
<p>Почти все модели кроме Audi A6 и Porsche Cayenne (Звезды) относятся к
Дойным коровам. Следовательно Меркур Авто продает ликвидные автомобили.
Их спокойно можно продавать и дальше. Но стоит присмотреться к новым
авто, так как Дойные коровы могут со временем пойти на спад.</p>
</div>
<section id="418-abc-анализ" class="cell markdown" id="y3ZDGJYV7X_L">
<h2>4.18 ABC анализ</h2>
</section>
<div class="cell markdown" id="MXv7_fgg7ZvI">
<p>Проведем двумерный ABC анализ моделей в Меркур Авто по выручке и
количеству проданных авто.</p>
</div>
<div class="cell code" data-execution_count="699"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:802}"
id="3JnQPZea7sat" data-outputId="30e8f7df-be70-4ef1-90db-20aa0179ede6">
<div class="sourceCode" id="cb292"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb292-1"><a href="#cb292-1" aria-hidden="true" tabindex="-1"></a><span class="co"># посчитаем выручку и количество проданных моделей</span></span>
<span id="cb292-2"><a href="#cb292-2" aria-hidden="true" tabindex="-1"></a>mercur_abc <span class="op">=</span> mercur.groupby(<span class="st">&#39;авто&#39;</span>).agg({<span class="st">&#39;продажа_usd&#39;</span>: <span class="st">&#39;sum&#39;</span>,</span>
<span id="cb292-3"><a href="#cb292-3" aria-hidden="true" tabindex="-1"></a>                                         <span class="st">&#39;количество&#39;</span>: <span class="st">&#39;sum&#39;</span>})</span>
<span id="cb292-4"><a href="#cb292-4" aria-hidden="true" tabindex="-1"></a>mercur_abc</span></code></pre></div>
<div class="output execute_result" data-execution_count="699">

  <div id="df-b176214a-db8d-40de-b474-29a245145fe8" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>продажа_usd</th>
      <th>количество</th>
    </tr>
    <tr>
      <th>авто</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>audi a3</th>
      <td>60361.99</td>
      <td>2</td>
    </tr>
    <tr>
      <th>audi a4</th>
      <td>95858.00</td>
      <td>3</td>
    </tr>
    <tr>
      <th>audi a6</th>
      <td>607692.51</td>
      <td>8</td>
    </tr>
    <tr>
      <th>audi a7</th>
      <td>171100.00</td>
      <td>2</td>
    </tr>
    <tr>
      <th>audi a8</th>
      <td>557799.21</td>
      <td>5</td>
    </tr>
    <tr>
      <th>audi q5</th>
      <td>433237.39</td>
      <td>8</td>
    </tr>
    <tr>
      <th>audi q7</th>
      <td>233073.00</td>
      <td>3</td>
    </tr>
    <tr>
      <th>audi q8</th>
      <td>1793118.33</td>
      <td>20</td>
    </tr>
    <tr>
      <th>audi rs5</th>
      <td>107250.00</td>
      <td>1</td>
    </tr>
    <tr>
      <th>porsche 911 carrera s</th>
      <td>162576.08</td>
      <td>1</td>
    </tr>
    <tr>
      <th>porsche cayenne</th>
      <td>2856255.46</td>
      <td>28</td>
    </tr>
    <tr>
      <th>porsche macan</th>
      <td>1015619.57</td>
      <td>15</td>
    </tr>
    <tr>
      <th>porsche panamera</th>
      <td>1079061.59</td>
      <td>8</td>
    </tr>
    <tr>
      <th>volkswagen amarok</th>
      <td>73041.55</td>
      <td>2</td>
    </tr>
    <tr>
      <th>volkswagen jetta</th>
      <td>53434.20</td>
      <td>3</td>
    </tr>
    <tr>
      <th>volkswagen multivan</th>
      <td>211161.32</td>
      <td>3</td>
    </tr>
    <tr>
      <th>volkswagen polo</th>
      <td>6418764.24</td>
      <td>440</td>
    </tr>
    <tr>
      <th>volkswagen teramont</th>
      <td>216315.33</td>
      <td>4</td>
    </tr>
    <tr>
      <th>volkswagen tiguan</th>
      <td>2642563.72</td>
      <td>81</td>
    </tr>
    <tr>
      <th>volkswagen touareg</th>
      <td>242552.31</td>
      <td>3</td>
    </tr>
    <tr>
      <th>volkswagen transporter</th>
      <td>73029.08</td>
      <td>2</td>
    </tr>
    <tr>
      <th>volkswagen transporter kasten</th>
      <td>214890.34</td>
      <td>7</td>
    </tr>
    <tr>
      <th>volkswagen transporter kombi</th>
      <td>36520.77</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-b176214a-db8d-40de-b474-29a245145fe8')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-b176214a-db8d-40de-b474-29a245145fe8 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-b176214a-db8d-40de-b474-29a245145fe8');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-aab2c6f6-f93e-418a-82a0-ac9c51eeb41a">
  <button class="colab-df-quickchart" onclick="quickchart('df-aab2c6f6-f93e-418a-82a0-ac9c51eeb41a')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-aab2c6f6-f93e-418a-82a0-ac9c51eeb41a button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>
    </div>
  </div>

</div>
</div>
<div class="cell markdown" id="WBPwrtxYJnWD">
<p>Для каждой модели посчитаем отношение выручки и количества к общим
значениям по дилеру. Далее найдем накопительную сумму процентов. К
группе A отнесем проценты, формирующие суммарно 80%, к группе B - до
95%, остальное к группе C.</p>
</div>
<div class="cell code" data-execution_count="700"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:802}"
id="DInuaY8H7xLS" data-outputId="94861023-accb-46ca-94d2-a1811837ad92">
<div class="sourceCode" id="cb293"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb293-1"><a href="#cb293-1" aria-hidden="true" tabindex="-1"></a><span class="co"># пройдемся по колонкам датафрейма</span></span>
<span id="cb293-2"><a href="#cb293-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> col <span class="kw">in</span> mercur_abc.columns:</span>
<span id="cb293-3"><a href="#cb293-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb293-4"><a href="#cb293-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># посчитаем отношение каждого значения к сумме по колонке</span></span>
<span id="cb293-5"><a href="#cb293-5" aria-hidden="true" tabindex="-1"></a>  mercur_abc[<span class="ss">f&#39;rel_</span><span class="sc">{</span>col<span class="sc">}</span><span class="ss">&#39;</span>] <span class="op">=</span> mercur_abc[col] <span class="op">/</span> <span class="bu">sum</span>(mercur_abc[col])</span>
<span id="cb293-6"><a href="#cb293-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb293-7"><a href="#cb293-7" aria-hidden="true" tabindex="-1"></a>  <span class="co"># отсортируем значения по убыванию</span></span>
<span id="cb293-8"><a href="#cb293-8" aria-hidden="true" tabindex="-1"></a>  mercur_abc <span class="op">=</span> mercur_abc.sort_values(by<span class="op">=</span><span class="ss">f&#39;rel_</span><span class="sc">{</span>col<span class="sc">}</span><span class="ss">&#39;</span>, ascending<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb293-9"><a href="#cb293-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb293-10"><a href="#cb293-10" aria-hidden="true" tabindex="-1"></a>  <span class="co"># рассчитаем сумму процентов с накоплением</span></span>
<span id="cb293-11"><a href="#cb293-11" aria-hidden="true" tabindex="-1"></a>  mercur_abc[<span class="ss">f&#39;cum_</span><span class="sc">{</span>col<span class="sc">}</span><span class="ss">&#39;</span>] <span class="op">=</span> mercur_abc[<span class="ss">f&#39;rel_</span><span class="sc">{</span>col<span class="sc">}</span><span class="ss">&#39;</span>].cumsum()</span>
<span id="cb293-12"><a href="#cb293-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb293-13"><a href="#cb293-13" aria-hidden="true" tabindex="-1"></a>  <span class="co"># присвоим категории ABC в зависимости от значения накопительной суммы</span></span>
<span id="cb293-14"><a href="#cb293-14" aria-hidden="true" tabindex="-1"></a>  mercur_abc[<span class="ss">f&#39;</span><span class="sc">{</span>col<span class="sc">}</span><span class="ss">_abc&#39;</span>] <span class="op">=</span> np.where(mercur_abc[<span class="ss">f&#39;cum_</span><span class="sc">{</span>col<span class="sc">}</span><span class="ss">&#39;</span>] <span class="op">&lt;</span> <span class="fl">0.8</span>,</span>
<span id="cb293-15"><a href="#cb293-15" aria-hidden="true" tabindex="-1"></a>                                      <span class="st">&#39;A&#39;</span>,</span>
<span id="cb293-16"><a href="#cb293-16" aria-hidden="true" tabindex="-1"></a>                                      np.where(mercur_abc[<span class="ss">f&#39;cum_</span><span class="sc">{</span>col<span class="sc">}</span><span class="ss">&#39;</span>] <span class="op">&lt;</span> <span class="fl">0.95</span>,</span>
<span id="cb293-17"><a href="#cb293-17" aria-hidden="true" tabindex="-1"></a>                                               <span class="st">&#39;B&#39;</span>,</span>
<span id="cb293-18"><a href="#cb293-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb293-19"><a href="#cb293-19" aria-hidden="true" tabindex="-1"></a>                                               <span class="st">&#39;C&#39;</span>))</span>
<span id="cb293-20"><a href="#cb293-20" aria-hidden="true" tabindex="-1"></a>mercur_abc</span></code></pre></div>
<div class="output execute_result" data-execution_count="700">

  <div id="df-7a7effce-94d0-4981-988d-1903ed2ac7da" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>продажа_usd</th>
      <th>количество</th>
      <th>rel_продажа_usd</th>
      <th>cum_продажа_usd</th>
      <th>продажа_usd_abc</th>
      <th>rel_количество</th>
      <th>cum_количество</th>
      <th>количество_abc</th>
    </tr>
    <tr>
      <th>авто</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>volkswagen polo</th>
      <td>6418764.24</td>
      <td>440</td>
      <td>0.33</td>
      <td>0.33</td>
      <td>A</td>
      <td>0.68</td>
      <td>0.68</td>
      <td>A</td>
    </tr>
    <tr>
      <th>volkswagen tiguan</th>
      <td>2642563.72</td>
      <td>81</td>
      <td>0.14</td>
      <td>0.62</td>
      <td>A</td>
      <td>0.12</td>
      <td>0.80</td>
      <td>B</td>
    </tr>
    <tr>
      <th>porsche cayenne</th>
      <td>2856255.46</td>
      <td>28</td>
      <td>0.15</td>
      <td>0.48</td>
      <td>A</td>
      <td>0.04</td>
      <td>0.84</td>
      <td>B</td>
    </tr>
    <tr>
      <th>audi q8</th>
      <td>1793118.33</td>
      <td>20</td>
      <td>0.09</td>
      <td>0.71</td>
      <td>A</td>
      <td>0.03</td>
      <td>0.88</td>
      <td>B</td>
    </tr>
    <tr>
      <th>porsche macan</th>
      <td>1015619.57</td>
      <td>15</td>
      <td>0.05</td>
      <td>0.82</td>
      <td>B</td>
      <td>0.02</td>
      <td>0.90</td>
      <td>B</td>
    </tr>
    <tr>
      <th>porsche panamera</th>
      <td>1079061.59</td>
      <td>8</td>
      <td>0.06</td>
      <td>0.76</td>
      <td>A</td>
      <td>0.01</td>
      <td>0.91</td>
      <td>B</td>
    </tr>
    <tr>
      <th>audi a6</th>
      <td>607692.51</td>
      <td>8</td>
      <td>0.03</td>
      <td>0.85</td>
      <td>B</td>
      <td>0.01</td>
      <td>0.92</td>
      <td>B</td>
    </tr>
    <tr>
      <th>audi q5</th>
      <td>433237.39</td>
      <td>8</td>
      <td>0.02</td>
      <td>0.90</td>
      <td>B</td>
      <td>0.01</td>
      <td>0.94</td>
      <td>B</td>
    </tr>
    <tr>
      <th>volkswagen transporter kasten</th>
      <td>214890.34</td>
      <td>7</td>
      <td>0.01</td>
      <td>0.95</td>
      <td>B</td>
      <td>0.01</td>
      <td>0.95</td>
      <td>B</td>
    </tr>
    <tr>
      <th>audi a8</th>
      <td>557799.21</td>
      <td>5</td>
      <td>0.03</td>
      <td>0.88</td>
      <td>B</td>
      <td>0.01</td>
      <td>0.95</td>
      <td>C</td>
    </tr>
    <tr>
      <th>volkswagen teramont</th>
      <td>216315.33</td>
      <td>4</td>
      <td>0.01</td>
      <td>0.93</td>
      <td>B</td>
      <td>0.01</td>
      <td>0.96</td>
      <td>C</td>
    </tr>
    <tr>
      <th>audi q7</th>
      <td>233073.00</td>
      <td>3</td>
      <td>0.01</td>
      <td>0.92</td>
      <td>B</td>
      <td>0.00</td>
      <td>0.96</td>
      <td>C</td>
    </tr>
    <tr>
      <th>volkswagen touareg</th>
      <td>242552.31</td>
      <td>3</td>
      <td>0.01</td>
      <td>0.91</td>
      <td>B</td>
      <td>0.00</td>
      <td>0.97</td>
      <td>C</td>
    </tr>
    <tr>
      <th>volkswagen multivan</th>
      <td>211161.32</td>
      <td>3</td>
      <td>0.01</td>
      <td>0.96</td>
      <td>C</td>
      <td>0.00</td>
      <td>0.97</td>
      <td>C</td>
    </tr>
    <tr>
      <th>audi a4</th>
      <td>95858.00</td>
      <td>3</td>
      <td>0.00</td>
      <td>0.98</td>
      <td>C</td>
      <td>0.00</td>
      <td>0.98</td>
      <td>C</td>
    </tr>
    <tr>
      <th>volkswagen jetta</th>
      <td>53434.20</td>
      <td>3</td>
      <td>0.00</td>
      <td>1.00</td>
      <td>C</td>
      <td>0.00</td>
      <td>0.98</td>
      <td>C</td>
    </tr>
    <tr>
      <th>audi a7</th>
      <td>171100.00</td>
      <td>2</td>
      <td>0.01</td>
      <td>0.97</td>
      <td>C</td>
      <td>0.00</td>
      <td>0.99</td>
      <td>C</td>
    </tr>
    <tr>
      <th>volkswagen amarok</th>
      <td>73041.55</td>
      <td>2</td>
      <td>0.00</td>
      <td>0.99</td>
      <td>C</td>
      <td>0.00</td>
      <td>0.99</td>
      <td>C</td>
    </tr>
    <tr>
      <th>volkswagen transporter</th>
      <td>73029.08</td>
      <td>2</td>
      <td>0.00</td>
      <td>0.99</td>
      <td>C</td>
      <td>0.00</td>
      <td>0.99</td>
      <td>C</td>
    </tr>
    <tr>
      <th>audi a3</th>
      <td>60361.99</td>
      <td>2</td>
      <td>0.00</td>
      <td>1.00</td>
      <td>C</td>
      <td>0.00</td>
      <td>1.00</td>
      <td>C</td>
    </tr>
    <tr>
      <th>porsche 911 carrera s</th>
      <td>162576.08</td>
      <td>1</td>
      <td>0.01</td>
      <td>0.97</td>
      <td>C</td>
      <td>0.00</td>
      <td>1.00</td>
      <td>C</td>
    </tr>
    <tr>
      <th>audi rs5</th>
      <td>107250.00</td>
      <td>1</td>
      <td>0.01</td>
      <td>0.98</td>
      <td>C</td>
      <td>0.00</td>
      <td>1.00</td>
      <td>C</td>
    </tr>
    <tr>
      <th>volkswagen transporter kombi</th>
      <td>36520.77</td>
      <td>1</td>
      <td>0.00</td>
      <td>1.00</td>
      <td>C</td>
      <td>0.00</td>
      <td>1.00</td>
      <td>C</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-7a7effce-94d0-4981-988d-1903ed2ac7da')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-7a7effce-94d0-4981-988d-1903ed2ac7da button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-7a7effce-94d0-4981-988d-1903ed2ac7da');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-e4147e41-4f6e-44a1-b57a-50940c7cd620">
  <button class="colab-df-quickchart" onclick="quickchart('df-e4147e41-4f6e-44a1-b57a-50940c7cd620')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-e4147e41-4f6e-44a1-b57a-50940c7cd620 button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>
    </div>
  </div>

</div>
</div>
<div class="cell code" data-execution_count="703"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:802}"
id="LY_W8Fbu9yrw" data-outputId="6e0b1e9d-6c08-4a0b-e597-513623a4cbc3">
<div class="sourceCode" id="cb294"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb294-1"><a href="#cb294-1" aria-hidden="true" tabindex="-1"></a><span class="co"># оставим нужные столбцы</span></span>
<span id="cb294-2"><a href="#cb294-2" aria-hidden="true" tabindex="-1"></a>mercur_abc <span class="op">=</span> mercur_abc[[<span class="st">&#39;продажа_usd&#39;</span>, <span class="st">&#39;количество&#39;</span>,</span>
<span id="cb294-3"><a href="#cb294-3" aria-hidden="true" tabindex="-1"></a>                         <span class="st">&#39;продажа_usd_abc&#39;</span>, <span class="st">&#39;количество_abc&#39;</span>]]</span>
<span id="cb294-4"><a href="#cb294-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb294-5"><a href="#cb294-5" aria-hidden="true" tabindex="-1"></a><span class="co"># определим финальные группы</span></span>
<span id="cb294-6"><a href="#cb294-6" aria-hidden="true" tabindex="-1"></a>mercur_abc[<span class="st">&#39;abc_final&#39;</span>] <span class="op">=</span> mercur_abc[<span class="st">&#39;продажа_usd_abc&#39;</span>] <span class="op">+</span> <span class="op">\</span></span>
<span id="cb294-7"><a href="#cb294-7" aria-hidden="true" tabindex="-1"></a>mercur_abc[<span class="st">&#39;количество_abc&#39;</span>]</span>
<span id="cb294-8"><a href="#cb294-8" aria-hidden="true" tabindex="-1"></a>mercur_abc</span></code></pre></div>
<div class="output execute_result" data-execution_count="703">

  <div id="df-7edbce46-6ab0-4cf3-9073-dc89d690daed" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>продажа_usd</th>
      <th>количество</th>
      <th>продажа_usd_abc</th>
      <th>количество_abc</th>
      <th>abc_final</th>
    </tr>
    <tr>
      <th>авто</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>volkswagen polo</th>
      <td>6418764.24</td>
      <td>440</td>
      <td>A</td>
      <td>A</td>
      <td>AA</td>
    </tr>
    <tr>
      <th>volkswagen tiguan</th>
      <td>2642563.72</td>
      <td>81</td>
      <td>A</td>
      <td>B</td>
      <td>AB</td>
    </tr>
    <tr>
      <th>porsche cayenne</th>
      <td>2856255.46</td>
      <td>28</td>
      <td>A</td>
      <td>B</td>
      <td>AB</td>
    </tr>
    <tr>
      <th>audi q8</th>
      <td>1793118.33</td>
      <td>20</td>
      <td>A</td>
      <td>B</td>
      <td>AB</td>
    </tr>
    <tr>
      <th>porsche macan</th>
      <td>1015619.57</td>
      <td>15</td>
      <td>B</td>
      <td>B</td>
      <td>BB</td>
    </tr>
    <tr>
      <th>porsche panamera</th>
      <td>1079061.59</td>
      <td>8</td>
      <td>A</td>
      <td>B</td>
      <td>AB</td>
    </tr>
    <tr>
      <th>audi a6</th>
      <td>607692.51</td>
      <td>8</td>
      <td>B</td>
      <td>B</td>
      <td>BB</td>
    </tr>
    <tr>
      <th>audi q5</th>
      <td>433237.39</td>
      <td>8</td>
      <td>B</td>
      <td>B</td>
      <td>BB</td>
    </tr>
    <tr>
      <th>volkswagen transporter kasten</th>
      <td>214890.34</td>
      <td>7</td>
      <td>B</td>
      <td>B</td>
      <td>BB</td>
    </tr>
    <tr>
      <th>audi a8</th>
      <td>557799.21</td>
      <td>5</td>
      <td>B</td>
      <td>C</td>
      <td>BC</td>
    </tr>
    <tr>
      <th>volkswagen teramont</th>
      <td>216315.33</td>
      <td>4</td>
      <td>B</td>
      <td>C</td>
      <td>BC</td>
    </tr>
    <tr>
      <th>audi q7</th>
      <td>233073.00</td>
      <td>3</td>
      <td>B</td>
      <td>C</td>
      <td>BC</td>
    </tr>
    <tr>
      <th>volkswagen touareg</th>
      <td>242552.31</td>
      <td>3</td>
      <td>B</td>
      <td>C</td>
      <td>BC</td>
    </tr>
    <tr>
      <th>volkswagen multivan</th>
      <td>211161.32</td>
      <td>3</td>
      <td>C</td>
      <td>C</td>
      <td>CC</td>
    </tr>
    <tr>
      <th>audi a4</th>
      <td>95858.00</td>
      <td>3</td>
      <td>C</td>
      <td>C</td>
      <td>CC</td>
    </tr>
    <tr>
      <th>volkswagen jetta</th>
      <td>53434.20</td>
      <td>3</td>
      <td>C</td>
      <td>C</td>
      <td>CC</td>
    </tr>
    <tr>
      <th>audi a7</th>
      <td>171100.00</td>
      <td>2</td>
      <td>C</td>
      <td>C</td>
      <td>CC</td>
    </tr>
    <tr>
      <th>volkswagen amarok</th>
      <td>73041.55</td>
      <td>2</td>
      <td>C</td>
      <td>C</td>
      <td>CC</td>
    </tr>
    <tr>
      <th>volkswagen transporter</th>
      <td>73029.08</td>
      <td>2</td>
      <td>C</td>
      <td>C</td>
      <td>CC</td>
    </tr>
    <tr>
      <th>audi a3</th>
      <td>60361.99</td>
      <td>2</td>
      <td>C</td>
      <td>C</td>
      <td>CC</td>
    </tr>
    <tr>
      <th>porsche 911 carrera s</th>
      <td>162576.08</td>
      <td>1</td>
      <td>C</td>
      <td>C</td>
      <td>CC</td>
    </tr>
    <tr>
      <th>audi rs5</th>
      <td>107250.00</td>
      <td>1</td>
      <td>C</td>
      <td>C</td>
      <td>CC</td>
    </tr>
    <tr>
      <th>volkswagen transporter kombi</th>
      <td>36520.77</td>
      <td>1</td>
      <td>C</td>
      <td>C</td>
      <td>CC</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-7edbce46-6ab0-4cf3-9073-dc89d690daed')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-7edbce46-6ab0-4cf3-9073-dc89d690daed button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-7edbce46-6ab0-4cf3-9073-dc89d690daed');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-d3d63aad-43be-4b76-95ae-d86b3e0ff55b">
  <button class="colab-df-quickchart" onclick="quickchart('df-d3d63aad-43be-4b76-95ae-d86b3e0ff55b')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-d3d63aad-43be-4b76-95ae-d86b3e0ff55b button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>
    </div>
  </div>

</div>
</div>
<div class="cell code" data-execution_count="704"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:206}"
id="7oeJkKKa-CUF" data-outputId="c1b8a323-bf5f-4bfa-eea9-97882e46872c">
<div class="sourceCode" id="cb295"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb295-1"><a href="#cb295-1" aria-hidden="true" tabindex="-1"></a><span class="co"># посчитаем количество групп</span></span>
<span id="cb295-2"><a href="#cb295-2" aria-hidden="true" tabindex="-1"></a>abc_group <span class="op">=</span> mercur_abc.groupby(<span class="st">&#39;abc_final&#39;</span>, as_index<span class="op">=</span><span class="va">False</span>)[<span class="st">&#39;количество&#39;</span>].count()</span>
<span id="cb295-3"><a href="#cb295-3" aria-hidden="true" tabindex="-1"></a>abc_group</span></code></pre></div>
<div class="output execute_result" data-execution_count="704">

  <div id="df-8e165049-ab91-4f30-8e60-49f736aeb71c" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>abc_final</th>
      <th>количество</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>AA</td>
      <td>1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>AB</td>
      <td>4</td>
    </tr>
    <tr>
      <th>2</th>
      <td>BB</td>
      <td>4</td>
    </tr>
    <tr>
      <th>3</th>
      <td>BC</td>
      <td>4</td>
    </tr>
    <tr>
      <th>4</th>
      <td>CC</td>
      <td>10</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-8e165049-ab91-4f30-8e60-49f736aeb71c')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-8e165049-ab91-4f30-8e60-49f736aeb71c button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-8e165049-ab91-4f30-8e60-49f736aeb71c');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-888a0fcc-f47a-4260-a2fa-8c288fdbfd69">
  <button class="colab-df-quickchart" onclick="quickchart('df-888a0fcc-f47a-4260-a2fa-8c288fdbfd69')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-888a0fcc-f47a-4260-a2fa-8c288fdbfd69 button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>
    </div>
  </div>

</div>
</div>
<div class="cell code" data-execution_count="705"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:542}"
id="GsnKnX9o-wvX" data-outputId="270bab62-e2d8-4331-ded9-eee0da8a55d5">
<div class="sourceCode" id="cb296"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb296-1"><a href="#cb296-1" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> px.treemap(abc_group, path<span class="op">=</span>[<span class="st">&#39;abc_final&#39;</span>], values<span class="op">=</span><span class="st">&#39;количество&#39;</span>)</span>
<span id="cb296-2"><a href="#cb296-2" aria-hidden="true" tabindex="-1"></a>fig.update_layout(title<span class="op">=</span><span class="st">&#39;Двумерный ABC анализ Меркур Авто&#39;</span>,</span>
<span id="cb296-3"><a href="#cb296-3" aria-hidden="true" tabindex="-1"></a>                  title_x<span class="op">=</span><span class="fl">0.5</span>)</span>
<span id="cb296-4"><a href="#cb296-4" aria-hidden="true" tabindex="-1"></a>fig.show()</span></code></pre></div>
<div class="output display_data">
<html>
<head><meta charset="utf-8" /></head>
<body>
    <div>            <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_SVG"></script><script type="text/javascript">if (window.MathJax && window.MathJax.Hub && window.MathJax.Hub.Config) {window.MathJax.Hub.Config({SVG: {font: "STIX-Web"}});}</script>                <script type="text/javascript">window.PlotlyConfig = {MathJaxConfig: 'local'};</script>
        <script charset="utf-8" src="https://cdn.plot.ly/plotly-2.24.1.min.js"></script>                <div id="465152da-4a72-4739-905c-e22bdd90405c" class="plotly-graph-div" style="height:525px; width:100%;"></div>            <script type="text/javascript">                                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("465152da-4a72-4739-905c-e22bdd90405c")) {                    Plotly.newPlot(                        "465152da-4a72-4739-905c-e22bdd90405c",                        [{"branchvalues":"total","domain":{"x":[0.0,1.0],"y":[0.0,1.0]},"hovertemplate":"labels=%{label}\u003cbr\u003e\u043a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e=%{value}\u003cbr\u003eparent=%{parent}\u003cbr\u003eid=%{id}\u003cextra\u003e\u003c\u002fextra\u003e","ids":["AA","AB","BB","BC","CC"],"labels":["AA","AB","BB","BC","CC"],"name":"","parents":["","","","",""],"values":[1,4,4,4,10],"type":"treemap"}],                        {"template":{"data":{"histogram2dcontour":[{"type":"histogram2dcontour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"choropleth":[{"type":"choropleth","colorbar":{"outlinewidth":0,"ticks":""}}],"histogram2d":[{"type":"histogram2d","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmap":[{"type":"heatmap","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmapgl":[{"type":"heatmapgl","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"contourcarpet":[{"type":"contourcarpet","colorbar":{"outlinewidth":0,"ticks":""}}],"contour":[{"type":"contour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"surface":[{"type":"surface","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"mesh3d":[{"type":"mesh3d","colorbar":{"outlinewidth":0,"ticks":""}}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"parcoords":[{"type":"parcoords","line":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolargl":[{"type":"scatterpolargl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"scattergeo":[{"type":"scattergeo","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolar":[{"type":"scatterpolar","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"scattergl":[{"type":"scattergl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatter3d":[{"type":"scatter3d","line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattermapbox":[{"type":"scattermapbox","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterternary":[{"type":"scatterternary","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattercarpet":[{"type":"scattercarpet","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"type":"carpet"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}],"barpolar":[{"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"pie":[{"automargin":true,"type":"pie"}]},"layout":{"autotypenumbers":"strict","colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"hovermode":"closest","hoverlabel":{"align":"left"},"paper_bgcolor":"white","plot_bgcolor":"#E5ECF6","polar":{"bgcolor":"#E5ECF6","angularaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"radialaxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"ternary":{"bgcolor":"#E5ECF6","aaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"baxis":{"gridcolor":"white","linecolor":"white","ticks":""},"caxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]]},"xaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"yaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"scene":{"xaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"yaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"zaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"geo":{"bgcolor":"white","landcolor":"#E5ECF6","subunitcolor":"white","showland":true,"showlakes":true,"lakecolor":"white"},"title":{"x":0.05},"mapbox":{"style":"light"}}},"legend":{"tracegroupgap":0},"margin":{"t":60},"title":{"text":"\u0414\u0432\u0443\u043c\u0435\u0440\u043d\u044b\u0439 ABC \u0430\u043d\u0430\u043b\u0438\u0437 \u041c\u0435\u0440\u043a\u0443\u0440 \u0410\u0432\u0442\u043e","x":0.5}},                        {"responsive": true}                    ).then(function(){
                            
var gd = document.getElementById('465152da-4a72-4739-905c-e22bdd90405c');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })                };                            </script>        </div>
</body>
</html>
</div>
</div>
<div class="cell markdown" id="ntjpp1iPBvcv">
<p>Самая многочисленная группа 10 моделей - CC (низкая выручка
относительно общего объема и малое количество покупок). Далее идет
категория AB (4 модели) - приносят много выручки, но покупают не часто.
Группа BB (4 шт) - приносят среднюю выручку и покупают не часто. Группа
BC (4 шт) - приносят среднюю выручку и покупают редко. Лишь одна модель
(VW Polo) в лучшей группе AA - приносит много выручки и покупают часто,
так как это модель среднего класса.</p>
</div>
<div class="cell markdown" id="gwL-Ez4xFku2">
<p>К группе AB относятся 4 модели:</p>
<ul>
<li>Volkswagen Tiguan</li>
<li>Porsche Cayenne</li>
<li>Audi Q8</li>
<li>Porsche Panamera</li>
</ul>
<p>Данные авто относятся к ценовой категории выше среднего. Логично, что
их берут не так часто, но благодаря своей цене они приносят высокую
выручку.</p>
<p>Группа BB:</p>
<ul>
<li>Porsche Macan</li>
<li>Audi Q5</li>
<li>Audi A6</li>
<li>Volkswagen Transporter Kasten</li>
</ul>
<p>Группа BC:</p>
<ul>
<li>Volkswagen Touareg</li>
<li>Audi Q7</li>
<li>Audi A8</li>
<li>Volkswagen Teramont</li>
</ul>
<p>Для увеличения продаж можно выставлять образцы авто в магазинах для
привлечения покупателей, предлагать выгодные тарифы автокредитования,
при покупке данных авто вручать комплект зимних и летних колес.</p>
</div>
<section id="5-выводы" class="cell markdown" id="_9E2G0lysYZw">
<h1>5 ВЫВОДЫ</h1>
</section>
<div class="cell markdown" id="P8trhCr-seI5">
<center><font size=5>Рынок</font></center>
<p>Всего представлено 32 компании по продаже авто. Из них 15 продает
только одну марку авто, 17 - несколько. Самое большое количество
продаваемых марок у allur auto. Общий объем рынка:</p>
<ul>
<li>9 мес - около 1.35 млрд $ или 53 875 шт.<br />
</li>
<li>год (прогноз) - около 1.89 млрд $ или 75 425 шт.</li>
</ul>
<p>Общий объем рынка некоммерческого транспорта:</p>
<ul>
<li>9 мес - около 1.16 млрд $ или 48 629 шт.<br />
</li>
<li>год (прогноз) - около 1.63 млрд $ или 68 080 шт.</li>
</ul>
<p>Общий объем коммерческого транспорта рынка:</p>
<ul>
<li>9 мес - около 186 млн $ или 5 246 шт.<br />
</li>
<li>год (прогноз) - около 260 млн $ или 7 344 шт.</li>
</ul>
<p>Самый активный сезон продажи это весна и июль.</p>
<p>С большим отрывом по денежному объему первое место занимает Toyota,
далее идет Hyundai и Lada. По количеству больше покупают Lada, Toyota,
Hyundai.</p>
<p>ТОП-3 марки коммерческих авто по объему выручки:</p>
<ol>
<li>Kamaz (28.4%)</li>
<li>Gaz (19.9%)</li>
<li>Ankai (17.8%)</li>
</ol>
<p>ТОП-3 марки некоммерческих авто по объему выручки:</p>
<ol>
<li>Toyota (40%)</li>
<li>Hyundai (22.8%)</li>
<li>Lada (10.7%)</li>
</ol>
<p>Самыми топовыми авто с точки зрения частоты покупки и цены являются
Hyundai Elantra и Tuscon, а также Toyota Camry.</p>
<p>Машины, которые покупают не так часто, но приносят много денег -
Toyota Land Cruiser Prado и Land Cruiser 200.</p>
<p>Машины, которые покупают часто за среднюю цену - Hyundai Accent.</p>
<p>По продажам коммерческого транспорта в тыс.$ и шт. в топ-5 входят:
г.Алматы, г.Нур-Султан, Костанайская обл., Восточно-Казахстанская обл.,
Атырауская обл.</p>
<p>По продажам некоммерческого транспорта в тыс.$ и шт. в топ-5 входят:
г.Алматы, г.Нур-Султан, Костанайская обл., Южно-Казахстанская обл.,
Атырауская обл.</p>
<p>По коммерческому транспорту ТОП-5 областей по количеству дилеров:</p>
<ul>
<li>г. Алматы;</li>
<li>Атырауская обл.;</li>
<li>Костанайская обл.;</li>
<li>Актюбинская обл.;</li>
<li>г. Нур-Султан.</li>
</ul>
<p>По некоммерческому транспорту ТОП-5 областей по количеству
дилеров:</p>
<ul>
<li>г. Алматы;</li>
<li>г. Нур-Султан;</li>
<li>Атырауская обл.;</li>
<li>Костанайская обл.;</li>
<li>Карагандинская обл.</li>
</ul>
<p>Зависимости между стоимостью автомобиля и средней зп по региону
нет.</p>
<p>Лидеры по денежному объему продажи коммерческого транспорта:</p>
<ul>
<li>ТК Камаз;</li>
<li>allur auto;</li>
<li>вираж;</li>
<li>семаз;</li>
<li>daewoo bus kazakhstan.</li>
</ul>
<p>Лидеры по количественному объему продажи коммерческого
транспорта:</p>
<ul>
<li>вираж;</li>
<li>ТК Камаз;</li>
<li>allur auto;</li>
<li>бипэк авто;</li>
<li>семаз.</li>
</ul>
<p>Лидеры по денежному объему продажи некоммерческого транспорта:</p>
<ul>
<li>toyota motor kazakhstan;</li>
<li>astana motors;</li>
<li>бипэк авто;</li>
<li>nissan manufacturing rus;</li>
<li>автоцентр-бавария.</li>
</ul>
<p>Лидеры по количественному объему продажи некоммерческого
транспорта:</p>
<ul>
<li>бипэк авто;</li>
<li>toyota motor kazakhstan;</li>
<li>astana motors;</li>
<li>allur auto;</li>
<li>Renault Россия.</li>
</ul>
<p>Среди коммерческих авто лидерами в денежном отношении являются ankai
hff6850g, gaz 3302, kamaz 65115. В количественном отношении - gaz 3302,
gaz next, uaz3909.</p>
<p>Среди некоммерческих авто лидером в денежном и количественном
отношении на рынке является toyota camry. По продажам в деньгах дальше
идет hyundai tuscon и toyota lc prado. По количеству проданных авто на
втором месте lada granta и дальше hyundai tuscon.</p>
<p>Самые прибыльные категории коммерческого транспорта:</p>
<ol>
<li>бензин, среднелитражный, MT, RWD</li>
<li>дизель, высоколитражный, MT, 2WD</li>
<li>электричество, микролитражный, MT, 2WD</li>
</ol>
<p>Самые прибыльные категории некоммерческого транспорта:</p>
<ol>
<li>бензин, среднелитражный, AT, 4WD</li>
<li>гибрид, среднелитражный, AT, 4WD</li>
<li>дизель, среднелитражный, MT, 4WD</li>
<li>электричество, микролитражный, AT, 4WD</li>
</ol>
<center><font size=5>Меркур Авто</font></center>
<p>Общая выручка: 19355.28 тыс.$</p>
<p>Средняя выручка по месяцам: 2150.59 тыс.$</p>
<p>Volkswagen занимает первое место по выручке компании Меркур Авто.
Далее идут Porsche и Audi.</p>
<p>С января по апрель наблюдается небольшой спад в выручке. Затем в мае
скачок и резкий спад в июне (самая низкая выручка за все месяцы).</p>
<p>Такой скачок в мае можно объяснить например покупкой авто перед летом
для путешествий и активного отдыха. С мая компания Меркур Авто не
продает авто марки Volkswagen. Именно поэтому наблюдается резкий спад в
июне. Выручка с продажи марок Audi и Porsche на протяжении 9 месяцев не
стабильна, есть рост и падение. Возможно это связано с акциями, скидками
и тд. Самая высокая выручка за Porsche в мае, за Audi - в июле.</p>
<p>Самые высоки продажи в деньгах и количестве с большим отрывом у г.
Алматы. Далее идет г. Нур-Султан. 3 место по деньгам занимает
Костанайская обл., по количеству - Атырауская обл. Меньше всего продаж
по обоим значеням в Западно-Казахстанской области.</p>
<p>Продажи по регионам :</p>
<ol>
<li>Атарыуская область:</li>
</ol>
<ul>
<li>Коммерческие авто - нет;</li>
<li>Некоммерческие авто - Volkswagen.</li>
</ul>
<ol>
<li>Г. Алматы:</li>
</ol>
<ul>
<li>Коммерческие авто - Volkswagen;</li>
<li>Некоммерческие авто - Volkswagen (44.1%), Porsche(33.2%),
Audi(22.7%).</li>
</ul>
<ol>
<li>Г. Нур-Султан:</li>
</ol>
<ul>
<li>Коммерческие авто - нет;</li>
<li>Некоммерческие авто - Volkswagen (67.2%), Audi(28.4%),
Porsche(4.45%).</li>
</ul>
<ol>
<li>Западно-Казахстанская область:</li>
</ol>
<ul>
<li>Коммерческие авто - нет;</li>
<li>Некоммерческие авто - Volkswagen.</li>
</ul>
<ol>
<li>Карагандинская область:</li>
</ol>
<ul>
<li>Коммерческие авто - нет;</li>
<li>Некоммерческие авто - Volkswagen.</li>
</ul>
<ol>
<li>Костанайская область:</li>
</ol>
<ul>
<li>Коммерческие авто - Volkswagen;</li>
<li>Некоммерческие авто - Volkswagen (80%), Audi (20%).</li>
</ul>
<p>Меркур Авто входит в ТОП-10 компаний по выручке в Казахстане
(занимает 10 место).</p>
<p>Из 32 компаний Меркур Авто занимает 16 место по количеству областей,
где есть этот дилер.Стоит присмотреться к другим регионам, которые
входят в ТОП-10 по продажам авто. BCG анализ показал, что автомобили
марки Porsche и Audi Меркур Авто занимают 100% рыночного объема продаж
данных моделей, следовательно конкуренции по данным авто можно не
бояться.</p>
<p>BCG анализ показал, что почти все модели кроме Audi A6 и Porsche
Cayenne (Звезды) относятся к Дойным коровам. Меркур Авто продает
ликвидные автомобили. Их спокойно можно продавать и дальше. Но стоит
присмотреться к новым авто, так как Дойные коровы могут со временем
пойти на спад.</p>
<p>Основу выручки составлял VW Polo. Но с июня Меркур Авто больше не
торгует автомобилями марки Volkswagen, из-за чего произошло резкое
сокращение выручки, так как остальные модели представлены в более
высокой ценовой категории и их покупают реже. В качестве рекомендации
можно предложить начать торговать автомобилями средней ценовой
категории, которые так же часто будут покупать.</p>
</div>
</body>
</html>
